# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∑–∞ Backend –ò–∑—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–∏ –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –ü–ª–∞–Ω

## üìã –û–±—â –ü—Ä–µ–≥–ª–µ–¥

–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–Ω –ø–ª–∞–Ω, backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑—á–∏—Å–ª—è–≤–∞ **—Ä–µ—Ñ–µ—Ä–µ–Ω—Ç–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏** –∑–∞ –±–∞–∑–æ–≤–∏ –º–µ—Ç–∞–±–æ–ª–∏—Ç–Ω–∏ –∏ —Ö—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏. –¢–µ–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ —Å–µ –ø–æ–¥–∞–≤–∞—Ç –∫—ä–º AI –º–æ–¥–µ–ª–∞ –≤ **–°—Ç—ä–ø–∫–∞ 1 (–ê–Ω–∞–ª–∏–∑)** –∫–∞—Ç–æ **—Ä–µ—Ñ–µ—Ä–µ–Ω—Ç–Ω–∏ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è** –∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –∫–æ—Ä–µ–∫—Ü–∏—è.

---

## üî¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏ Backend –ò–∑—á–∏—Å–ª–µ–Ω–∏—è

### 1. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–∞–Ω –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç –°–∫–æ—Ä (Issue #7)

**–§—É–Ω–∫—Ü–∏—è:** `calculateUnifiedActivityScore(data)`  
**–õ–æ–∫–∞—Ü–∏—è:** `worker.js`, —Ä–µ–¥–æ–≤–µ 284-320

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ö–æ–º–±–∏–Ω–∏—Ä–∞ –¥–Ω–µ–≤–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç (1-3 —Ç–æ—á–∫–∏) —Å—ä—Å —Å–ø–æ—Ä—Ç–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç (0-7 –¥–Ω–∏) –≤ –µ–¥–∏–Ω–Ω–∞ —Å–∫–∞–ª–∞ 1-10.

**–§–æ—Ä–º—É–ª–∞:**
```
–∫–æ–º–±–∏–Ω–∏—Ä–∞–Ω —Å–∫–æ—Ä = min(10, max(1, –¥–Ω–µ–≤–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç + —Å–ø–æ—Ä—Ç–Ω–∏ –¥–Ω–∏))
```

**–ú–∞–ø–∏–Ω–≥ –Ω–∞ –¥–Ω–µ–≤–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç:**
- `–ù–∏—Å–∫–æ` ‚Üí 1 —Ç–æ—á–∫–∞
- `–°—Ä–µ–¥–Ω–æ` ‚Üí 2 —Ç–æ—á–∫–∏
- `–í–∏—Å–æ–∫–æ` ‚Üí 3 —Ç–æ—á–∫–∏

**–ú–∞–ø–∏–Ω–≥ –Ω–∞ —Å–ø–æ—Ä—Ç–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç:**
- `0 –¥–Ω–∏` ‚Üí 0 –¥–Ω–∏
- `1‚Äì2 –¥–Ω–∏ —Å–µ–¥–º–∏—á–Ω–æ` ‚Üí 1.5 –¥–Ω–∏ (—Å—Ä–µ–¥–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç)
- `2‚Äì4 –¥–Ω–∏ —Å–µ–¥–º–∏—á–Ω–æ` ‚Üí 3 –¥–Ω–∏ (—Å—Ä–µ–¥–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç)
- `5‚Äì7 –¥–Ω–∏ —Å–µ–¥–º–∏—á–Ω–æ` ‚Üí 6 –¥–Ω–∏ (—Å—Ä–µ–¥–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç)

**–ò–∑—Ö–æ–¥:**
```javascript
{
  dailyScore: 1-3,           // –¢–æ—á–∫–∏ –æ—Ç –¥–Ω–µ–≤–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç
  sportDays: 0-6,            // –°—Ä–µ–¥–Ω–∏ –¥–Ω–∏ —Å–ø–æ—Ä—Ç —Å–µ–¥–º–∏—á–Ω–æ
  combinedScore: 1-10,       // –ö–æ–º–±–∏–Ω–∏—Ä–∞–Ω —Å–∫–æ—Ä (–∑–∞–∫—Ä—ä–≥–ª–µ–Ω –¥–æ 1 –¥–µ—Å.)
  activityLevel: '–ù–∏—Å–∫–∞' |   // –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç
                 '–°—Ä–µ–¥–Ω–∞' | 
                 '–í–∏—Å–æ–∫–∞' | 
                 '–ú–Ω–æ–≥–æ –≤–∏—Å–æ–∫–∞'
}
```

**–ü—Ä–∏–º–µ—Ä–∏:**
- –ù–∏—Å–∫–æ (1) + –ù–∏—Å–∫–∞ 1-2 –¥–Ω–∏ (1.5) ‚Üí **2.5** ‚Üí –ù–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç
- –°—Ä–µ–¥–Ω–æ (2) + –°—Ä–µ–¥–Ω–∞ 2-4 –¥–Ω–∏ (3) ‚Üí **5** ‚Üí –°—Ä–µ–¥–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç
- –í–∏—Å–æ–∫–æ (3) + –í–∏—Å–æ–∫–∞ 5-7 –¥–Ω–∏ (6) ‚Üí **9** ‚Üí –ú–Ω–æ–≥–æ –≤–∏—Å–æ–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç

---

### 2. BMR - –ë–∞–∑–∞–ª–µ–Ω –ú–µ—Ç–∞–±–æ–ª–∏—Ç–µ–Ω –†–∏—Ç—ä–º

**–§—É–Ω–∫—Ü–∏—è:** `calculateBMR(data)`  
**–õ–æ–∫–∞—Ü–∏—è:** `worker.js`, —Ä–µ–¥–æ–≤–µ 244-268

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ò–∑—á–∏—Å–ª—è–≤–∞ –±–∞–∑–æ–≤–∏—è –º–µ—Ç–∞–±–æ–ª–∏–∑—ä–º (–∫–∞–ª–æ—Ä–∏–∏ –∏–∑–≥–∞—Ä—è–Ω–∏ –≤ –ø–æ–∫–æ–π) –∏–∑–ø–æ–ª–∑–≤–∞–π–∫–∏ **Mifflin-St Jeor** —Ñ–æ—Ä–º—É–ª–∞—Ç–∞.

**–§–æ—Ä–º—É–ª–∏:**

**–ó–∞ –ú—ä–∂–µ:**
```
BMR = 10 √ó —Ç–µ–≥–ª–æ(kg) + 6.25 √ó –≤–∏—Å–æ—á–∏–Ω–∞(cm) - 5 √ó –≤—ä–∑—Ä–∞—Å—Ç(–≥–æ–¥–∏–Ω–∏) + 5
```

**–ó–∞ –ñ–µ–Ω–∏:**
```
BMR = 10 √ó —Ç–µ–≥–ª–æ(kg) + 6.25 √ó –≤–∏—Å–æ—á–∏–Ω–∞(cm) - 5 √ó –≤—ä–∑—Ä–∞—Å—Ç(–≥–æ–¥–∏–Ω–∏) - 161
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –ò–∑–∏—Å–∫–≤–∞: —Ç–µ–≥–ª–æ, –≤–∏—Å–æ—á–∏–Ω–∞, –≤—ä–∑—Ä–∞—Å—Ç, –ø–æ–ª
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –∑–∞ –≤–∞–ª–∏–¥–Ω–∏ —á–∏—Å–ª–æ–≤–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (> 0)
- –•–≤—ä—Ä–ª—è –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –ª–∏–ø—Å–≤–∞—â–∏ –∏–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–∏ –¥–∞–Ω–Ω–∏

**–ü—Ä–∏–º–µ—Ä:**
```
–ú—ä–∂, 35 –≥–æ–¥., 85 kg, 180 cm:
BMR = 10 √ó 85 + 6.25 √ó 180 - 5 √ó 35 + 5
    = 850 + 1125 - 175 + 5
    = 1805 kcal
```

---

### 3. TDEE - –û–±—â –î–Ω–µ–≤–µ–Ω –ï–Ω–µ—Ä–≥–∏–µ–Ω –†–∞–∑—Ö–æ–¥ (Issue #10)

**–§—É–Ω–∫—Ü–∏—è:** `calculateTDEE(bmr, activityLevel)`  
**–õ–æ–∫–∞—Ü–∏—è:** `worker.js`, —Ä–µ–¥–æ–≤–µ 330-363

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ò–∑—á–∏—Å–ª—è–≤–∞ –æ–±—â–∏—è –¥–Ω–µ–≤–µ–Ω –µ–Ω–µ—Ä–≥–∏–µ–Ω —Ä–∞–∑—Ö–æ–¥ –±–∞–∑–∏—Ä–∞–Ω –Ω–∞ BMR –∏ –Ω–∏–≤–æ—Ç–æ –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç.

**–§–æ—Ä–º—É–ª–∞:**
```
TDEE = BMR √ó –º–Ω–æ–∂–∏—Ç–µ–ª –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç
```

**–ú–Ω–æ–∂–∏—Ç–µ–ª–∏ –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç (–±–∞–∑–∏—Ä–∞–Ω–∏ –Ω–∞ 1-10 —Å–∫–∞–ª–∞):**
```javascript
–°–∫–æ—Ä 1:  √ó 1.20  (Sedentary - —Å–µ–¥—è—â –Ω–∞—á–∏–Ω –Ω–∞ –∂–∏–≤–æ—Ç)
–°–∫–æ—Ä 2:  √ó 1.30
–°–∫–æ—Ä 3:  √ó 1.375 (Light activity - –ª–µ–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç)
–°–∫–æ—Ä 4:  √ó 1.45
–°–∫–æ—Ä 5:  √ó 1.525 (Moderate - —É–º–µ—Ä–µ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç)
–°–∫–æ—Ä 6:  √ó 1.60
–°–∫–æ—Ä 7:  √ó 1.675
–°–∫–æ—Ä 8:  √ó 1.75  (Very active - –º–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–µ–Ω)
–°–∫–æ—Ä 9:  √ó 1.85
–°–∫–æ—Ä 10: √ó 1.95  (Extremely active - –µ–∫—Å—Ç—Ä–µ–º–Ω–æ –∞–∫—Ç–∏–≤–µ–Ω)
```

**–û—Å–æ–±–µ–Ω–æ—Å—Ç–∏:**
- –ü–æ–¥–¥—ä—Ä–∂–∞ legacy —Ñ–æ—Ä–º–∞—Ç (string) –∑–∞ –æ–±—Ä–∞—Ç–Ω–∞ —Å—ä–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç
- –ò–∑–ø–æ–ª–∑–≤–∞ unified activity score (1-10) –∑–∞ –Ω–æ–≤–∏ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è
- –ü–æ-–≥–ª–∞–¥–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å–∏—è –æ—Ç —Å—Ç–∞—Ä–∏—Ç–µ 5 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–ü—Ä–∏–º–µ—Ä:**
```
BMR: 1805 kcal
Activity Score: 5 (–°—Ä–µ–¥–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç)
TDEE = 1805 √ó 1.525 = 2753 kcal
```

---

### 4. –ë–µ–∑–æ–ø–∞—Å–µ–Ω –ö–∞–ª–æ—Ä–∏–µ–Ω –î–µ—Ñ–∏—Ü–∏—Ç (Issue #9)

**–§—É–Ω–∫—Ü–∏—è:** `calculateSafeDeficit(tdee, goal)`  
**–õ–æ–∫–∞—Ü–∏—è:** `worker.js`, —Ä–µ–¥–æ–≤–µ 464-486

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ò–∑—á–∏—Å–ª—è–≤–∞ –±–µ–∑–æ–ø–∞—Å–µ–Ω –∫–∞–ª–æ—Ä–∏–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç –∑–∞ –æ—Ç—Å–ª–∞–±–≤–∞–Ω–µ, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ –º–∞–∫—Å–∏–º—É–º 25%.

**–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏:**
- **–ú–∞–∫—Å–∏–º–∞–ª–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç:** 25% (0.25)
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç:** 18% (0.18)

**–õ–æ–≥–∏–∫–∞:**
1. –ê–∫–æ —Ü–µ–ª—Ç–∞ –ù–ï –µ "–û—Ç—Å–ª–∞–±–≤–∞–Ω–µ" ‚Üí –¥–µ—Ñ–∏—Ü–∏—Ç = 0%, —Ü–µ–ª–µ–≤–∏ –∫–∞–ª–æ—Ä–∏–∏ = TDEE
2. –ê–∫–æ —Ü–µ–ª—Ç–∞ –µ "–û—Ç—Å–ª–∞–±–≤–∞–Ω–µ":
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç: 18% (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–µ–Ω –ø–æ–¥—Ö–æ–¥)
   - –ú–∞–∫—Å–∏–º–∞–ª–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç: 25% (–º–∏–Ω–∏–º–∞–ª–Ω–∏ –∫–∞–ª–æ—Ä–∏–∏)
   - AI –º–æ–∂–µ –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞ –∑–∞ —Å–ø–µ—Ü–∏–∞–ª–Ω–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

**–§–æ—Ä–º—É–ª–∏:**
```
targetCalories = TDEE √ó (1 - 0.18)        // –°—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç 18%
maxDeficitCalories = TDEE √ó (1 - 0.25)    // –ú–∞–∫—Å–∏–º–∞–ª–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç 25%
```

**–ò–∑—Ö–æ–¥:**
```javascript
{
  targetCalories: —á–∏—Å–ª–æ,        // –ü—Ä–µ–ø–æ—Ä—ä—á–∏—Ç–µ–ª–Ω–∏ –¥–Ω–µ–≤–Ω–∏ –∫–∞–ª–æ—Ä–∏–∏
  deficitPercent: 18,           // –°—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∏
  maxDeficitCalories: —á–∏—Å–ª–æ,    // –ú–∏–Ω–∏–º–∞–ª–Ω–∏ –∫–∞–ª–æ—Ä–∏–∏ (25% –¥–µ—Ñ–∏—Ü–∏—Ç)
  note: 'AI –º–æ–∂–µ –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞...' // –ë–µ–ª–µ–∂–∫–∞
}
```

**–ü—Ä–∏–º–µ—Ä:**
```
TDEE: 2753 kcal
–¶–µ–ª: –û—Ç—Å–ª–∞–±–≤–∞–Ω–µ

targetCalories = 2753 √ó (1 - 0.18) = 2257 kcal  (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç)
maxDeficitCalories = 2753 √ó (1 - 0.25) = 2065 kcal (–º–∞–∫—Å–∏–º–∞–ª–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç)
```

**–ó–∞—â–æ 25%, –∞ –Ω–µ 30%?**
- 25% –µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–µ–Ω –º–∞–∫—Å–∏–º—É–º –∑–∞ –ø–æ–≤–µ—á–µ—Ç–æ —Ö–æ—Ä–∞
- 30% –¥–µ—Ñ–∏—Ü–∏—Ç –º–æ–∂–µ –¥–∞ –¥–æ–≤–µ–¥–µ –¥–æ:
  - –ó–∞–≥—É–±–∞ –Ω–∞ –º—É—Å–∫—É–ª–Ω–∞ –º–∞—Å–∞
  - –ó–∞–±–∞–≤—è–Ω–µ –Ω–∞ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞
  - –•–æ—Ä–º–æ–Ω–∞–ª–µ–Ω –¥–∏—Å–±–∞–ª–∞–Ω—Å
  - –ù–∞–º–∞–ª–µ–Ω–∞ –µ–Ω–µ—Ä–≥–∏—è –∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç
- AI –º–æ–∂–µ –¥–∞ –ø—Ä–∏–ª–æ–∂–∏ –ø–æ-–≥–æ–ª—è–º –¥–µ—Ñ–∏—Ü–∏—Ç –≤ —Å–ø–µ—Ü–∏–∞–ª–Ω–∏ —Å–ª—É—á–∞–∏ (–Ω–∞–ø—Ä. –∏–Ω—Ç–µ—Ä–º–∏—Ç–µ–Ω—Ç–Ω–æ –≥–ª–∞–¥—É–≤–∞–Ω–µ), –Ω–æ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–æ

---

### 5. –ë–∞–∑–æ–≤–∏ –ú–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–Ω–∏ –°—ä–æ—Ç–Ω–æ—à–µ–Ω–∏—è (Issue #2, #28)

**–§—É–Ω–∫—Ü–∏—è:** `calculateMacronutrientRatios(data, activityScore, tdee)`  
**–õ–æ–∫–∞—Ü–∏—è:** `worker.js`, —Ä–µ–¥–æ–≤–µ 393-456

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ò–∑—á–∏—Å–ª—è–≤–∞ –±–∞–∑–æ–≤–∏—Ç–µ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∏ —Å—ä–æ—Ç–Ω–æ—à–µ–Ω–∏—è –Ω–∞ –º–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–∏ (–ø—Ä–æ—Ç–µ–∏–Ω–∏, –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏, –º–∞–∑–Ω–∏–Ω–∏) –±–∞–∑–∏—Ä–∞–Ω–∏ –Ω–∞ –ø–æ–ª, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç –∏ —Ü–µ–ª.

**–ê–ª–≥–æ—Ä–∏—Ç—ä–º:**

**1. –û–ø—Ä–µ–¥–µ–ª—è–Ω–µ –Ω–∞ –ø—Ä–æ—Ç–µ–∏–Ω–æ–≤–∏ –Ω—É–∂–¥–∏ (g/kg):**

**–ó–∞ –ú—ä–∂–µ:**
```javascript
activityScore >= 7 ? 2.0 g/kg  (–ú–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–µ–Ω)
activityScore >= 5 ? 1.6 g/kg  (–£–º–µ—Ä–µ–Ω–æ –∞–∫—Ç–∏–≤–µ–Ω)
                     1.2 g/kg  (–ù–∏—Å–∫a –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç)
```

**–ó–∞ –ñ–µ–Ω–∏:**
```javascript
activityScore >= 7 ? 1.8 g/kg  (–ú–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–∞)
activityScore >= 5 ? 1.4 g/kg  (–£–º–µ—Ä–µ–Ω–æ –∞–∫—Ç–∏–≤–Ω–∞)
                     1.0 g/kg  (–ù–∏—Å–∫a –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç)
```

**2. –ö–æ—Ä–µ–∫—Ü–∏—è —Å–ø–æ—Ä–µ–¥ —Ü–µ–ª:**
```javascript
–ü–æ–∫–∞—á–≤–∞–Ω–µ –Ω–∞ –º—É—Å–∫—É–ª–Ω–∞ –º–∞—Å–∞: –ø—Ä–æ—Ç–µ–∏–Ω √ó 1.2  (+20%)
–û—Ç—Å–ª–∞–±–≤–∞–Ω–µ:                 –ø—Ä–æ—Ç–µ–∏–Ω √ó 1.1  (+10% –∑–∞ –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –º—É—Å–∫—É–ª–∏)
```

**3. –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ—Ç–µ–∏–Ω–æ–≤–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∏:**
```javascript
proteinGrams = —Ç–µ–≥–ª–æ √ó proteinPerKg
proteinCalories = proteinGrams √ó 4  (4 cal/g)
proteinPercent = (proteinCalories / TDEE) √ó 100
```

**4. –†–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å—Ç–∞–Ω–∞–ª–∏—Ç–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∏:**
```javascript
remainingPercent = 100 - proteinPercent

–ê–∫–æ activityScore >= 7:  (–ú–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–µ–Ω)
  carbsPercent = remainingPercent √ó 0.6  (60% –æ—Ç –æ—Å—Ç–∞–Ω–∞–ª–æ—Ç–æ –∑–∞ –µ–Ω–µ—Ä–≥–∏—è)
  fatsPercent = remainingPercent √ó 0.4

–ê–∫–æ activityScore >= 4:  (–£–º–µ—Ä–µ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç)
  carbsPercent = remainingPercent √ó 0.5  (50% –±–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω–æ)
  fatsPercent = remainingPercent √ó 0.5

–ê–∫–æ activityScore < 4:   (–ù–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç)
  carbsPercent = remainingPercent √ó 0.4  (40% –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏)
  fatsPercent = remainingPercent √ó 0.6  (60% –º–∞–∑–Ω–∏–Ω–∏ –∑–∞ —Å–∏—Ç–æ—Å—Ç)
```

**5. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ 100%:**
```javascript
total = proteinPercent + carbsPercent + fatsPercent
if (total !== 100) {
  fatsPercent += (100 - total)  // –ö–æ—Ä–∏–≥–∏—Ä–∞ –º–∞–∑–Ω–∏–Ω–∏—Ç–µ –∑–∞ —Ç–æ—á–Ω–æ 100%
}
```

**–ò–∑—Ö–æ–¥:**
```javascript
{
  protein: –ø—Ä–æ—Ü–µ–Ω—Ç,             // –ü—Ä–æ—Ç–µ–∏–Ω %
  carbs: –ø—Ä–æ—Ü–µ–Ω—Ç,               // –í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏ %
  fats: –ø—Ä–æ—Ü–µ–Ω—Ç,                // –ú–∞–∑–Ω–∏–Ω–∏ %
  proteinGramsPerKg: —á–∏—Å–ª–æ      // –ü—Ä–æ—Ç–µ–∏–Ω g/kg (–∑–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏—è)
}
```

**–ü—Ä–∏–º–µ—Ä:**
```
–ú—ä–∂, 85 kg, Activity Score: 5, TDEE: 2753 kcal, –¶–µ–ª: –û—Ç—Å–ª–∞–±–≤–∞–Ω–µ

1. –ü—Ä–æ—Ç–µ–∏–Ω base: 1.6 g/kg (activityScore >= 5)
2. –ö–æ—Ä–µ–∫—Ü–∏—è: 1.6 √ó 1.1 = 1.76 g/kg (–∑–∞–∫—Ä—ä–≥–ª–µ–Ω–æ –¥–æ 1.8 g/kg)
3. –ü—Ä–æ—Ç–µ–∏–Ω –≥—Ä–∞–º–æ–≤–µ: 85 √ó 1.8 = 153 g
4. –ü—Ä–æ—Ç–µ–∏–Ω –∫–∞–ª–æ—Ä–∏–∏: 153 √ó 4 = 612 kcal
5. –ü—Ä–æ—Ç–µ–∏–Ω –ø—Ä–æ—Ü–µ–Ω—Ç: (612 / 2753) √ó 100 = 22%
6. –û—Å—Ç–∞–Ω–∞–ª–∏: 100 - 22 = 78%
7. –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç —Å—Ä–µ–¥–Ω–∞ (5): 50/50 —Ä–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
   - Carbs: 78 √ó 0.5 = 39%
   - Fats: 78 √ó 0.5 = 39%
8. –ü—Ä–æ–≤–µ—Ä–∫–∞: 22 + 39 + 39 = 100% ‚úì

–†–µ–∑—É–ª—Ç–∞—Ç:
- –ü—Ä–æ—Ç–µ–∏–Ω: 22% (1.8 g/kg)
- –í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏: 39%
- –ú–∞–∑–Ω–∏–Ω–∏: 39%
```

**–ó–∞—â–æ –ù–ï –µ —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–∞ –ª–æ–≥–∏–∫–∞:**
- Backend –∏–∑—á–∏—Å–ª—è–≤–∞ **–±–∞–∑–æ–≤–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∏** —Å–ø–æ—Ä–µ–¥ –ø—Ä–æ—Å—Ç–∞ —Ñ–æ—Ä–º—É–ª–∞
- AI –ø–æ–ª—É—á–∞–≤–∞ —Ç–µ–∑–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∏ –∫–∞—Ç–æ **—Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏—è**
- AI –º–æ–∂–µ –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞ —Å–ø–æ—Ä–µ–¥ **—Ö–æ–ª–∏—Å—Ç–∏—á–µ–Ω –∞–Ω–∞–ª–∏–∑** –Ω–∞ –≤—Å–∏—á–∫–∏ —Ñ–∞–∫—Ç–æ—Ä–∏
- –ù–µ –µ —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–æ –∑–∞—â–æ—Ç–æ Backend –ù–ï –∏–∑–ø–æ–ª–∑–≤–∞ AI —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ –∑–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ

---

## üîÑ –ü–æ—Ç–æ–∫ –Ω–∞ –î–∞–Ω–Ω–∏

### –°—Ç—ä–ø–∫–∞ 1: Backend –ò–∑—á–∏—Å–ª–µ–Ω–∏—è

```javascript
// –í generateAnalysisPrompt() - worker.js, —Ä–µ–¥–æ–≤–µ 4264-4310

// 1. –ò–∑—á–∏—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç —Å–∫–æ—Ä
const activityData = calculateUnifiedActivityScore(data);

// 2. –ò–∑—á–∏—Å–ª–∏ BMR
const bmr = calculateBMR(data);

// 3. –ò–∑—á–∏—Å–ª–∏ TDEE
const tdee = calculateTDEE(bmr, activityData.combinedScore);

// 4. –ò–∑—á–∏—Å–ª–∏ –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç
const deficitData = calculateSafeDeficit(tdee, data.goal);

// 5. –ò–∑—á–∏—Å–ª–∏ –±–∞–∑–æ–≤–∏ –º–∞–∫—Ä–æ—Å–∏
const macros = calculateMacronutrientRatios(data, activityData.combinedScore, tdee);
```

### –°—Ç—ä–ø–∫–∞ 2: –§–æ—Ä–º–∞—Ç–∏—Ä–∞–Ω–µ –∑–∞ AI Prompt

Backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è—Ç–∞ –≤ —á–µ—Ç–∏–º —Ç–µ–∫—Å—Ç–æ–≤ —Ñ–æ—Ä–º–∞—Ç:

```
‚ïê‚ïê‚ïê BACKEND –†–ï–§–ï–†–ï–ù–¢–ù–ò –ò–ó–ß–ò–°–õ–ï–ù–ò–Ø (Issues #2, #7, #9, #10, #28 - Feb 2026) ‚ïê‚ïê‚ïê

–£–ù–ò–§–ò–¶–ò–†–ê–ù –ê–ö–¢–ò–í–ù–û–°–¢ –°–ö–û–† (Issue #7):
- –î–Ω–µ–≤–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç: –°—Ä–µ–¥–Ω–æ ‚Üí 2/3
- –°–ø–æ—Ä—Ç–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç: –°—Ä–µ–¥–Ω–∞ (2‚Äì4 –¥–Ω–∏ —Å–µ–¥–º–∏—á–Ω–æ) ‚Üí ~3 –¥–Ω–∏
- –ö–û–ú–ë–ò–ù–ò–†–ê–ù –°–ö–û–†: 5/10 (–°—Ä–µ–¥–Ω–∞)
- –§–æ—Ä–º—É–ª–∞: –¥–Ω–µ–≤–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç (1-3) + —Å–ø–æ—Ä—Ç–Ω–∏ –¥–Ω–∏ ‚Üí —Å–∫–∞–ª–∞ 1-10

–ë–ê–ó–û–í–ò –ö–ê–õ–ö–£–õ–ê–¶–ò–ò:
- BMR (Mifflin-St Jeor): 1805 kcal
  * –ú—ä–∂: 10√ó85 + 6.25√ó180 - 5√ó35 + 5
  * –ñ–µ–Ω–∞: 10√ó85 + 6.25√ó180 - 5√ó35 - 161
  
- TDEE (Issue #10): 2753 kcal
  * BMR √ó 1.53 (—Ñ–∞–∫—Ç–æ—Ä –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç —Å–∫–æ—Ä 5)
  * –ù–æ–≤ –º–Ω–æ–∂–∏—Ç–µ–ª –±–∞–∑–∏—Ä–∞–Ω –Ω–∞ 1-10 —Å–∫–∞–ª–∞
  
- –ë–ï–ó–û–ü–ê–°–ï–ù –î–ï–§–ò–¶–ò–¢ (Issue #9): 2257 kcal
  * –ú–∞–∫—Å–∏–º–∞–ª–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç: 25% (2065 kcal –º–∏–Ω–∏–º—É–º)
  * –°—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç: 18%
  * AI –º–æ–∂–µ –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞ –∑–∞ —Å–ø–µ—Ü–∏–∞–ª–Ω–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

–ë–ê–ó–û–í–ò –ú–ê–ö–†–û–ù–£–¢–†–ò–ï–ù–¢–ò (Issue #2, #28 - –ù–ï —Ü–∏—Ä–∫—É–ª—è—Ä–Ω–∞ –ª–æ–≥–∏–∫–∞):
- –ü—Ä–æ—Ç–µ–∏–Ω: 22% (1.8g/kg –∑–∞ –ú—ä–∂)
  * –ö–æ—Ä–∏–≥–∏—Ä–∞–Ω–æ —Å–ø–æ—Ä–µ–¥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç —Å–∫–æ—Ä 5
- –í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏: 39%
- –ú–∞–∑–Ω–∏–Ω–∏: 39%
- –°–£–ú–ê: 100% (–≤–∞–ª–∏–¥–∏—Ä–∞–Ω–æ = 100%)
```

### –°—Ç—ä–ø–∫–∞ 3: AI –ü–æ–ª—É—á–∞–≤–∞ –†–µ—Ñ–µ—Ä–µ–Ω—Ç–Ω–∏ –°—Ç–æ–π–Ω–æ—Å—Ç–∏

AI –º–æ–¥–µ–ª—ä—Ç –ø–æ–ª—É—á–∞–≤–∞:
1. **–ü—ä–ª–Ω–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –¥–∞–Ω–Ω–∏** (–∏–º–µ, –≤—ä–∑—Ä–∞—Å—Ç, —Ç–µ–≥–ª–æ, –≤–∏—Å–æ—á–∏–Ω–∞, –∑–¥—Ä–∞–≤–µ, –Ω–∞–≤–∏—Ü–∏, –∏ —Ç.–Ω.)
2. **Backend —Ä–µ—Ñ–µ—Ä–µ–Ω—Ç–Ω–∏ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è** (–≤–∏–∂ –ø–æ-–≥–æ—Ä–µ)
3. **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞ —Ö–æ–ª–∏—Å—Ç–∏—á–µ–Ω –∞–Ω–∞–ª–∏–∑**

AI –∏–∑–ø–æ–ª–∑–≤–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ç–Ω–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –∫–∞—Ç–æ:
- **–û—Ç–ø—Ä–∞–≤–Ω–∞ —Ç–æ—á–∫–∞** –∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **–ë–∞–∑–æ–≤–∞ –ª–∏–Ω–∏—è** –∑–∞ –∫–æ—Ä–µ–∫—Ü–∏–∏
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç** –Ω–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è—Ç–∞

### –°—Ç—ä–ø–∫–∞ 4: AI –ö–æ—Ä–∏–≥–∏—Ä–∞ –°–ø–æ—Ä–µ–¥ –•–æ–ª–∏—Å—Ç–∏—á–µ–Ω –ê–Ω–∞–ª–∏–∑

AI –º–æ–∂–µ –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ —Å–ø–æ—Ä–µ–¥:
- –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏ —Å—ä—Å—Ç–æ—è–Ω–∏—è
- –ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç–∏
- –ö–∞—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—ä–Ω—è
- –°—Ç—Ä–µ—Å –Ω–∏–≤–∞
- –•—Ä–æ–Ω–æ—Ç–∏–ø
- –ò—Å—Ç–æ—Ä–∏—è –Ω–∞ –¥–∏–µ—Ç–∏
- –ú–µ—Ç–∞–±–æ–ª–∏—Ç–Ω–∞ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç
- –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Ñ–∏–ª
- –ò –¥—Ä—É–≥–∏ –∫–æ—Ä–µ–ª–∏—Ä–∞—â–∏ —Ñ–∞–∫—Ç–æ—Ä–∏

**–†–µ–∑—É–ª—Ç–∞—Ç:** AI –≤—Ä—ä—â–∞ **–∫–æ—Ä–∏–≥–∏—Ä–∞–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏** –±–∞–∑–∏—Ä–∞–Ω–∏ –Ω–∞ —Ü—è–ª–æ—Å—Ç–Ω–∏—è –∞–Ω–∞–ª–∏–∑.

---

## üìä –¢–∞–±–ª–∏—Ü–∞ –Ω–∞ –ò–∑—á–∏—Å–ª–µ–Ω–∏—è—Ç–∞

| –ò–∑—á–∏—Å–ª–µ–Ω–∏–µ | –§—É–Ω–∫—Ü–∏—è | Issue | –í—Ö–æ–¥–Ω–∏ –î–∞–Ω–Ω–∏ | –ò–∑—Ö–æ–¥ |
|------------|---------|-------|--------------|-------|
| –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç –°–∫–æ—Ä | `calculateUnifiedActivityScore()` | #7 | dailyActivityLevel, sportActivity | 1-10 —Å–∫–∞–ª–∞ + –∫–∞—Ç–µ–≥–æ—Ä–∏—è |
| BMR | `calculateBMR()` | - | —Ç–µ–≥–ª–æ, –≤–∏—Å–æ—á–∏–Ω–∞, –≤—ä–∑—Ä–∞—Å—Ç, –ø–æ–ª | kcal (Mifflin-St Jeor) |
| TDEE | `calculateTDEE()` | #10 | BMR, activityScore | kcal (BMR √ó –º–Ω–æ–∂–∏—Ç–µ–ª) |
| –ë–µ–∑–æ–ø–∞—Å–µ–Ω –î–µ—Ñ–∏—Ü–∏—Ç | `calculateSafeDeficit()` | #9 | TDEE, —Ü–µ–ª | targetCalories, maxDeficit |
| –ú–∞–∫—Ä–æ –°—ä–æ—Ç–Ω–æ—à–µ–Ω–∏—è | `calculateMacronutrientRatios()` | #2, #28 | —Ç–µ–≥–ª–æ, –ø–æ–ª, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç, —Ü–µ–ª | protein%, carbs%, fats% |

---

## ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ Backend:

**calculateBMR():**
- ‚úì –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –∑–∞ –ª–∏–ø—Å–≤–∞—â–∏ –¥–∞–Ω–Ω–∏
- ‚úì –í–∞–ª–∏–¥–∏—Ä–∞ —á–∏—Å–ª–æ–≤–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (> 0)
- ‚úì –ò–∑–∏—Å–∫–≤–∞ –≤–∞–ª–∏–¥–µ–Ω –ø–æ–ª ("–ú—ä–∂" –∏–ª–∏ "–ñ–µ–Ω–∞")
- ‚úì –•–≤—ä—Ä–ª—è –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–∏ –¥–∞–Ω–Ω–∏

**calculateUnifiedActivityScore():**
- ‚úì –ò–∑–ø–æ–ª–∑–≤–∞ default —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –ª–∏–ø—Å–≤–∞—â–∏ –¥–∞–Ω–Ω–∏
- ‚úì –û–≥—Ä–∞–Ω–∏—á–∞–≤–∞ —Å–∫–æ—Ä–∞ –º–µ–∂–¥—É 1-10
- ‚úì –ó–∞–∫—Ä—ä–≥–ª—è–≤–∞ –¥–æ 1 –¥–µ—Å–µ—Ç–∏—á–Ω–∞ –ø–æ–∑–∏—Ü–∏—è

**calculateTDEE():**
- ‚úì –ü–æ–¥–¥—ä—Ä–∂–∞ legacy —Ñ–æ—Ä–º–∞—Ç (string)
- ‚úì –ò–∑–ø–æ–ª–∑–≤–∞ default –º–Ω–æ–∂–∏—Ç–µ–ª –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–µ–Ω —Å–∫–æ—Ä
- ‚úì –ó–∞–∫—Ä—ä–≥–ª—è –¥–æ —Ü—è–ª–æ —á–∏—Å–ª–æ

**calculateSafeDeficit():**
- ‚úì –í—Ä—ä—â–∞ 0% –¥–µ—Ñ–∏—Ü–∏—Ç –∞–∫–æ —Ü–µ–ª—Ç–∞ –Ω–µ –µ –æ—Ç—Å–ª–∞–±–≤–∞–Ω–µ
- ‚úì –û–≥—Ä–∞–Ω–∏—á–∞–≤–∞ –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –¥–æ 25% –º–∞–∫—Å–∏–º—É–º
- ‚úì –ò–∑—á–∏—Å–ª—è–≤–∞ –¥–≤e —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω + –º–∞–∫—Å–∏–º–∞–ª–µ–Ω)

**calculateMacronutrientRatios():**
- ‚úì –ò–∑–ø–æ–ª–∑–≤–∞ default —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –∑–∞ –ª–∏–ø—Å–≤–∞—â–∏ –¥–∞–Ω–Ω–∏
- ‚úì –ö–æ—Ä–µ–∫—Ü–∏—è —Å–ø–æ—Ä–µ–¥ –ø–æ–ª, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç –∏ —Ü–µ–ª
- ‚úì **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–∞ —Å—É–º–∞—Ç–∞ –µ —Ç–æ—á–Ω–æ 100%**
- ‚úì –ó–∞–∫—Ä—ä–≥–ª—è –ø—Ä–æ—Ç–µ–∏–Ω g/kg –¥–æ 1 –¥–µ—Å–µ—Ç–∏—á–Ω–∞

---

## üîß –ö—ä–¥–µ —Å–µ –ù–∞–º–∏—Ä–∞ –ö–æ–¥—ä—Ç?

**–§–∞–π–ª:** `worker.js`

**–§—É–Ω–∫—Ü–∏–∏:**
- `calculateUnifiedActivityScore()` - —Ä–µ–¥–æ–≤–µ 284-320
- `calculateBMR()` - —Ä–µ–¥–æ–≤–µ 244-268
- `calculateTDEE()` - —Ä–µ–¥–æ–≤–µ 330-363
- `calculateSafeDeficit()` - —Ä–µ–¥–æ–≤–µ 464-486
- `calculateMacronutrientRatios()` - —Ä–µ–¥–æ–≤–µ 393-456

**–ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ –≤ –ü—Ä–æ–º–ø—Ç:**
- `generateAnalysisPrompt()` - —Ä–µ–¥–æ–≤–µ 4061-4518
- Backend –∏–∑—á–∏—Å–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω–∏ - —Ä–µ–¥–æ–≤–µ 4263-4310

---

## üìù –ü—Ä–∏–º–µ—Ä–Ω–∞ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ü—Ä–∏–º–µ—Ä –∑–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è:**

```javascript
// –í—Ö–æ–¥–Ω–∏ –¥–∞–Ω–Ω–∏
const userData = {
  name: '–ò–≤–∞–Ω',
  age: 35,
  gender: '–ú—ä–∂',
  height: 180,
  weight: 85,
  goal: '–û—Ç—Å–ª–∞–±–≤–∞–Ω–µ',
  lossKg: 10,
  dailyActivityLevel: '–°—Ä–µ–¥–Ω–æ',
  sportActivity: '–°—Ä–µ–¥–Ω–∞ (2‚Äì4 –¥–Ω–∏ —Å–µ–¥–º–∏—á–Ω–æ)'
};

// Backend –∏–∑—á–∏—Å–ª–µ–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏)
Activity Score: 5/10 (–°—Ä–µ–¥–Ω–∞)
BMR: 1805 kcal
TDEE: 2753 kcal
Target Calories: 2257 kcal (18% –¥–µ—Ñ–∏—Ü–∏—Ç)
Max Deficit: 2065 kcal (25% –¥–µ—Ñ–∏—Ü–∏—Ç)
Macros: 22% protein (1.8 g/kg), 39% carbs, 39% fats
```

**AI –ø–æ–ª—É—á–∞–≤–∞ —Ç–µ–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –∏ –º–æ–∂–µ –¥–∞ –≥–∏ –∫–æ—Ä–∏–≥–∏—Ä–∞ —Å–ø–æ—Ä–µ–¥:**
- –ó–¥—Ä–∞–≤–æ—Å–ª–æ–≤–Ω–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ
- –ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç–∏
- –ö–∞—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—ä–Ω—è (–∞–∫–æ –ª–æ—à–æ ‚Üí –º–æ–∂–µ –¥–∞ –Ω–∞–º–∞–ª–∏ TDEE)
- –°—Ç—Ä–µ—Å (–∞–∫–æ –≤–∏—Å–æ–∫ ‚Üí –º–æ–∂–µ –¥–∞ –Ω–∞–º–∞–ª–∏ TDEE)
- –ò—Å—Ç–æ—Ä–∏—è –Ω–∞ –¥–∏–µ—Ç–∏ (–∞–∫–æ –º–Ω–æ–≥–æ –¥–∏–µ—Ç–∏ ‚Üí –º–æ–∂–µ –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞ –º–µ—Ç–∞–±–æ–ª–∏–∑—ä–º)
- –ò —Ç.–Ω.

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑—á–∏—Å–ª—è–≤–∞ **–ø—Ä–µ—Ü–∏–∑–Ω–∏ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ç–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏** –∑–∞:
1. ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç —Å–∫–æ—Ä (1-10 —Å–∫–∞–ª–∞)
2. ‚úÖ BMR (Mifflin-St Jeor —Ñ–æ—Ä–º—É–ª–∞)
3. ‚úÖ TDEE (–±–∞–∑–∏—Ä–∞–Ω–æ –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç)
4. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–µ–Ω –¥–µ—Ñ–∏—Ü–∏—Ç (–º–∞–∫—Å–∏–º—É–º 25%)
5. ‚úÖ –ë–∞–∑–æ–≤–∏ –º–∞–∫—Ä–æ —Å—ä–æ—Ç–Ω–æ—à–µ–Ω–∏—è (–ø–æ–ª + –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç + —Ü–µ–ª)

–¢–µ–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ —Å–µ –ø–æ–¥–∞–≤–∞—Ç –∫—ä–º **AI –º–æ–¥–µ–ª–∞ –≤ –°—Ç—ä–ø–∫–∞ 1** –∫–∞—Ç–æ **—Ä–µ—Ñ–µ—Ä–µ–Ω—Ç–Ω–∏ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è**.

AI –∏–∑–ø–æ–ª–∑–≤–∞ —Ç–µ–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –∑–∞:
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è—Ç–∞
- –û—Ç–ø—Ä–∞–≤–Ω–∞ —Ç–æ—á–∫–∞ –∑–∞ –∫–æ—Ä–µ–∫—Ü–∏–∏
- –•–æ–ª–∏—Å—Ç–∏—á–µ–Ω –∞–Ω–∞–ª–∏–∑ –Ω–∞ –≤—Å–∏—á–∫–∏ —Ñ–∞–∫—Ç–æ—Ä–∏

**–†–µ–∑—É–ª—Ç–∞—Ç:** –ü—Ä–µ—Ü–∏–∑–Ω–∏, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –±–∞–∑–∏—Ä–∞–Ω–∏ –Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏ —Ñ–æ—Ä–º—É–ª–∏ –ò —Ü—è–ª–æ—Å—Ç–µ–Ω –∑–¥—Ä–∞–≤–æ—Å–ª–æ–≤–µ–Ω –∞–Ω–∞–ª–∏–∑.

---

**–î–∞—Ç–∞:** 2026-02-18  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–∞–Ω–æ –∏ –≤–∞–ª–∏–¥–∏—Ä–∞–Ω–æ
