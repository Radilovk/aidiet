# AI Prompts Directory

Тази папка съдържа всички AI промптове, използвани за генериране на хранителни планове и консултации.

## Файлове с промптове

### Стъпки на генериране на план

1. **admin_analysis_prompt.txt** - Анализ на здравословния профил
   - Входни данни: Пълен профил на потребителя
   - Изходни данни: Холистичен анализ с BMR, TDEE, макроси, психопрофил
   - Използва се в: `generateAnalysisPrompt()`

2. **admin_strategy_prompt.txt** - Определяне на диетична стратегия
   - Входни данни: Потребителски данни + Анализ
   - Изходни данни: Персонализирана стратегия с хранителен модел, време на хранене
   - Използва се в: `generateStrategyPrompt()`

3. **admin_meal_plan_prompt.txt** - Генериране на хранителен план
   - Входни данни: Данни + Анализ + Стратегия
   - Изходни данни: 7-дневен хранителен план с детайлни ястия
   - Използва се в: `generateMealPlanChunkPrompt()`

4. **admin_summary_prompt.txt** - Обобщение на плана
   - Входни данни: Данни + Анализ + План
   - Изходни данни: Резюме, препоръки, добавки
   - Използва се в: `generateMealPlanSummaryPrompt()`

### Чат режими

5. **admin_consultation_prompt.txt** - Режим на консултация
   - Използва се за четене и обяснение на плана БЕЗ промени
   - Използва се в: `generateChatPrompt()` с mode='consultation'

6. **admin_modification_prompt.txt** - Режим на промяна на плана
   - Използва се за обсъждане и прилагане на промени в плана
   - Използва се в: `generateChatPrompt()` с mode='modification'

7. **admin_correction_prompt.txt** - Корекция на грешки
   - Използва се за коригиране на невалидни планове
   - Използва се в: Validation error flow

## Формат на промптовете

Всички промптове използват специален формат с placeholders:
- `{name}` - Име на потребителя
- `{age}` - Възраст
- `{goal}` - Цел (отслабване, поддържане, набиране)
- `{bmr}` - Базова метаболитна скорост
- `{recommendedCalories}` - Препоръчителни калории
- И др.

Тези placeholders се заменят с реални данни от функцията `replacePromptVariables()`.

## Как се използват

1. **В worker.js**: Промптовете са дефинирани в `getDefaultPromptTemplates()` като fallback
2. **В KV storage**: Промптовете се качват с `upload-kv-keys.sh` скрипта
3. **В runtime**: Worker първо проверява за custom промптове в KV, иначе използва default

## Качване към Cloudflare KV

За да качите промптовете към Cloudflare:

```bash
cd /path/to/aidiet
./KV/upload-kv-keys.sh
```

Това ще качи всички промптове от тази папка към KV storage.

## Редактиране

За да редактирате промптове:

1. **Локално**: Редактирайте файловете в тази папка
2. **В admin panel**: https://aidiet.radilov-k.workers.dev/admin.html
3. **Директно в KV**: Чрез Cloudflare Dashboard

**ВАЖНО**: При редактиране в worker.js, актуализирайте съответния файл тук и обратно!

## Бележки

- Промптовете са на български език за по-добро разбиране от AI на локален контекст
- Всеки промпт е оптимизиран за конкретната стъпка в процеса
- Форматът е консистентен с оригиналните промптове от worker.js
