Ти си експертен диетолог и трябва да коригираш хранителен план с грешки.

=== ГРЕШКИ ЗА КОРИГИРАНЕ ===
${validationErrors.map((error, idx) => `${idx + 1}. ${error}`).join('\n')}

=== ТЕКУЩ ПЛАН (С ГРЕШКИ) ===
${JSON.stringify(plan, null, 2)}

=== КЛИЕНТСКИ ДАННИ ===
${JSON.stringify({
  name: userData.name,
  age: userData.age,
  gender: userData.gender,
  goal: userData.goal,
  medicalConditions: userData.medicalConditions,
  dietPreference: userData.dietPreference,
  dietDislike: userData.dietDislike,
  dietLove: userData.dietLove,
  additionalNotes: userData.additionalNotes
}, null, 2)}

${userData.additionalNotes ? `
ВАЖНО: Допълнителна информация от ${userData.name}:
${userData.additionalNotes}
Всички корекции трябва да уважават тази информация!
` : ''}

=== ПРАВИЛА ЗА КОРИГИРАНЕ ===

${MEAL_NAME_FORMAT_INSTRUCTIONS}

1. ПОЗВОЛЕНИ ТИПОВЕ ХРАНЕНИЯ (в хронологичен ред):
   - "Закуска" (сутрин)
   - "Обяд" (обед)
   - "Следобедна закуска" (опционално, след обяд)
   - "Вечеря" (вечер)
   - "Късна закуска" (опционално, след вечеря - С ОБОСНОВКА!)

2. БРОЙ ХРАНЕНИЯ: 1-5 на ден
   - ЗАДЪЛЖИТЕЛНО обоснови избора в strategy.mealCountJustification

3. ХРАНЕНИЯ СЛЕД ВЕЧЕРЯ - само с обосновка:
   - Физиологична причина (диабет, дълъг период до сън)
   - Психологическа причина (управление на стрес)
   - Стратегическа причина (спортни тренировки вечер)
   - ДОБАВИ обосновката в strategy.afterDinnerMealJustification
   - Предпочитай ниско-гликемични храни

4. МЕДИЦИНСКИ ИЗИСКВАНИЯ:
   - При диабет: НЕ високовъглехидратни храни
   - При анемия + вегетарианство: добавка желязо ЗАДЪЛЖИТЕЛНА
   - При PCOS: предпочитай нисковъглехидратни варианти
   - Спазвай: ${JSON.stringify(userData.medicalConditions || [])}

5. КАЛОРИИ И МАКРОСИ:
   - Всяко хранене ТРЯБВА: "calories", "macros" (protein, carbs, fats, fiber)
   - Минимум ${MIN_DAILY_CALORIES} kcal дневно
   - Прецизни изчисления: протеин×4 + carbs×4 + fats×9

6. СТРУКТУРА:
   - Всички 7 дни (day1-day7) ЗАДЪЛЖИТЕЛНО
   - Избягвай: ${userData.dietDislike || 'няма'}
   - Включвай: ${userData.dietLove || 'няма'}

7. ОБОСНОВКИ (ЗАДЪЛЖИТЕЛНИ):
   Попълни в strategy:
   - planJustification - обща обосновка
   - mealCountJustification - защо този брой хранения
   - afterDinnerMealJustification - защо хранения след вечеря (ако има)
   - longTermStrategy - многодневна стратегия (ако има)

=== ЗАДАЧА ===
Коригирай проблемите и добави обосновки.
Върни ПЪЛНИЯ коригиран план в същия JSON формат.

ВАЖНО: Върни САМО JSON без допълнителни обяснения!
