name = "aidiet-worker"
main = "worker.js"
compatibility_date = "2024-01-01"

# Unbound Workers enabled to support long-running AI requests (>30 seconds)
# This removes the wall-clock time limit and allows the multi-step AI generation
# process (70-170 seconds) to complete without timeouts.
# See: https://developers.cloudflare.com/workers/platform/limits/#cpu-time
# 
# Note: Unbound Workers requires a Cloudflare Paid plan.
# Pricing is based on CPU time + duration (external API calls don't count toward CPU time).
[usage_model]
type = "unbound"

# KV Namespace binding
[[kv_namespaces]]
binding = "page_content"
id = "81fc0991b2764918b682f9ca170abd4b"

# Environment variables for API keys (configure via wrangler secret)
# Run: wrangler secret put OPENAI_API_KEY
# Run: wrangler secret put GEMINI_API_KEY

[env.production]
name = "aidiet-worker"
route = "aidiet.radilov-k.workers.dev/*"

[[env.production.kv_namespaces]]
binding = "page_content"
id = "81fc0991b2764918b682f9ca170abd4b"
