# –ü–™–õ–ù–ê –°–•–ï–ú–ê: –ê–ù–ê–õ–ò–ó –ò –ò–ó–ì–û–¢–í–Ø–ù–ï –ù–ê –•–†–ê–ù–ò–¢–ï–õ–ï–ù –ü–õ–ê–ù

## üìã –°–™–î–™–†–ñ–ê–ù–ò–ï

1. [–û–±—â –ü—Ä–µ–≥–ª–µ–¥](#–æ–±—â-–ø—Ä–µ–≥–ª–µ–¥)
2. [–°—Ç—ä–ø–∫–∞ 1: –ü–æ–ø—ä–ª–≤–∞–Ω–µ –Ω–∞ –í—ä–ø—Ä–æ—Å–Ω–∏–∫](#—Å—Ç—ä–ø–∫–∞-1-–ø–æ–ø—ä–ª–≤–∞–Ω–µ-–Ω–∞-–≤—ä–ø—Ä–æ—Å–Ω–∏–∫)
3. [–°—Ç—ä–ø–∫–∞ 2: –°—ä–±–∏—Ä–∞–Ω–µ –∏ –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –î–∞–Ω–Ω–∏](#—Å—Ç—ä–ø–∫–∞-2-—Å—ä–±–∏—Ä–∞–Ω–µ-–∏-–≤–∞–ª–∏–¥–∞—Ü–∏—è-–Ω–∞-–¥–∞–Ω–Ω–∏)
4. [–°—Ç—ä–ø–∫–∞ 3: –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –ü–ª–∞–Ω (AI Multi-Step)](#—Å—Ç—ä–ø–∫–∞-3-–≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ-–Ω–∞-–ø–ª–∞–Ω-ai-multi-step)
5. [–°—Ç—ä–ø–∫–∞ 4: –°—ä—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –î–∞–Ω–Ω–∏](#—Å—Ç—ä–ø–∫–∞-4-—Å—ä—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–∞-–¥–∞–Ω–Ω–∏)
6. [–°—Ç—ä–ø–∫–∞ 5: –ò–∑–≤–µ–∂–¥–∞–Ω–µ –≤ –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏—è –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å](#—Å—Ç—ä–ø–∫–∞-5-–∏–∑–≤–µ–∂–¥–∞–Ω–µ-–≤-–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏—è-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
7. [–°—Ç—ä–ø–∫–∞ 6: –ß–∞—Ç –ê—Å–∏—Å—Ç–µ–Ω—Ç](#—Å—Ç—ä–ø–∫–∞-6-—á–∞—Ç-–∞—Å–∏—Å—Ç–µ–Ω—Ç)
8. [–°—Ç—Ä—É–∫—Ç—É—Ä–∏ –Ω–∞ –î–∞–Ω–Ω–∏](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∏-–Ω–∞-–¥–∞–Ω–Ω–∏)
9. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –î–µ—Ç–∞–π–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏-–¥–µ—Ç–∞–π–ª–∏)

---

## üéØ –û–ë–© –ü–†–ï–ì–õ–ï–î

### –¶–µ–ª—Ç–∞ –Ω–∞ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ

AI Diet –µ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∑–∞ —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –Ω–∞–ø—ä–ª–Ω–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ —Ö—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –ø–ª–∞–Ω–æ–≤–µ —á—Ä–µ–∑ –∏–∑–∫—É—Å—Ç–≤–µ–Ω –∏–Ω—Ç–µ–ª–µ–∫—Ç (AI). –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ —Å—ä–±–∏—Ä–∞ –∑–∞–¥—ä–ª–±–æ—á–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è, –∞–Ω–∞–ª–∏–∑–∏—Ä–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∞–∫—Ç–æ—Ä–∏ –∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª–µ–Ω 7-–¥–Ω–µ–≤–µ–Ω —Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–Ω –ø–ª–∞–Ω —Å –¥–µ—Ç–∞–π–ª–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –≤—Å—è–∫–æ —Ö—Ä–∞–Ω–µ–Ω–µ.

### –ì–ª–æ–±–∞–ª–µ–Ω –ü–æ—Ç–æ–∫ –Ω–∞ –î–∞–Ω–Ω–∏—Ç–µ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1. –í–™–ü–†–û–°–ù–ò–ö       ‚îÇ  –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –ø–æ–ø—ä–ª–≤–∞ –¥–µ—Ç–∞–π–ª–µ–Ω –≤—ä–ø—Ä–æ—Å–Ω–∏–∫
‚îÇ  questionnaire.html ‚îÇ  ‚Üí –°—ä–±–∏—Ä–∞—Ç —Å–µ 40+ –ø–∞—Ä–∞–º–µ—Ç—ä—Ä–∞
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2. –í–ê–õ–ò–î–ê–¶–ò–Ø       ‚îÇ  –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏ –ø–æ–ª–µ—Ç–∞
‚îÇ  Frontend JS        ‚îÇ  ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø–∏—Å–≤–∞–Ω–µ –≤ localStorage
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3. –ò–ó–ü–†–ê–©–ê–ù–ï       ‚îÇ  POST /api/generate-plan
‚îÇ  HTTPS Request      ‚îÇ  ‚Üí –î–∞–Ω–Ω–∏—Ç–µ —Å–µ –∏–∑–ø—Ä–∞—â–∞—Ç –∫—ä–º Cloudflare Worker
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  4. AI –û–ë–†–ê–ë–û–¢–ö–ê    ‚îÇ  Multi-step –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ (6 AI –∑–∞—è–≤–∫–∏)
‚îÇ  worker.js          ‚îÇ  ‚Üí –ê–Ω–∞–ª–∏–∑ ‚Üí –°—Ç—Ä–∞—Ç–µ–≥–∏—è ‚Üí –•—Ä–∞–Ω–µ–Ω–∏—è ‚Üí –û–±–æ–±—â–µ–Ω–∏–µ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  5. –û–¢–ì–û–í–û–†         ‚îÇ  –ü–æ–ª—É—á–∞–≤–∞–Ω–µ –Ω–∞ –ø—ä–ª–µ–Ω –ø–ª–∞–Ω (JSON)
‚îÇ  JSON Response      ‚îÇ  ‚Üí –ü–ª–∞–Ω, –∞–Ω–∞–ª–∏–∑, –ø—Ä–µ–ø–æ—Ä—ä–∫–∏, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  6. –õ–û–ö–ê–õ–ù–û         ‚îÇ  –°—ä—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage –Ω–∞ –±—Ä–∞—É–∑—ä—Ä–∞
‚îÇ  –°–™–•–†–ê–ù–ï–ù–ò–ï         ‚îÇ  ‚Üí dietPlan, userData, userId
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  7. –ü–†–ï–ù–ê–°–û–ß–í–ê–ù–ï    ‚îÇ  Redirect –∫—ä–º analysis.html
‚îÇ  analysis.html      ‚îÇ  ‚Üí –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –∑–¥—Ä–∞–≤–Ω–∏—è –∞–Ω–∞–ª–∏–∑
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  8. –ü–†–ï–ì–õ–ï–î –ü–õ–ê–ù    ‚îÇ  –ù–∞–≤–∏–≥–∞—Ü–∏—è –∫—ä–º plan.html
‚îÇ  plan.html          ‚îÇ  ‚Üí 7-–¥–Ω–µ–≤–µ–Ω –ø–ª–∞–Ω —Å –Ω–∞–≤–∏–≥–∞—Ü–∏—è, –¥–µ—Ç–∞–π–ª–∏, —á–∞—Ç
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–ª—é—á–æ–≤–∏ –ü—Ä–∏–Ω—Ü–∏–ø–∏

1. **–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç –Ω–∞ –ø—ä—Ä–≤–æ –º—è—Å—Ç–æ** - –í—Å–∏—á–∫–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –¥–∞–Ω–Ω–∏ —Å–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞—Ç –°–ê–ú–û –ª–æ–∫–∞–ª–Ω–æ –≤ –±—Ä–∞—É–∑—ä—Ä–∞ (localStorage). –°—ä—Ä–≤—ä—Ä—ä—Ç –ù–ï –ü–ê–ó–ò –Ω–∏–∫–∞–∫–≤–∏ –ª–∏—á–Ω–∏ –¥–∞–Ω–Ω–∏.
2. **–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –∫–æ–º–ø—Ä–æ–º–∏—Å** - –ù–£–õ–ê —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ. –í—Å–∏—á–∫–æ —Å–µ –∏–∑—á–∏—Å–ª—è–≤–∞ —Å–ø–µ—Ü–∏–∞–ª–Ω–æ –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª.
3. **Multi-step AI –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - 6 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ AI –∑–∞—è–≤–∫–∏ –∑–∞ –º–∞–∫—Å–∏–º–∞–ª–Ω–∞ –ø—Ä–µ—Ü–∏–∑–Ω–æ—Å—Ç –∏ –∫–∞—á–µ—Å—Ç–≤–æ.
4. **Token –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - 59% –Ω–∞–º–∞–ª–µ–Ω–∏–µ –Ω–∞ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω–∏ —á—Ä–µ–∑ –∫–æ–º–ø–∞–∫—Ç–µ–Ω —Ñ–æ—Ä–º–∞—Ç –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ.

---
## üìù –°–¢–™–ü–ö–ê 1: –ü–û–ü–™–õ–í–ê–ù–ï –ù–ê –í–™–ü–†–û–°–ù–ò–ö

### –§–∞–π–ª: `questionnaire.html`

### –¶–µ–ª
–°—ä–±–∏—Ä–∞–Ω–µ –Ω–∞ –∑–∞–¥—ä–ª–±–æ—á–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è —á—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–µ–Ω –≤—ä–ø—Ä–æ—Å–Ω–∏–∫. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è—Ç–∞ –æ–±—Ö–≤–∞—â–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, —Ö—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –Ω–∞–≤–∏—Ü–∏, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —Ñ–∞–∫—Ç–æ—Ä–∏ –∏ –ª–∏—á–Ω–∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –í—ä–ø—Ä–æ—Å–Ω–∏–∫–∞

–í—ä–ø—Ä–æ—Å–Ω–∏–∫—ä—Ç –µ —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ **6 –æ—Å–Ω–æ–≤–Ω–∏ —Å–µ–∫—Ü–∏–∏** —Å –æ–±—â–æ **38+ –≤—ä–ø—Ä–æ—Å–∞**:

#### **–°–ï–ö–¶–ò–Ø 1: –û—Å–Ω–æ–≤–Ω–∏ –î–∞–Ω–Ω–∏**
- **–ò–º–µ** (—Ç–µ–∫—Å—Ç) - –ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –∑–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –ø–ª–∞–Ω–∞
- **–ü–æ–ª** (–ú—ä–∂/–ñ–µ–Ω–∞) - –ö—Ä–∏—Ç–∏—á–µ–Ω –∑–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ BMR (–±–∞–∑–æ–≤ –º–µ—Ç–∞–±–æ–ª–∏–∑—ä–º)
- **–í—ä–∑—Ä–∞—Å—Ç** (—á–∏—Å–ª–æ, –≥–æ–¥–∏–Ω–∏) - –í–ª–∏—è–µ –≤—ä—Ä—Ö—É –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞ –∏ –∫–∞–ª–æ—Ä–∏—á–Ω–∏ –Ω—É–∂–¥–∏
- **–†—ä—Å—Ç** (—á–∏—Å–ª–æ, —Å–º) - –ó–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ BMR –∏ BMI
- **–¢–µ–≥–ª–æ** (—á–∏—Å–ª–æ, –∫–≥) - –ó–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ BMR, BMI –∏ TDEE
- **Email** (–∏–º–µ–π–ª) - –ó–∞ –±—ä–¥–µ—â–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∏ (–Ω–µ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ —Ç–µ–∫—É—â–æ)
- **–¶–µ–ª** (–∏–∑–±–æ—Ä)
  - –û—Ç—Å–ª–∞–±–≤–∞–Ω–µ (—Å –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–µ–Ω –≤—ä–ø—Ä–æ—Å: –∫–æ–ª–∫–æ –∫–≥ –∂–µ–ª–∞–µ—Ç–µ –¥–∞ —Å–≤–∞–ª–∏—Ç–µ?)
  - –ö–∞—á–≤–∞–Ω–µ –Ω–∞ –º—É—Å–∫—É–ª–Ω–∞ –º–∞—Å–∞
  - –ü–æ–¥–¥—ä—Ä–∂–∞–Ω–µ –Ω–∞ —Ç–µ–≥–ª–æ—Ç–æ
  - –ü–æ–¥–æ–±—Ä—è–≤–∞–Ω–µ –Ω–∞ –∑–¥—Ä–∞–≤–µ—Ç–æ
  - –ü–æ–≤–µ—á–µ –µ–Ω–µ—Ä–≥–∏—è

**–û—Ç–∫—ä–¥–µ –∏–¥–≤–∞—Ç –¥–∞–Ω–Ω–∏—Ç–µ:** –î–∏—Ä–µ–∫—Ç–Ω–æ –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è, —Ä—ä—á–Ω–æ –≤—ä–≤–µ–∂–¥–∞–Ω–µ.
**–ö–∞–∫ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç:** –ó–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ BMR, TDEE, —Ü–µ–ª–µ–≤–∏ –∫–∞–ª–æ—Ä–∏–∏ –∏ –º–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–∏. –ò–º–µ—Ç–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞ —Å—ä–æ–±—â–µ–Ω–∏—è—Ç–∞.
**–ö—ä–¥–µ –æ—Ç–∏–≤–∞—Ç:** –°—ä—Ö—Ä–∞–Ω—è–≤–∞—Ç —Å–µ –≤ `localStorage` –∫–∞—Ç–æ —á–∞—Å—Ç –æ—Ç –æ–±–µ–∫—Ç `userData` –∏ —Å–µ –∏–∑–ø—Ä–∞—â–∞—Ç –∫—ä–º AI –∑–∞ –∞–Ω–∞–ª–∏–∑.

#### **–°–ï–ö–¶–ò–Ø 2: –°—ä–Ω, –†–∏—Ç—ä–º –∏ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç**
- **–ß–∞—Å–æ–≤–µ —Å—ä–Ω** (–ü–æ-–º–∞–ª–∫–æ –æ—Ç 6h / 6-7h / 7-8h / 8-9h / –ü–æ–≤–µ—á–µ –æ—Ç 9h)
- **–ü—Ä–µ–∫—ä—Å–≤–∞–Ω–∏—è –Ω–∞ —Å—ä–Ω—è** (–î–∞/–ù–µ) - –í–ª–∏—è–µ –Ω–∞ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞ –∏ —Å—Ç—Ä–µ—Å–∞
- **–•—Ä–æ–Ω–æ—Ç–∏–ø** (–°—É—Ç—Ä–µ—à–µ–Ω/–í–µ—á–µ—Ä–µ–Ω/–ù–µ—É—Ç—Ä–∞–ª–µ–Ω) - –ó–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ –≤—Ä–µ–º–µ—Ç–æ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–µ
- **–î–Ω–µ–≤–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç** (–ù–∏—Å–∫–∞/–°—Ä–µ–¥–Ω–∞/–í–∏—Å–æ–∫–∞)
- **–ù–∏–≤–æ –Ω–∞ —Å—Ç—Ä–µ—Å** (–ù–∏—Å–∫–æ/–°—Ä–µ–¥–Ω–æ/–í–∏—Å–æ–∫–æ) - –ö–æ—Ä–µ–ª–∏—Ä–∞ —Å –µ–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–µ
- **–°–ø–æ—Ä—Ç–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç** (–ù–µ —Å–ø–æ—Ä—Ç—É–≤–∞–º / 1-2 –ø—ä—Ç–∏ —Å–µ–¥–º–∏—á–Ω–æ / 3-4 –ø—ä—Ç–∏ / 5+ –ø—ä—Ç–∏)

**–û—Ç–∫—ä–¥–µ –∏–¥–≤–∞—Ç –¥–∞–Ω–Ω–∏—Ç–µ:** –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª, –æ—Ü–µ–Ω–∫–∞ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–∏—Ç–µ —Å–∏ –Ω–∞–≤–∏—Ü–∏.
**–ö–∞–∫ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç:** 
- –ß–∞—Å–æ–≤–µ —Å—ä–Ω –≤–ª–∏—è—è—Ç –Ω–∞ TDEE (–ø–æ-–º–∞–ª–∫–æ —Å—ä–Ω = –ø–æ-–±–∞–≤–µ–Ω –º–µ—Ç–∞–±–æ–ª–∏–∑—ä–º)
- –•—Ä–æ–Ω–æ—Ç–∏–ø –æ–ø—Ä–µ–¥–µ–ª—è –≤—Ä–µ–º–µ—Ç–æ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–µ (—Å—É—Ç—Ä–µ—à–Ω–∏/–≤–µ—á–µ—Ä–Ω–∏ —Ö–æ—Ä–∞)
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç –æ–ø—Ä–µ–¥–µ–ª—è –º–Ω–æ–∂–∏—Ç–µ–ª—è –∑–∞ TDEE (sedentary x1.2, active x1.55, very active x1.9)
- –°—Ç—Ä–µ—Å –∫–æ—Ä–µ–ª–∏—Ä–∞ —Å –∫–æ—Ä—Ç–∏–∑–æ–ª ‚Üí –≤–ª–∏—è–µ –Ω–∞ –æ—Ç–ª–∞–≥–∞–Ω–µ—Ç–æ –Ω–∞ –º–∞–∑–Ω–∏–Ω–∏

**–ö—ä–¥–µ –æ—Ç–∏–≤–∞—Ç:** –ß–∞—Å—Ç –æ—Ç `userData`, –∏–∑–ø–æ–ª–∑–≤–∞—Ç —Å–µ –≤ AI –∞–Ω–∞–ª–∏–∑–∞ –∑–∞ –∫–æ—Ä–µ–ª–∞—Ü–∏–∏.

#### **–°–ï–ö–¶–ò–Ø 3: –ü—Ä–∏–µ–º –Ω–∞ –¢–µ—á–Ω–æ—Å—Ç–∏**
- **–í–æ–¥–∞ –¥–Ω–µ–≤–Ω–æ** (–ü–æ–¥ 1–ª / 1-2–ª / 2-3–ª / –ù–∞–¥ 3–ª)
- **–°–ª–∞–¥–∫–∏ –Ω–∞–ø–∏—Ç–∫–∏** (–ù–∏–∫–æ–≥–∞ / –†—è–¥–∫–æ / –ß–µ—Å—Ç–æ / –ú–Ω–æ–≥–æ —á–µ—Å—Ç–æ)
- **–ê–ª–∫–æ—Ö–æ–ª–Ω–∏ –Ω–∞–ø–∏—Ç–∫–∏** (–ù–∏–∫–æ–≥–∞ / –†—è–¥–∫–æ / –ß–µ—Å—Ç–æ / –ú–Ω–æ–≥–æ —á–µ—Å—Ç–æ)

**–û—Ç–∫—ä–¥–µ –∏–¥–≤–∞—Ç –¥–∞–Ω–Ω–∏—Ç–µ:** –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª, —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∞.
**–ö–∞–∫ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç:** 
- –ù–µ–¥–æ—Å—Ç–∞—Ç—ä—á–Ω–∞ —Ö–∏–¥—Ä–∞—Ç–∞—Ü–∏—è –≤–ª–∏—è–µ –Ω–∞ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞
- –°–ª–∞–¥–∫–∏ –Ω–∞–ø–∏—Ç–∫–∏ –¥–æ–±–∞–≤—è—Ç "—Å–∫—Ä–∏—Ç–∏ –∫–∞–ª–æ—Ä–∏–∏"
- –ê–ª–∫–æ—Ö–æ–ª –≤–ª–∏—è–µ –Ω–∞ —á–µ—Ä–Ω–æ–¥—Ä–æ–±–Ω–∞—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏ —É—Å–≤–æ—è–≤–∞–Ω–µ—Ç–æ –Ω–∞ —Ö—Ä–∞–Ω–∏

**–ö—ä–¥–µ –æ—Ç–∏–≤–∞—Ç:** –ß–∞—Å—Ç –æ—Ç `userData`, AI –¥–∞–≤–∞ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞–Ω–µ.

#### **–°–ï–ö–¶–ò–Ø 4: –•—Ä–∞–Ω–µ–Ω–µ –∏ –ü–æ–≤–µ–¥–µ–Ω–∏–µ** (–Ω–∞–π-–¥—ä–ª–≥–∞—Ç–∞ —Å–µ–∫—Ü–∏—è)
- **–ü—Ä–æ–º—è–Ω–∞ –Ω–∞ —Ç–µ–≥–ª–æ—Ç–æ** (–°—Ç–∞–±–∏–ª–Ω–æ / –ö–∞—á–≤–∞–º / –°–≤–∞–ª—è–º / –ô–æ-–π–æ –µ—Ñ–µ–∫—Ç) + –î–µ—Ç–∞–π–ª–∏ –∞–∫–æ –Ω–µ –µ —Å—Ç–∞–±–∏–ª–Ω–æ
- **–ò—Å—Ç–æ—Ä–∏—è –Ω–∞ –¥–∏–µ—Ç–∏** (–î–∞/–ù–µ) + –ö–æ–∏ –¥–∏–µ—Ç–∏ –∏ –∫–∞–∫—ä–≤ —Ä–µ–∑—É–ª—Ç–∞—Ç
- **–ü—Ä–µ—è–∂–¥–∞–Ω–µ** (–ù–∏–∫–æ–≥–∞ / –†—è–¥–∫–æ / –ü–æ–Ω—è–∫–æ–≥–∞ / –ß–µ—Å—Ç–æ / –ú–Ω–æ–≥–æ —á–µ—Å—Ç–æ)
- **–•—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –∂–µ–ª–∞–Ω–∏—è** (–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑–±–æ—Ä —Å –≤–∑–∞–∏–º–Ω–æ –∏–∑–∫–ª—é—á–≤–∞–Ω–µ)
  - –°–ª–∞–¥–∫–æ
  - –°–æ–ª–µ–Ω–æ
  - –ú–∞–∑–Ω–æ
  - –í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏
  - –ú–µ—Å–æ
  - –î—Ä—É–≥–∏ + –æ–ø–∏—Å–∞–Ω–∏–µ
  - –ù—è–º–∞ (–≤–∑–∞–∏–º–Ω–æ –∏–∑–∫–ª—é—á–≤–∞ –≤—Å–∏—á–∫–æ)
- **–¢—Ä–∏–≥–µ—Ä–∏ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ** (–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑–±–æ—Ä)
  - –°—Ç—Ä–µ—Å
  - –°–∫—É–∫–∞
  - –ï–º–æ—Ü–∏–∏ (—Ç—ä–≥–∞, –≥–Ω—è–≤)
  - –°–æ—Ü–∏–∞–ª–Ω–∏ —Å–∏—Ç—É–∞—Ü–∏–∏
  - –£–º–æ—Ä–∞
  - –î—Ä—É–≥–∏ + –æ–ø–∏—Å–∞–Ω–∏–µ
  - –ù—è–º–∞
- **–•—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –Ω–∞–≤–∏—Ü–∏** (–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑–±–æ—Ä —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–Ω–∏ –∏–∑–∫–ª—é—á–≤–∞—â–∏ –æ–ø—Ü–∏–∏)
  - –†–µ–¥–æ–≤–Ω–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è
  - –ó–∞–∫—É—Å–∫–∞ –≤—Å–µ–∫–∏ –¥–µ–Ω
  - –í–µ—á–µ—Ä—è –¥–æ 19:00h
  - –ó–∞–∫—É—Å–∫–∏ –º–µ–∂–¥—É —Ö—Ä–∞–Ω–µ–Ω–∏—è
  - –•—Ä–∞–Ω–∞ –ø—Ä–µ–¥ –µ–∫—Ä–∞–Ω
  - –ë—ä—Ä–∑–æ —Ö—Ä–∞–Ω–µ–Ω–µ
  - –ü—Ä–æ–ø—É—Å–∫–∞–º —Ö—Ä–∞–Ω–µ–Ω–∏—è
  - –ë–µ–∑–∫–æ–Ω—Ç—Ä–æ–ª–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–µ
  - –ù–æ—â–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–µ
- **–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —Å–ª–µ–¥ –ø—Ä–µ—è–∂–¥–∞–Ω–µ** (–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑–±–æ—Ä)
  - –ò–Ω—Ç–µ–Ω–∑–∏–≤–µ–Ω —Å–ø–æ—Ä—Ç
  - –ì–ª–∞–¥—É–≤–∞–Ω–µ
  - –ü–æ–≤—Ä—ä—â–∞–Ω–µ (–∫—Ä–∏—Ç–∏—á–µ–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä!)
  - –õ–∞–∫—Å–∞—Ç–∏–≤–∏ (–∫—Ä–∏—Ç–∏—á–µ–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä!)
  - –î—Ä—É–≥–∏
  - –ù–µ –∫–æ–º–ø–µ–Ω—Å–∏—Ä–∞–º
- **–°–æ—Ü–∏–∞–ª–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ** (–ù–∏–∫–æ–≥–∞ / –†—è–¥–∫–æ / –ü–æ–Ω—è–∫–æ–≥–∞ / –ß–µ—Å—Ç–æ / –í–∏–Ω–∞–≥–∏)

**–û—Ç–∫—ä–¥–µ –∏–¥–≤–∞—Ç –¥–∞–Ω–Ω–∏—Ç–µ:** –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞ —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∞.
**–ö–∞–∫ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç:**
- –î–µ—Ç–µ–∫—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —Ä–∞–∑—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–µ—Ç–æ (–±—É–ª–∏–º–∏—è, –∞–Ω–æ—Ä–µ–∫—Å–∏—è - –ø–æ–≤—Ä—ä—â–∞–Ω–µ, –ª–∞–∫—Å–∞—Ç–∏–≤–∏)
- –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–µ –Ω–∞ –µ–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–µ ‚Üí –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —Å—ä–≤–µ—Ç–∏
- –ö–æ—Ä–∏–≥–∏—Ä–∞–Ω–µ –Ω–∞ —Ö—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏—Ç–µ –Ω–∞–≤–∏—Ü–∏
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞–Ω–µ –Ω–∞ —Å—Ä–∏–≤ –≤ –¥–∏–µ—Ç–∞

**–ö—ä–¥–µ –æ—Ç–∏–≤–∞—Ç:** –ß–∞—Å—Ç –æ—Ç `userData`, –∫—Ä–∏—Ç–∏—á–Ω–∏ –∑–∞ —Å–µ–∫—Ü–∏—è—Ç–∞ "psychology" –≤ –ø–ª–∞–Ω–∞.

#### **–°–ï–ö–¶–ò–Ø 5: –•—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è**
- **–¢–∏–ø –¥–∏–µ—Ç–∞** (–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑–±–æ—Ä —Å –≤–∑–∞–∏–º–Ω–æ –∏–∑–∫–ª—é—á–≤–∞–Ω–µ)
  - –í—Å–∏—á–∫–æ
  - –í–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∞
  - –í–µ–≥–∞–Ω
  - –ö–µ—Ç–æ
  - –°—Ä–µ–¥–∏–∑–µ–º–Ω–æ–º–æ—Ä—Å–∫–∞
  - –ù–∏—Å–∫–æ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–Ω–∞
  - –í–∏—Å–æ–∫–æ –ø—Ä–æ—Ç–µ–∏–Ω–æ–≤–∞
  - –ë–µ–∑ –≥–ª—É—Ç–µ–Ω
  - –ë–µ–∑ –ª–∞–∫—Ç–æ–∑–∞
- **–•—Ä–∞–Ω–∏, –∫–æ–∏—Ç–æ –ù–ï –æ–±–∏—á–∞—Ç–µ / –∞–ª–µ—Ä–≥–∏–∏** (—Å–≤–æ–±–æ–¥–µ–Ω —Ç–µ–∫—Å—Ç)
- **–•—Ä–∞–Ω–∏, –∫–æ–∏—Ç–æ –ú–ù–û–ì–û –æ–±–∏—á–∞—Ç–µ** (—Å–≤–æ–±–æ–¥–µ–Ω —Ç–µ–∫—Å—Ç)

**–û—Ç–∫—ä–¥–µ –∏–¥–≤–∞—Ç –¥–∞–Ω–Ω–∏—Ç–µ:** –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª, –ª–∏—á–Ω–∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è.
**–ö–∞–∫ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç:**
- –û–ø—Ä–µ–¥–µ–ª—è—Ç dietary modifier (Vegetarian, Keto, Mediterranean –∏ —Ç.–Ω.)
- –ò–∑–∫–ª—é—á–≤–∞—Ç –∞–ª–µ—Ä–≥–µ–Ω–∏ –æ—Ç –ø–ª–∞–Ω–∞
- –í–∫–ª—é—á–≤–∞—Ç –ª—é–±–∏–º–∏ —Ö—Ä–∞–Ω–∏ –∑–∞ –ø–æ-–¥–æ–±—Ä–æ —Å–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –¥–∏–µ—Ç–∞—Ç–∞

**–ö—ä–¥–µ –æ—Ç–∏–≤–∞—Ç:** –ß–∞—Å—Ç –æ—Ç `userData`, –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤–ª–∏—è—è—Ç –Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏—Ç–µ —è—Å—Ç–∏—è.

#### **–°–ï–ö–¶–ò–Ø 6: –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–æ –°—ä—Å—Ç–æ—è–Ω–∏–µ**
- **–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏ —Å—ä—Å—Ç–æ—è–Ω–∏—è** (–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑–±–æ—Ä)
  - –ù—è–º–∞
  - –î–∏–∞–±–µ—Ç —Ç–∏–ø 1
  - –î–∏–∞–±–µ—Ç —Ç–∏–ø 2
  - –•–∏–ø–µ—Ä—Ç–æ–Ω–∏—è
  - –•–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º
  - –•–∏–ø–µ—Ä—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º
  - PCOS (—Å–∏–Ω–¥—Ä–æ–º –Ω–∞ –ø–æ–ª–∏–∫–∏—Å—Ç–æ–∑–Ω–∏—Ç–µ —è–π—á–Ω–∏—Ü–∏)
  - –•—Ä–æ–Ω–∏—á–Ω–æ –≤—ä–∑–ø–∞–ª–µ–Ω–∏–µ
  - –ê–ª–µ—Ä–≥–∏–∏ + –¥–µ—Ç–∞–π–ª–∏ (—Å–≤–æ–±–æ–¥–µ–Ω —Ç–µ–∫—Å—Ç)
  - –ê–≤—Ç–æ–∏–º—É–Ω–Ω–æ –∑–∞–±–æ–ª—è–≤–∞–Ω–µ + –¥–µ—Ç–∞–π–ª–∏ (—Å–≤–æ–±–æ–¥–µ–Ω —Ç–µ–∫—Å—Ç)
  - –ß–µ—Ä–Ω–æ–¥—Ä–æ–±–Ω–∏ –ø—Ä–æ–±–ª–µ–º–∏
  - –ë—ä–±—Ä–µ—á–Ω–∏ –ø—Ä–æ–±–ª–µ–º–∏
  - –î—Ä—É–≥–∏ + –æ–ø–∏—Å–∞–Ω–∏–µ
- **–ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç–∏** (–î–∞/–ù–µ) + –ö–æ–∏ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç–∏ (—Å–≤–æ–±–æ–¥–µ–Ω —Ç–µ–∫—Å—Ç)

**–û—Ç–∫—ä–¥–µ –∏–¥–≤–∞—Ç –¥–∞–Ω–Ω–∏—Ç–µ:** –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞ –∞–Ω–∞–º–Ω–µ–∑–∞.
**–ö–∞–∫ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç:**
- **–ö–†–ò–¢–ò–ß–ù–û –í–ê–ñ–ù–ò** - –í–ª–∏—è—è—Ç –Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏—è –ø–ª–∞–Ω (–Ω–∞–ø—Ä. –¥–∏–∞–±–µ—Ç ‚Üí –Ω–∏—Å–∫–æ –≥–ª–∏–∫–µ–º–∏—á–µ–Ω –∏–Ω–¥–µ–∫—Å)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (–Ω–∞–ø—Ä. Warfarin + Vitamin K = –æ–ø–∞—Å–Ω–æ)
- –ö–æ—Ä–µ–∫—Ü–∏–∏ –≤ –º–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–∏—Ç–µ (PCOS ‚Üí –ø–æ-–º–∞–ª–∫–æ –ø—Ä–æ—Å—Ç–∏ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏)
- Supplement –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ (—Ö–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º ‚Üí —Å–µ–ª–µ–Ω, –π–æ–¥)

**–ö—ä–¥–µ –æ—Ç–∏–≤–∞—Ç:** –ß–∞—Å—Ç –æ—Ç `userData`, –∏–∑–ø–æ–ª–∑–≤–∞—Ç —Å–µ –∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø–ª–∞–Ω–∞ –∏ –∫–æ—Ä–∏–≥–∏—Ä–∞—â–∏ –ø—Ä–æ–º–µ–Ω–∏.

#### **–°–ï–ö–¶–ò–Ø 7: –î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**
- **–ë–µ–ª–µ–∂–∫–∏** (—Å–≤–æ–±–æ–¥–µ–Ω —Ç–µ–∫—Å—Ç) - –í—Å—è–∫–∞–∫–≤–∞ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–û—Ç–∫—ä–¥–µ –∏–¥–≤–∞—Ç –¥–∞–Ω–Ω–∏—Ç–µ:** –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª, —Å–≤–æ–±–æ–¥–Ω–∏ –±–µ–ª–µ–∂–∫–∏.
**–ö–∞–∫ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç:** AI –≥–∏ –≤–∑–µ–º–∞ –ø—Ä–µ–¥–≤–∏–¥ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –ø–ª–∞–Ω–∞.
**–ö—ä–¥–µ –æ—Ç–∏–≤–∞—Ç:** –ß–∞—Å—Ç –æ—Ç `userData`.

### –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- **–ü—Ä–æ–≥—Ä–µ—Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä** - –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–∞ –Ω–∞–ø—Ä–µ–¥—ä–∫–∞ –ø—Ä–µ–∑ —Å–µ–∫—Ü–∏–∏—Ç–µ
- **–î–∏–Ω–∞–º–∏—á–Ω–∏ –ø–æ–¥–≤—ä–ø—Ä–æ—Å–∏** - –ü–æ–∫–∞–∑–≤–∞—Ç —Å–µ —Å–∞–º–æ –∫–æ–≥–∞—Ç–æ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ (—É—Å–ª–æ–≤–Ω–∞ –ª–æ–≥–∏–∫–∞)
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤ —Ä–µ–∞–ª–Ω–æ –≤—Ä–µ–º–µ** - –ë—É—Ç–æ–Ω—ä—Ç "–ù–∞–ø—Ä–µ–¥" –µ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω –¥–æ–∫–∞—Ç–æ –Ω–µ —Å–µ –ø–æ–ø—ä–ª–Ω—è—Ç –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏—Ç–µ –ø–æ–ª–µ—Ç–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø–∏—Å–≤–∞–Ω–µ** - –í—Å–µ–∫–∏ –æ—Ç–≥–æ–≤–æ—Ä —Å–µ –∑–∞–ø–∏—Å–≤–∞ –≤–µ–¥–Ω–∞–≥–∞ –≤ `localStorage`
- **–í—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞–Ω–µ** - –ü—Ä–∏ –ø—Ä–µ–∑–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞ –æ—Ç–≥–æ–≤–æ—Ä–∏—Ç–µ —Å–µ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞—Ç

---
## üîç –°–¢–™–ü–ö–ê 2: –°–™–ë–ò–†–ê–ù–ï –ò –í–ê–õ–ò–î–ê–¶–ò–Ø –ù–ê –î–ê–ù–ù–ò

### –§–∞–π–ª: `questionnaire.html` (JavaScript —á–∞—Å—Ç)

### –ö–∞–∫ –†–∞–±–æ—Ç–∏ –°—ä–±–∏—Ä–∞–Ω–µ—Ç–æ

#### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –î–∞–Ω–Ω–∏—Ç–µ

–í—Å–∏—á–∫–∏ –æ—Ç–≥–æ–≤–æ—Ä–∏ —Å–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞—Ç –≤ JavaScript –æ–±–µ–∫—Ç `answers`:

```javascript
answers = {
  // –û—Å–Ω–æ–≤–Ω–∏ –¥–∞–Ω–Ω–∏
  name: "–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞",
  gender: "–ñ–µ–Ω–∞",
  age: 35,
  height: 165,
  weight: 78,
  email: "maria@example.com",
  goal: "–û—Ç—Å–ª–∞–±–≤–∞–Ω–µ",
  lossKg: 10,
  
  // –°—ä–Ω –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç
  sleepHours: "6-7h",
  sleepInterrupt: "–î–∞",
  chronotype: "–°—É—Ç—Ä–µ—à–µ–Ω",
  dailyActivityLevel: "–°—Ä–µ–¥–Ω–∞",
  stressLevel: "–í–∏—Å–æ–∫–æ",
  sportActivity: "1-2 –ø—ä—Ç–∏ —Å–µ–¥–º–∏—á–Ω–æ",
  
  // –¢–µ—á–Ω–æ—Å—Ç–∏
  waterIntake: "1-2–ª",
  drinksSweet: "–†—è–¥–∫–æ",
  drinksAlcohol: "–†—è–¥–∫–æ",
  
  // –•—Ä–∞–Ω–µ–Ω–µ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
  weightChange: "–ô–æ-–π–æ –µ—Ñ–µ–∫—Ç",
  weightChangeDetails: "–ü—Ä–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 5 –≥–æ–¥–∏–Ω–∏ —Ç–µ–≥–ª–æ—Ç–æ –º–∏ —Å–µ –∫–æ–ª–µ–±–∞–µ —Å 5-10 –∫–≥",
  dietHistory: "–î–∞",
  dietType: "–ö–µ—Ç–æ –¥–∏–µ—Ç–∞, –ò–Ω—Ç–µ—Ä–≤–∞–ª–Ω–æ –≥–ª–∞–¥—É–≤–∞–Ω–µ",
  dietResult: "–û—Ç–Ω–∞—á–∞–ª–æ —Å–≤–∞–ª–∏—Ö 8 –∫–≥, –Ω–æ –ø–æ—Å–ª–µ –≥–∏ –≤—ä—Ä–Ω–∞—Ö –æ–±—Ä–∞—Ç–Ω–æ",
  overeatingFrequency: "–ü–æ–Ω—è–∫–æ–≥–∞",
  foodCravings: ["–°–ª–∞–¥–∫–æ", "–í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏"],
  foodTriggers: ["–°—Ç—Ä–µ—Å", "–ï–º–æ—Ü–∏–∏ (—Ç—ä–≥–∞, –≥–Ω—è–≤)"],
  eatingHabits: ["–ó–∞–∫—É—Å–∫–∞ –≤—Å–µ–∫–∏ –¥–µ–Ω", "–•—Ä–∞–Ω–∞ –ø—Ä–µ–¥ –µ–∫—Ä–∞–Ω", "–ë—ä—Ä–∑–æ —Ö—Ä–∞–Ω–µ–Ω–µ"],
  compensationMethods: ["–ò–Ω—Ç–µ–Ω–∑–∏–≤–µ–Ω —Å–ø–æ—Ä—Ç", "–ù–µ –∫–æ–º–ø–µ–Ω—Å–∏—Ä–∞–º"],
  socialComparison: "–ü–æ–Ω—è–∫–æ–≥–∞",
  
  // –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è
  dietPreference: ["–í—Å–∏—á–∫–æ"],
  dietDislike: "–ö–∏—Å–µ–ª–æ—Ç–æ –º–ª—è–∫–æ, –∫–∞—Ä—Ñ–∏–æ–ª",
  dietLove: "–®–æ–∫–æ–ª–∞–¥, –ø–∞—Å—Ç–∞, –ø–∏—Ü–∞",
  
  // –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏
  medicalConditions: ["PCOS", "–•–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º"],
  medicalConditions_PCOS: "–î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ü–∏—Ä–∞–Ω –ø—Ä–µ–¥–∏ 3 –≥–æ–¥–∏–Ω–∏",
  medications: "–î–∞",
  medicationsDetails: "–õ-—Ç–∏—Ä–æ–∫—Å–∏–Ω 50 –º–∫–≥ —Å—É—Ç—Ä–∏–Ω",
  
  // –î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–æ
  additionalNotes: "–†–∞–±–æ—Ç—è –æ—Ç –æ—Ñ–∏—Å, —Å–µ–¥—è –ø–æ 8-9 —á–∞—Å–∞ –Ω–∞ –¥–µ–Ω"
}
```

#### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –ü—Ä–µ–¥–∏ –ò–∑–ø—Ä–∞—â–∞–Ω–µ

**–§—É–Ω–∫—Ü–∏—è:** `validateInput()` (–Ω–∞ –≤—Å—è–∫–∞ —Å—Ç—ä–ø–∫–∞)

**–ü—Ä–∞–≤–∏–ª–∞:**
- **–¢–µ–∫—Å—Ç–æ–≤–∏ –ø–æ–ª–µ—Ç–∞:** –ù–µ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–∞ –ø—Ä–∞–∑–Ω–∏ —Å–ª–µ–¥ trim()
- **–ß–∏—Å–ª–æ–≤–∏ –ø–æ–ª–µ—Ç–∞:** –¢—Ä—è–±–≤–∞ –¥–∞ —Å–∞ > 0
- **–ú–∞—Å–∏–≤–∏ (checkboxes):** –¢—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞—Ç –ø–æ–Ω–µ 1 –∏–∑–±—Ä–∞–Ω–∞ –æ–ø—Ü–∏—è
- **–û–ø—Ü–∏–æ–Ω–∞–ª–Ω–∏ –ø–æ–ª–µ—Ç–∞:** –í–∏–Ω–∞–≥–∏ –≤–∞–ª–∏–¥–Ω–∏ (additionalNotes, dietDislike, dietLove)
- **–£—Å–ª–æ–≤–Ω–∏ –ø–æ–ª–µ—Ç–∞:** –í–∞–ª–∏–¥–∏—Ä–∞—Ç —Å–µ —Å–∞–º–æ –∞–∫–æ —Ä–æ–¥–∏—Ç–µ–ª—Å–∫–∏—è—Ç –≤—ä–ø—Ä–æ—Å –µ –∞–∫—Ç–∏–≤–µ–Ω

**–ö–∞–∫–≤–æ —Å–µ —Å–ª—É—á–≤–∞ –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–∏ –¥–∞–Ω–Ω–∏:**
- –ë—É—Ç–æ–Ω—ä—Ç "–ù–∞–ø—Ä–µ–¥" –æ—Å—Ç–∞–≤–∞ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω (disabled)
- –ü–æ–ª–µ—Ç–∞—Ç–∞ —Å–µ –º–∞—Ä–∫–∏—Ä–∞—Ç –≤–∏–∑—É–∞–ª–Ω–æ (—á–µ—Ä–≤–µ–Ω–∞ —Ä–∞–º–∫–∞)
- –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –Ω–µ –º–æ–∂–µ –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏

#### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ó–∞–ø–∏—Å–≤–∞–Ω–µ

**–§—É–Ω–∫—Ü–∏–∏:** `saveAnswer()`, `saveOther()`

**–ö–æ–≥–∞ —Å–µ —Å–ª—É—á–≤–∞:**
- –ü—Ä–∏ –≤—Å—è–∫–∞ –ø—Ä–æ–º—è–Ω–∞ –Ω–∞ input –ø–æ–ª–µ
- –ü—Ä–∏ –∏–∑–±–∏—Ä–∞–Ω–µ –Ω–∞ radio/checkbox
- –ü—Ä–∏ –ø–∏—Å–∞–Ω–µ –≤ textarea
- –ü—Ä–∏ –Ω–∞–ø—Ä–µ–¥/–Ω–∞–∑–∞–¥ –º–µ–∂–¥—É —Å—Ç—ä–ø–∫–∏

**–ö—ä–¥–µ —Å–µ –∑–∞–ø–∏—Å–≤–∞:**
```javascript
localStorage.setItem('questionnaireAnswers', JSON.stringify(answers));
```

**–ó–∞—â–æ:** 
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞–Ω–µ –Ω–∞ –∑–∞–≥—É–±–∞ –Ω–∞ –¥–∞–Ω–Ω–∏ –ø—Ä–∏ —Å–ª—É—á–∞–π–Ω–æ –∑–∞—Ç–≤–∞—Ä—è–Ω–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞
- –í—ä–∑–º–æ–∂–Ω–æ—Å—Ç –∑–∞ –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞–Ω–µ –æ—Ç –∫—ä–¥–µ —Å—Ç–µ —Å–ø—Ä–µ–ª–∏
- Backup –ø—Ä–∏ network –ø—Ä–æ–±–ª–µ–º–∏

#### 4. –í—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ –î–∞–Ω–Ω–∏

–ü—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞:

```javascript
const savedAnswers = localStorage.getItem('questionnaireAnswers');
if (savedAnswers) {
    answers = JSON.parse(savedAnswers);
    // –í—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞—Ç —Å–µ –≤—Å–∏—á–∫–∏ –æ—Ç–≥–æ–≤–æ—Ä–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
}
```

### –ò–∑–ø—Ä–∞—â–∞–Ω–µ –∫—ä–º Backend

#### API Endpoint

**URL:** `https://aidiet.radilov-k.workers.dev/api/generate-plan`
**Method:** POST
**Headers:** `Content-Type: application/json`
**Timeout:** 360 —Å–µ–∫—É–Ω–¥–∏ (6 –º–∏–Ω—É—Ç–∏)

#### Request Payload

```javascript
// –ò–∑–ø—Ä–∞—â–∞ —Å–µ –¶–ï–õ–ò–Ø–¢ answers –æ–±–µ–∫—Ç
fetch('https://aidiet.radilov-k.workers.dev/api/generate-plan', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(answers),  // –í—Å–∏—á–∫–∏ 40+ –ø–æ–ª–µ—Ç–∞
    signal: AbortSignal.timeout(360000)  // 6 –º–∏–Ω—É—Ç–∏ timeout
})
```

#### Response Format

**–£—Å–ø–µ—à–µ–Ω –æ—Ç–≥–æ–≤–æ—Ä:**
```json
{
  "success": true,
  "userId": "user_1707142800000_abc123",
  "plan": {
    "day1": { "meals": [...] },
    "day2": { "meals": [...] },
    // ... –¥–æ day7
    "analysis": {...},
    "strategy": {...},
    "recommendations": [...],
    "forbidden": [...],
    "psychology": [...],
    "_meta": {...}
  }
}
```

**–ì—Ä–µ—à–∫–∞:**
```json
{
  "success": false,
  "error": "–û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –≥—Ä–µ—à–∫–∞—Ç–∞"
}
```

**–ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ (contradiction warning):**
```json
{
  "success": true,
  "hasContradiction": true,
  "warningData": {
    "title": "–û—Ç–∫—Ä–∏—Ç–æ –í–∞–∂–Ω–æ –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ",
    "message": "–û—Ç–∫—Ä–∏–≤–∞–º–µ –ø—Ä–∏–∑–Ω–∞—Ü–∏ –Ω–∞ —Ä–∞–∑—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–µ—Ç–æ...",
    "severity": "critical",
    "recommendations": [...]
  },
  "userId": "...",
  "plan": {...}
}
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –û—Ç–≥–æ–≤–æ—Ä–∞

```javascript
if (!response.success) {
    // –ü–æ–∫–∞–∑–≤–∞ —Å–µ —Å—ä–æ–±—â–µ–Ω–∏–µ –∑–∞ –≥—Ä–µ—à–∫–∞
    showError(response.error);
} else if (response.hasContradiction) {
    // –ó–∞–ø–∏—Å–≤–∞ —Å–µ warning –≤ localStorage
    localStorage.setItem('warningData', JSON.stringify(response.warningData));
    // –ü—Ä–µ–Ω–∞—Å–æ—á–≤–∞–Ω–µ –∫—ä–º warning.html
    window.location.href = 'warning.html';
} else {
    // –£—Å–ø–µ—à–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ
    localStorage.setItem('dietPlan', JSON.stringify(response.plan));
    localStorage.setItem('userData', JSON.stringify(answers));
    localStorage.setItem('userId', response.userId);
    // –ü—Ä–µ–Ω–∞—Å–æ—á–≤–∞–Ω–µ –∫—ä–º analysis.html
    window.location.href = 'analysis.html';
}
```

---
## ü§ñ –°–¢–™–ü–ö–ê 3: –ì–ï–ù–ï–†–ò–†–ê–ù–ï –ù–ê –ü–õ–ê–ù (AI MULTI-STEP)

### –§–∞–π–ª: `worker.js` (Cloudflare Worker Backend)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: 6-–°—Ç—ä–ø–∫–æ–≤–∞ AI –°–∏—Å—Ç–µ–º–∞

–°–∏—Å—Ç–µ–º–∞—Ç–∞ –ù–ï –∏–∑–ø–æ–ª–∑–≤–∞ –µ–¥–Ω–∞ –≥–æ–ª—è–º–∞ AI –∑–∞—è–≤–∫–∞, –∞ —Ä–∞–∑–ø—Ä–µ–¥–µ–ª—è —Ä–∞–±–æ—Ç–∞—Ç–∞ –Ω–∞ **6 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ AI –∑–∞—è–≤–∫–∏** –∑–∞ –º–∞–∫—Å–∏–º–∞–ª–Ω–∞ –ø—Ä–µ—Ü–∏–∑–Ω–æ—Å—Ç –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª–∏–∑–∞—Ü–∏—è.

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  REQUEST 1: –ê–ù–ê–õ–ò–ó (4K token limit)                        ‚îÇ
‚îÇ  Input: –ü—ä–ª–Ω–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –¥–∞–Ω–Ω–∏ (40+ –ø–æ–ª–µ—Ç–∞)             ‚îÇ
‚îÇ  Output: –ó–¥—Ä–∞–≤–µ–Ω –∞–Ω–∞–ª–∏–∑, BMR, TDEE, –∫–∞–ª–æ—Ä–∏–∏, –ø—Ä–æ–±–ª–µ–º–∏      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  REQUEST 2: –°–¢–†–ê–¢–ï–ì–ò–Ø (4K token limit)                     ‚îÇ
‚îÇ  Input: –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –¥–∞–Ω–Ω–∏ + –ö–û–ú–ü–ê–ö–¢–ï–ù –∞–Ω–∞–ª–∏–∑             ‚îÇ
‚îÇ  Output: Dietary —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, timing, –¥–æ–±–∞–≤–∫–∏, –ø—Ä–∏–Ω—Ü–∏–ø–∏      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  REQUEST 3: –•–†–ê–ù–ï–ù–ò–Ø –î–ï–ù 1-2 (8K token limit)              ‚îÇ
‚îÇ  Input: –î–∞–Ω–Ω–∏ + –∫–æ–º–ø–∞–∫—Ç–µ–Ω –∞–Ω–∞–ª–∏–∑ + –∫–æ–º–ø–∞–∫—Ç–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è     ‚îÇ
‚îÇ  Output: 2 –¥–Ω–∏ –ø–æ–¥—Ä–æ–±–Ω–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å –º–∞–∫—Ä–æ—Å–∏                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  REQUEST 4: –•–†–ê–ù–ï–ù–ò–Ø –î–ï–ù 3-4 (8K token limit)              ‚îÇ
‚îÇ  Input: –î–∞–Ω–Ω–∏ + –∫–æ–º–ø–∞–∫—Ç–∏ + –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç –¥–Ω–∏ 1-2             ‚îÇ
‚îÇ  Output: 2 –¥–Ω–∏ –Ω–æ–≤–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è (—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ!)               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  REQUEST 5: –•–†–ê–ù–ï–ù–ò–Ø –î–ï–ù 5-6 (8K token limit)              ‚îÇ
‚îÇ  Input: –î–∞–Ω–Ω–∏ + –∫–æ–º–ø–∞–∫—Ç–∏ + –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç –¥–Ω–∏ 1-4             ‚îÇ
‚îÇ  Output: 2 –¥–Ω–∏ –Ω–æ–≤–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  REQUEST 6: –•–†–ê–ù–ï–ù–ò–Ø –î–ï–ù 7 + –û–ë–û–ë–©–ï–ù–ò–ï (2K token limit)    ‚îÇ
‚îÇ  Input: –ö–æ–º–ø–∞–∫—Ç–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è + –ø—ä–ª–Ω–∞ —Å–µ–¥–º–∏—Ü–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è       ‚îÇ
‚îÇ  Output: –î–µ–Ω 7 + –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ + –∑–∞–±—Ä–∞–Ω–µ–Ω–∏ + –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚ñº
         –ü–™–õ–ï–ù –ü–õ–ê–ù
```

### TOKEN –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø (–§–µ–≤—Ä—É–∞—Ä–∏ 2026)

**–ü—Ä–æ–±–ª–µ–º:** –ò–∑–ø—Ä–∞—â–∞–Ω–µ—Ç–æ –Ω–∞ –ø—ä–ª–Ω–∏ –æ–±–µ–∫—Ç–∏ analysis –∏ strategy –ø—Ä–∏ –≤—Å—è–∫–∞ –∑–∞—è–≤–∫–∞ –∫–æ–Ω—Å—É–º–∏—Ä–∞ —Ç–≤—ä—Ä–¥–µ –º–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∏.

**–†–µ—à–µ–Ω–∏–µ:** –ö–æ–º–ø–∞–∫—Ç–µ–Ω —Ñ–æ—Ä–º–∞—Ç - –Ω–∞–º–∞–ª–µ–Ω–∏–µ —Å 59.1% (4799 ‚Üí 1962 tokens –Ω–∞ –ø–ª–∞–Ω)

**–ö–æ–º–ø–∞–∫—Ç–∏—Ä–∞–Ω–µ:**
- **Strategy –æ–±–µ–∫—Ç:** 695 tokens ‚Üí 167 tokens (-76%)
- **Analysis –æ–±–µ–∫—Ç:** 524 tokens ‚Üí 327 tokens (-37.6%)
- **Multipliern –µ—Ñ–µ–∫—Ç:** Strategy —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ 5 –ø—ä—Ç–∏ ‚Üí 5 √ó 528 = 2640 tokens —Å–ø–µ—Å—Ç–µ–Ω–∏!

**–ü—Ä–∏–º–µ—Ä –∑–∞ –∫–æ–º–ø–∞–∫—Ç–∏—Ä–∞–Ω–µ:**

```javascript
// –û–†–ò–ì–ò–ù–ê–õ–ï–ù Analysis (524 tokens)
{
  "bmr": 1420,
  "tdee": 2130,
  "recommendedCalories": 1730,
  "macroRatios": {
    "protein": 30,
    "carbs": 40,
    "fats": 30
  },
  "macroGrams": {
    "protein": 130,
    "carbs": 170,
    "fats": 58
  },
  "weeklyBlueprint": {
    "dailyMealCount": 3,
    "skipBreakfast": false,
    "dailyStructure": [/* –º–∞—Å–∏–≤ –æ—Ç 7 –æ–±–µ–∫—Ç–∞ */]
  },
  "keyProblems": [
    { "title": "–ù–µ–¥–æ—Å—Ç–∞—Ç—ä—á–µ–Ω —Å—ä–Ω", "severity": "Risky", "impact": "–ó–∞–±–∞–≤—è –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞..." },
    { "title": "–ï–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–µ", "severity": "Borderline", "impact": "–í–æ–¥–∏ –¥–æ –ø—Ä–µ—è–∂–¥–∞–Ω–µ..." }
  ]
}

// –ö–û–ú–ü–ê–ö–¢–ï–ù Analysis (327 tokens = -37.6%)
{
  "bmr": 1420,
  "recommendedCalories": 1730,
  "macroRatios": "Protein: 30%, Carbs: 40%, Fats: 30%",  // –ï–¥–∏–Ω string –≤–º–µ—Å—Ç–æ –æ–±–µ–∫—Ç
  "keyProblems": "–ù–µ–¥–æ—Å—Ç–∞—Ç—ä—á–µ–Ω —Å—ä–Ω (Risky); –ï–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–µ (Borderline)"  // Join –≤–º–µ—Å—Ç–æ –º–∞—Å–∏–≤
}
```

---

### –°–¢–™–ü–ö–ê 3.1: –ê–ù–ê–õ–ò–ó (Request 1)

**–§—É–Ω–∫—Ü–∏—è:** `generateAnalysisStep()`
**Token Limit:** 4000 tokens
**AI Prompt:** `admin_analysis_prompt` –æ—Ç KV Storage

#### Input –î–∞–Ω–Ω–∏

**–ü—ä–ª–µ–Ω –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –ø—Ä–æ—Ñ–∏–ª:**
- –î–µ–º–æ–≥—Ä–∞—Ñ–∏—è: –∏–º–µ, –ø–æ–ª, –≤—ä–∑—Ä–∞—Å—Ç, —Ä—ä—Å—Ç, —Ç–µ–≥–ª–æ
- –¶–µ–ª: –æ—Ç—Å–ª–∞–±–≤–∞–Ω–µ/–∫–∞—á–≤–∞–Ω–µ/–ø–æ–¥–¥—ä—Ä–∂–∞–Ω–µ + –¥–µ—Ç–∞–π–ª–∏ (–∫–æ–ª–∫–æ –∫–≥)
- –°—ä–Ω: —á–∞—Å–æ–≤–µ, –ø—Ä–µ–∫—ä—Å–≤–∞–Ω–∏—è, —Ö—Ä–æ–Ω–æ—Ç–∏–ø
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç: –¥–Ω–µ–≤–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç, —Å–ø–æ—Ä—Ç, —Å—Ç—Ä–µ—Å
- –¢–µ—á–Ω–æ—Å—Ç–∏: –≤–æ–¥–∞, —Å–ª–∞–¥–∫–∏ –Ω–∞–ø–∏—Ç–∫–∏, –∞–ª–∫–æ—Ö–æ–ª
- –•—Ä–∞–Ω–µ–Ω–µ: –∏—Å—Ç–æ—Ä–∏—è –Ω–∞ –¥–∏–µ—Ç–∏, –ø—Ä–µ—è–∂–¥–∞–Ω–µ, –∂–µ–ª–∞–Ω–∏—è, —Ç—Ä–∏–≥–µ—Ä–∏, –Ω–∞–≤–∏—Ü–∏, –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è
- –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è: —Ç–∏–ø –¥–∏–µ—Ç–∞, –Ω–µ—Ö–∞—Ä–µ—Å–≤–∞–Ω–∏ —Ö—Ä–∞–Ω–∏, –ª—é–±–∏–º–∏ —Ö—Ä–∞–Ω–∏
- –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–æ: —Å—ä—Å—Ç–æ—è–Ω–∏—è (–¥–∏–∞–±–µ—Ç, PCOS, —Ö–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º –∏ —Ç.–Ω.), –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç–∏

#### AI –û–±—Ä–∞–±–æ—Ç–∫–∞

1. **BMR –ò–∑—á–∏—Å–ª–µ–Ω–∏–µ** (Mifflin-St Jeor —Ñ–æ—Ä–º—É–ª–∞):
   - –ú—ä–∂–µ: BMR = 10 √ó —Ç–µ–≥–ª–æ(–∫–≥) + 6.25 √ó —Ä—ä—Å—Ç(—Å–º) - 5 √ó –≤—ä–∑—Ä–∞—Å—Ç(–≥) + 5
   - –ñ–µ–Ω–∏: BMR = 10 √ó —Ç–µ–≥–ª–æ(–∫–≥) + 6.25 √ó —Ä—ä—Å—Ç(—Å–º) - 5 √ó –≤—ä–∑—Ä–∞—Å—Ç(–≥) - 161

2. **TDEE –ò–∑—á–∏—Å–ª–µ–Ω–∏–µ** (Total Daily Energy Expenditure):
   - BMR √ó Activity Factor
   - Sedentary (–æ—Ñ–∏—Å): 1.2
   - Light (1-2 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏): 1.375
   - Moderate (3-4 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏): 1.55
   - Very Active (5+ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏): 1.725
   - Extra Active (–ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–µ–Ω —Å–ø–æ—Ä—Ç): 1.9

3. **–ö–æ—Ä–µ–∫—Ü–∏–∏ –∑–∞:**
   - –ù–µ–¥–æ—Å—Ç–∞—Ç—ä—á–µ–Ω —Å—ä–Ω: -5% –¥–æ -15% TDEE
   - –í–∏—Å–æ–∫ —Å—Ç—Ä–µ—Å: -5% –¥–æ -10% TDEE
   - –•–æ—Ä–º–æ–Ω–∞–ª–Ω–∏ –ø—Ä–æ–±–ª–µ–º–∏ (PCOS, —Ö–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º): -10% –¥–æ -20% TDEE
   - –ú–µ—Ç–∞–±–æ–ª–∏—Ç–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –æ—Ç –ø—Ä–µ–¥–∏—à–Ω–∏ –¥–∏–µ—Ç–∏: -5% –¥–æ -15%

4. **–¶–µ–ª–µ–≤–∏ –∫–∞–ª–æ—Ä–∏–∏:**
   - –û—Ç—Å–ª–∞–±–≤–∞–Ω–µ: TDEE - 300-500 cal (0.5-1 –∫–≥/—Å–µ–¥–º–∏—Ü–∞)
   - –ö–∞—á–≤–∞–Ω–µ –Ω–∞ –º–∞—Å–∞: TDEE + 200-400 cal
   - –ü–æ–¥–¥—ä—Ä–∂–∞–Ω–µ: TDEE ¬± 0 cal

5. **–ú–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–∏:**
   - –ü—Ä–æ—Ç–µ–∏–Ω–∏: 1.6-2.2 g/kg —Ç–µ–ª–µ—Å–Ω–æ —Ç–µ–≥–ª–æ (–∑–∞–≤–∏—Å–∏ –æ—Ç —Ü–µ–ª –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç)
   - –ú–∞–∑–Ω–∏–Ω–∏: 20-35% –æ—Ç –∫–∞–ª–æ—Ä–∏–∏—Ç–µ
   - –í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏: –û—Å—Ç–∞—Ç—ä–∫ —Å–ª–µ–¥ –ø—Ä–æ—Ç–µ–∏–Ω–∏ –∏ –º–∞–∑–Ω–∏–Ω–∏

6. **–°–µ–¥–º–∏—á–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
   - –ë—Ä–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ –¥–µ–Ω (2-5, –∑–∞–≤–∏—Å–∏ –æ—Ç –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è –∏ —Ö—Ä–æ–Ω–æ—Ç–∏–ø)
   - –í—Ä–µ–º–µ–Ω–∞ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–µ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω–∏ –∑–∞ —Ö—Ä–æ–Ω–æ—Ç–∏–ø)
   - –ü–æ–ª–∏—Ç–∏–∫–∞ –∑–∞ –∑–∞–∫—É—Å–∫–∞ (skip/not skip)

7. **–ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–µ –Ω–∞ –ø—Ä–æ–±–ª–µ–º–∏:**
   - –ù–µ–¥–æ—Å—Ç–∞—Ç—ä—á–µ–Ω —Å—ä–Ω ‚Üí Risky (–≤–ª–∏—è–µ –Ω–∞ –≥—Ä–µ–ª–∏–Ω/–ª–µ–ø—Ç–∏–Ω)
   - –ï–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–µ ‚Üí Borderline/Risky
   - –ö–æ–º–ø–µ–Ω—Å–∞—Ç–æ—Ä–Ω–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (–ø–æ–≤—Ä—ä—â–∞–Ω–µ, –ª–∞–∫—Å–∞—Ç–∏–≤–∏) ‚Üí Critical
   - –ô–æ-–π–æ –µ—Ñ–µ–∫—Ç ‚Üí –≤–ª–∏—è–µ –Ω–∞ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞

#### Output –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```json
{
  "bmr": 1420,
  "tdee": 2050,
  "recommendedCalories": 1650,
  "macroRatios": {
    "protein": 30,
    "carbs": 45,
    "fats": 25
  },
  "macroGrams": {
    "protein": 123,
    "carbs": 186,
    "fats": 46
  },
  "weeklyBlueprint": {
    "dailyMealCount": 3,
    "skipBreakfast": false,
    "dailyStructure": [
      { "day": "Monday", "mealCount": 3, "mealTimes": ["08:00", "13:00", "19:00"] },
      // ... 7 –¥–Ω–∏
    ]
  },
  "successChance": 65,
  "keyProblems": [
    {
      "title": "–ù–µ–¥–æ—Å—Ç–∞—Ç—ä—á–µ–Ω —Å—ä–Ω (5.5 —á–∞—Å–∞)",
      "severity": "Risky",
      "impact": "–ù–∞–º–∞–ª—è–≤–∞ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞ —Å 10-15%, —É–≤–µ–ª–∏—á–∞–≤–∞ –≥—Ä–µ–ª–∏–Ω (–≥–ª–∞–¥), –Ω–∞–º–∞–ª—è–≤–∞ –ª–µ–ø—Ç–∏–Ω (—Å–∏—Ç–æ—Å—Ç). –í–æ–¥–∏ –¥–æ 30% –ø–æ-–≥–æ–ª—è–º–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç –∑–∞ –ø—Ä–µ—è–∂–¥–∞–Ω–µ.",
      "solution": "–¶–µ–ª–µ—Ç–µ 7-8 —á–∞—Å–∞ —Å—ä–Ω. –ú–∞–≥–Ω–µ–∑–∏–π 300mg –≤–µ—á–µ—Ä –º–æ–∂–µ –¥–∞ –ø–æ–º–æ–≥–Ω–µ –∑–∞ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—ä–Ω—è."
    },
    {
      "title": "–ï–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–µ –ø—Ä–∏ —Å—Ç—Ä–µ—Å",
      "severity": "Borderline",
      "impact": "–°—Ç—Ä–µ—Å—ä—Ç —É–≤–µ–ª–∏—á–∞–≤–∞ –∫–æ—Ä—Ç–∏–∑–æ–ª ‚Üí –æ—Ç–ª–∞–≥–∞–Ω–µ –Ω–∞ –∫–æ—Ä–µ–º–Ω–∏ –º–∞–∑–Ω–∏–Ω–∏. –ï–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–æ—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–∞ –¥–µ—Ñ–∏—Ü–∏—Ç–∞.",
      "solution": "–ü—Ä–∞–∫—Ç–∏–∫—É–≤–∞–π—Ç–µ 20-–º–∏–Ω—É—Ç–Ω–æ –∑–∞–±–∞–≤—è–Ω–µ –ø—Ä–µ–¥–∏ –≤—Ç–æ—Ä–∏ –ø–æ—Ä—Ü–∏—è. –í–æ–¥–µ—Ç–µ –¥–Ω–µ–≤–Ω–∏–∫ –Ω–∞ –µ–º–æ—Ü–∏–∏—Ç–µ."
    }
  ]
}
```

**–§–∏–ª—Ç—Ä–∏—Ä–∞–Ω–µ:** –ü—Ä–æ–±–ª–µ–º–∏—Ç–µ —Å—ä—Å severity "Normal" —Å–µ –ø—Ä–µ–º–∞—Ö–≤–∞—Ç (–∑–∞–ø–∞–∑–≤–∞—Ç —Å–µ —Å–∞–º–æ Borderline/Risky/Critical).

---

### –°–¢–™–ü–ö–ê 3.2: –°–¢–†–ê–¢–ï–ì–ò–Ø (Request 2)

**–§—É–Ω–∫—Ü–∏—è:** `generateStrategyStep()`
**Token Limit:** 4000 tokens
**AI Prompt:** `admin_strategy_prompt` –æ—Ç KV Storage

#### Input –î–∞–Ω–Ω–∏

- **–ü—ä–ª–Ω–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –¥–∞–Ω–Ω–∏** (—Å—ä—â–∏—Ç–µ –∫–∞—Ç–æ –°—Ç—ä–ø–∫–∞ 1)
- **–ö–û–ú–ü–ê–ö–¢–ï–ù –∞–Ω–∞–ª–∏–∑** –æ—Ç –°—Ç—ä–ø–∫–∞ 1 (–Ω–∞–º–∞–ª–µ–Ω–∏ tokens)

#### AI –û–±—Ä–∞–±–æ—Ç–∫–∞

1. **–ò–∑–±–æ—Ä –Ω–∞ Dietary Modifier:**
   - –ê–Ω–∞–ª–∏–∑–∏—Ä–∞ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏ —Å—ä—Å—Ç–æ—è–Ω–∏—è, —Ü–µ–ª
   - –ò–∑–±–∏—Ä–∞ –æ—Ç: Balanced, Keto, Paleo, Vegetarian, Vegan, Mediterranean, Low-carb, Gentle stomach, Gluten-free
   - –ù–∞–ø—Ä–∏–º–µ—Ä: PCOS ‚Üí Mediterranean/Low-GI –∑–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –∏–Ω—Å—É–ª–∏–Ω

2. **–°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ Welcome Message:**
   - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–æ —Å—ä–æ–±—â–µ–Ω–∏–µ (150-250 –¥—É–º–∏)
   - –û–±—Ä—ä—â–µ–Ω–∏–µ –ø–æ –∏–º–µ
   - –û–±—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª–Ω–∏—è –ø–æ–¥—Ö–æ–¥

3. **Plan Justification:**
   - –ó–∞—â–æ —Ç–æ—á–Ω–æ —Ç–µ–∑–∏ –∫–∞–ª–æ—Ä–∏–∏, –º–∞–∫—Ä–æ—Å–∏, —Ö—Ä–∞–Ω–µ–Ω–∏—è
   - –ö–∞–∫ —Å–µ –∞–¥–∞–ø—Ç–∏—Ä–∞ –∫—ä–º –ª–∏—á–Ω–∏—Ç–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—Å—Ç–≤–∞
   - –ú–∏–Ω–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–∞

4. **–ö–ª—é—á–æ–≤–∏ –ü—Ä–∏–Ω—Ü–∏–ø–∏:**
   - 3-5 –ø—Ä–∏–Ω—Ü–∏–ø–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ –∑–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
   - –ü—Ä–∏–º–µ—Ä: "–ü–æ–ª–æ–≤–∏–Ω —á–∏–Ω–∏—è –∑–µ–ª–µ–Ω—á—É—Ü–∏ –∑–∞ –æ–±–µ–º –∏ —Å–∏—Ç–æ—Å—Ç (—Ç–≤–æ—è—Ç–∞ —Ü–µ–ª: –æ—Ç—Å–ª–∞–±–≤–∞–Ω–µ –ø—Ä–∏ –Ω–∏—Å—ä–∫ —Å—Ç—Ä–µ—Å)"

5. **Meal Timing:**
   - –û–ø—Ç–∏–º–∞–ª–Ω–æ –≤—Ä–µ–º–µ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ —Å–ø—Ä—è–º–æ —Ö—Ä–æ–Ω–æ—Ç–∏–ø
   - –ü—Ä–æ–∑–æ—Ä—Ü–∏ –Ω–∞ –≥–ª–∞–¥—É–≤–∞–Ω–µ (–∞–∫–æ –µ –ø–æ–¥—Ö–æ–¥—è—â–æ)
   - –ü—Ä–∏–º–µ—Ä: "–ü–Ω-–ü—Ç: –æ–±—è–¥ 12:30, –≤–µ—á–µ—Ä—è 19:30 | –°—ä–±-–ù–µ–¥: –∑–∞–∫—É—Å–∫–∞ 08:00 + –æ–±—è–¥ + –≤–µ—á–µ—Ä—è"

6. **Supplement –ü—Ä–µ–ø–æ—Ä—ä–∫–∏:**
   - **–ö–†–ò–¢–ò–ß–ù–û:** –í—Å—è–∫–∞ –¥–æ–±–∞–≤–∫–∞ –∏–º–∞ 3-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–æ –æ–±–æ—Å–Ω–æ–≤—è–≤–∞–Ω–µ
   - –§–æ—Ä–º–∞—Ç: `! [–ò–º–µ] [–¥–æ–∑–∞] [–≤—Ä–µ–º–µ] (–¢–í–û–Ø–¢–ê –ù–£–ñ–î–ê: [–ø—Ä–∏—á–∏–Ω–∞ 1], [–ø—Ä–∏—á–∏–Ω–∞ 2], [–ø—Ä–∏—á–∏–Ω–∞ 3])`
   - –ü—Ä–∏–º–µ—Ä: `! –ú–∞–≥–Ω–µ–∑–∏–π 300mg –≤–µ—á–µ—Ä (–¢–í–û–Ø–¢–ê –ù–£–ñ–î–ê: –°—ä–Ω 5.5h –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∏—Å–∫–æ, —Å—Ç—Ä–µ—Å –≤–∏—Å–æ–∫, —Ü–µ–ª –æ—Ç—Å–ª–∞–±–≤–∞–Ω–µ –∏–∑–∏—Å–∫–≤–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω —Å—ä–Ω)`

#### Output –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```json
{
  "dietaryModifier": "Mediterranean",
  "modifierReasoning": "–ë–∞–∑–∏—Ä–∞–Ω–æ –Ω–∞ PCOS –¥–∏–∞–≥–Ω–æ–∑–∞—Ç–∞ —Ç–∏ –∏ —Ü–µ–ª—Ç–∞ –∑–∞ –æ—Ç—Å–ª–∞–±–≤–∞–Ω–µ, —Å—Ä–µ–¥–∏–∑–µ–º–Ω–æ–º–æ—Ä—Å–∫–∞—Ç–∞ –¥–∏–µ—Ç–∞ –µ –æ–ø—Ç–∏–º–∞–ª–Ω–∞ –∑–∞—Ä–∞–¥–∏ –Ω–∏—Å—ä–∫ –≥–ª–∏–∫–µ–º–∏—á–µ–Ω –∏–Ω–¥–µ–∫—Å, –≤–∏—Å–æ–∫–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ –Ω–∞ –æ–º–µ–≥–∞-3 (–ø—Ä–æ—Ç–∏–≤–æ–≤—ä–∑–ø–∞–ª–∏—Ç–µ–ª–Ω–æ) –∏ —Ñ–∏–±—Ä–∏ –∑–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –∫—Ä—ä–≤–Ω–∞—Ç–∞ –∑–∞—Ö–∞—Ä.",
  
  "welcomeMessage": "–ó–¥—Ä–∞–≤–µ–π –ú–∞—Ä–∏—è! –ù–∞ 35 –≥–æ–¥–∏–Ω–∏, —Å—ä—Å 165 —Å–º –∏ 78 –∫–≥, —Ü–µ–ª—Ç–∞ —Ç–∏ –µ –¥–∞ —Å–≤–∞–ª–∏—à 10 –∫–≥. –¢–≤–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª –ø–æ–∫–∞–∑–≤–∞ PCOS –∏ —Ö–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º, –∫–æ–µ—Ç–æ –∑–∞–±–∞–≤—è –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞ —Å –æ–∫–æ–ª–æ 15-20%. –°—ä–∑–¥–∞–¥–æ—Ö —Å–ø–µ—Ü–∏–∞–ª–µ–Ω –ø–ª–∞–Ω —Å 1650 –∫–∞–ª–æ—Ä–∏–∏ –¥–Ω–µ–≤–Ω–æ (–≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ç–µ 1800), –∫–æ–π—Ç–æ –æ—Ç—á–∏—Ç–∞ —Ç–≤–æ–∏—Ç–µ —Ö–æ—Ä–º–æ–Ω–∞–ª–Ω–∏ –ø—Ä–µ–¥–∏–∑–≤–∏–∫–∞—Ç–µ–ª—Å—Ç–≤–∞...",
  
  "planJustification": "–¢–æ—á–Ω–æ 1650 –∫–∞–ª–æ—Ä–∏–∏ (–Ω–µ 1200!) –∑–∞—â–æ—Ç–æ —Ç–≤–æ—è—Ç –±–∞–∑–æ–≤ –º–µ—Ç–∞–±–æ–ª–∏–∑—ä–º –µ 1420 cal –∏ —Ç–≤–æ—è—Ç TDEE –µ ~2000. –î–µ—Ñ–∏—Ü–∏—Ç –æ—Ç 350 cal —â–µ –¥–æ–≤–µ–¥–µ –¥–æ —É—Å—Ç–æ–π—á–∏–≤–æ 0.5 –∫–≥/—Å–µ–¥–º–∏—Ü–∞ –±–µ–∑ –∑–∞–±–∞–≤—è–Ω–µ –Ω–∞ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞. 3 —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–µ–∑ –∑–∞–∫—É—Å–∫–∏ –∑–∞—â–æ—Ç–æ —Ç–∏ —Å–∏ —Å—É—Ç—Ä–µ—à–µ–Ω —á–æ–≤–µ–∫ –Ω–æ –Ω–µ —Å–µ —Å—ä–±—É–∂–¥–∞—à –≥–ª–∞–¥–Ω–∞.",
  
  "keyPrinciples": [
    "–ü–æ–ª–æ–≤–∏–Ω —á–∏–Ω–∏—è –∑–µ–ª–µ–Ω—á—É—Ü–∏ –ø—Ä–∏ –æ–±—è–¥ –∏ –≤–µ—á–µ—Ä—è –∑–∞ –æ–±–µ–º –±–µ–∑ –∫–∞–ª–æ—Ä–∏–∏ (—Ç–≤–æ—è—Ç–∞ —Ü–µ–ª: –æ—Ç—Å–ª–∞–±–≤–∞–Ω–µ –ø—Ä–∏ —É–º–µ—Ä–µ–Ω–∞ –≥–ª–∞–¥)",
    "–•—Ä–∞–Ω–∏ –±–æ–≥–∞—Ç–∏ –Ω–∞ –æ–º–µ–≥–∞-3 (–º–∞–∑–Ω–∞ —Ä–∏–±–∞ 3x/—Å–µ–¥–º–∏—Ü–∞) –∑–∞ –ø—Ä–æ—Ç–∏–≤–æ–≤—ä–∑–ø–∞–ª–∏—Ç–µ–ª–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ (—Ç–≤–æ—è—Ç–∞ –Ω—É–∂–¥–∞: PCOS = —Ö—Ä–æ–Ω–∏—á–Ω–æ –≤—ä–∑–ø–∞–ª–µ–Ω–∏–µ)",
    "–ú–∞–≥–Ω–µ–∑–∏–π –ø—Ä–µ–¥–∏ –ª—è–≥–∞–Ω–µ –∑–∞ –ø–æ–¥–æ–±—Ä–µ–Ω —Å—ä–Ω –æ—Ç 5.5h –Ω–∞ 7h (–Ω–µ–¥–æ—Å—Ç–∞—Ç—ä—á–Ω–∏—è—Ç —Å—ä–Ω –Ω–∞–º–∞–ª—è–≤–∞ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞ —Å 10%)",
    "–§–∏–±—Ä–∏ 30g+ –¥–Ω–µ–≤–Ω–æ –∑–∞ —Å—Ç–∞–±–∏–ª–Ω–∞ –∫—Ä—ä–≤–Ω–∞ –∑–∞—Ö–∞—Ä (—Ç–≤–æ—è—Ç–∞ –Ω—É–∂–¥–∞: PCOS –∏–∑–∏—Å–∫–≤–∞ —Å—Ç–∞–±–∏–ª–µ–Ω –∏–Ω—Å—É–ª–∏–Ω)"
  ],
  
  "mealTiming": {
    "pattern": "–ü–æ–Ω–µ–¥–µ–ª–Ω–∏–∫-–ü–µ—Ç—ä–∫: –æ–±—è–¥ 12:30, –≤–µ—á–µ—Ä—è 19:30 | –°—ä–±–æ—Ç–∞-–ù–µ–¥–µ–ª—è: –∑–∞–∫—É—Å–∫–∞ 08:00, –æ–±—è–¥ 13:00, –≤–µ—á–µ—Ä—è 20:00",
    "fastingWindows": "16-—á–∞—Å–æ–≤ –Ω–æ—â–µ–Ω –ø–æ—Å—Ç (19:30 –¥–æ 12:30 —Å–ª–µ–¥–≤–∞—â –¥–µ–Ω) –ø—Ä–µ–∑ —Å–µ–¥–º–∏—Ü–∞—Ç–∞"
  },
  
  "supplementRecommendations": [
    "! –ú–∞–≥–Ω–µ–∑–∏–π 300mg –≤–µ—á–µ—Ä (–¢–í–û–Ø–¢–ê –ù–£–ñ–î–ê: –°—ä–Ω 5.5h –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∏—Å–∫–æ, —Å—Ç—Ä–µ—Å –≤–∏—Å–æ–∫, PCOS –∏–∑–∏—Å–∫–≤–∞ –º–∞–≥–Ω–µ–∑–∏–π –∑–∞ –∏–Ω—Å—É–ª–∏–Ω–æ–≤–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–Ω–æ—Å—Ç)",
    "! –û–º–µ–≥–∞-3 1000mg —Å—É—Ç—Ä–∏–Ω —Å —Ö—Ä–∞–Ω–∞ (–¢–í–û–Ø–¢–ê –ù–£–ñ–î–ê: PCOS‚Üí–≤—ä–∑–ø–∞–ª–µ–Ω–∏–µ, —Å—Ç—Ä–µ—Å‚Üí–∫–æ—Ä—Ç–∏–∑–æ–ª, —Ü–µ–ª –æ—Ç—Å–ª–∞–±–≤–∞–Ω–µ –∏–∑–∏—Å–∫–≤–∞ –ø—Ä–æ—Ç–∏–≤–æ–≤—ä–∑–ø–∞–ª–∏—Ç–µ–ª–Ω–æ)",
    "! –ò–Ω–æ–∑–∏—Ç–æ–ª 2000mg —Å—É—Ç—Ä–∏–Ω (–¢–í–û–Ø–¢–ê –ù–£–ñ–î–ê: PCOS —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞ –¥–æ–±–∞–≤–∫–∞ –∑–∞ –æ–≤—É–ª–∞—Ü–∏—è –∏ –∏–Ω—Å—É–ª–∏–Ω–æ–≤–∞ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç)",
    "! –í–∏—Ç–∞–º–∏–Ω D3 2000IU —Å—É—Ç—Ä–∏–Ω (–¢–í–û–Ø–¢–ê –ù–£–ñ–î–ê: 35-–≥–æ–¥–∏—à–Ω–∞ –∂–µ–Ω–∞, –æ—Ñ–∏—Å —Ä–∞–±–æ—Ç–∞‚Üí–ª–∏–ø—Å–∞ –Ω–∞ —Å–ª—ä–Ω—Ü–µ, —Ö–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º)"
  ]
}
```

---
### –°–¢–™–ü–ö–ê 3.3: –•–†–ê–ù–ï–ù–ò–Ø (Requests 3-6)

**–§—É–Ω–∫—Ü–∏—è:** `generateMealPlanChunk()`
**Token Limit:** 8000 tokens per chunk
**AI Prompt:** `admin_meal_plan_prompt` –æ—Ç KV Storage

#### –ü—Ä–æ–≥—Ä–µ—Å–∏–≤–Ω–æ –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ

–í–º–µ—Å—Ç–æ –¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞ —Ü—è–ª–∞—Ç–∞ —Å–µ–¥–º–∏—Ü–∞ –Ω–∞–≤–µ–¥–Ω—ä–∂ (–∫–æ–µ—Ç–æ –±–∏ –Ω–∞–¥—Ö–≤—ä—Ä–ª–∏–ª–æ token limits), —Å–∏—Å—Ç–µ–º–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞ –ø–æ **2 –¥–Ω–∏ –Ω–∞ chunk**:

- **Chunk 1 (Request 3):** –î–µ–Ω—å 1-2
- **Chunk 2 (Request 4):** –î–µ–Ω—å 3-4 (—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç –¥–Ω–∏ 1-2)
- **Chunk 3 (Request 5):** –î–µ–Ω—å 5-6 (—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç –¥–Ω–∏ 1-4)
- **Chunk 4 (Request 6):** –î–µ–Ω—å 7 (—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç –¥–Ω–∏ 1-6)

#### Input –î–∞–Ω–Ω–∏ (Per Chunk)

- **–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –¥–∞–Ω–Ω–∏** (–ø—ä–ª–Ω–∏)
- **–ö–û–ú–ü–ê–ö–¢–ï–ù analysis** (167 tokens –≤–º–µ—Å—Ç–æ 524)
- **–ö–û–ú–ü–ê–ö–¢–ù–ê strategy** (327 tokens –≤–º–µ—Å—Ç–æ 695)
- **Previous days context** - —Å–∞–º–æ –∏–º–µ–Ω–∞—Ç–∞ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç –ø—Ä–µ–¥–∏—à–Ω–∏—Ç–µ –¥–Ω–∏ (–∑–∞ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ)
- **Day range** - –∫–æ–∏ –¥–Ω–∏ –¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞ (–Ω–∞–ø—Ä. "1-2", "3-4")

–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞ Chunk 2:
```
Previous meals (Day 1-2):
- Day 1: –ì—Ä—ä—Ü–∫–∞ —Å–∞–ª–∞—Ç–∞ —Å –ø–∏–ª–µ—à–∫–æ —Ñ–∏–ª–µ | –ü–µ—á–µ–Ω–∞ –±—è–ª–∞ —Ä–∏–±–∞ —Å –∫–∏–Ω–æ–∞
- Day 2: –°–ø–∞–Ω–∞—á–µ–Ω–∞ —Å–∞–ª–∞—Ç–∞ —Å —è–π—Ü–∞ | –ü–∏–ª–µ—à–∫–æ –∫—ä—Ä–∏ —Å –∫–∞—Ñ—è–≤ –æ—Ä–∏–∑
```

#### AI –û–±—Ä–∞–±–æ—Ç–∫–∞

1. **–†–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –∫–∞–ª–æ—Ä–∏–∏:**
   - –ó–∞–∫—É—Å–∫–∞: 25-30% –æ—Ç –¥–Ω–µ–≤–Ω–∏—Ç–µ –∫–∞–ª–æ—Ä–∏–∏
   - –û–±—è–¥: 35-40%
   - –°–ª–µ–¥–æ–±–µ–¥–Ω–∞ –∑–∞–∫—É—Å–∫–∞: 10-15% (–∞–∫–æ –∏–º–∞)
   - –í–µ—á–µ—Ä—è: 25-30%
   - –ö—ä—Å–Ω–∞ –∑–∞–∫—É—Å–∫–∞: 5-10% (–∞–∫–æ –∏–º–∞)

2. **–†–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –º–∞–∫—Ä–æ—Å–∏:**
   - –ó–∞–∫—É—Å–∫–∞: –ø–æ-–≤–∏—Å–æ–∫–∏ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏ –∑–∞ –µ–Ω–µ—Ä–≥–∏—è
   - –û–±—è–¥: –±–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω–æ
   - –í–µ—á–µ—Ä—è: –ø–æ-–≤–∏—Å–æ–∫–∏ –ø—Ä–æ—Ç–µ–∏–Ω–∏, –ø–æ-–Ω–∏—Å–∫–∏ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏

3. **–ò–∑–±–æ—Ä –Ω–∞ —Ö—Ä–∞–Ω–∏:**
   - –ë–∞–∑–∏—Ä–∞–Ω–æ –Ω–∞ dietary modifier (Keto, Mediterranean –∏ —Ç.–Ω.)
   - –ò–∑–∫–ª—é—á–≤–∞ –∞–ª–µ—Ä–≥–µ–Ω–∏ –∏ –Ω–µ—Ö–∞—Ä–µ—Å–≤–∞–Ω–∏ —Ö—Ä–∞–Ω–∏
   - –í–∫–ª—é—á–≤–∞ –ª—é–±–∏–º–∏ —Ö—Ä–∞–Ω–∏ (–≤ —É–º–µ—Ä–µ–Ω–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞)
   - –û—Ç—á–∏—Ç–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
     - –î–∏–∞–±–µ—Ç ‚Üí –Ω–∏—Å—ä–∫ –≥–ª–∏–∫–µ–º–∏—á–µ–Ω –∏–Ω–¥–µ–∫—Å, —Å—Ç–∞–±–∏–ª–Ω–∞ –∫—Ä—ä–≤–Ω–∞ –∑–∞—Ö–∞—Ä
     - PCOS ‚Üí –ø–æ-–º–∞–ª–∫–æ –ø—Ä–æ—Å—Ç–∏ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏
     - –•–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º ‚Üí –∏–∑–±—è–≥–≤–∞ –≥–æ–∏—Ç—Ä–æ–≥–µ–Ω–∏ (—Å—É—Ä–æ–≤–∏ –∑–µ–ª–µ–Ω—á—É—Ü–∏ –æ—Ç Cruciferae)
     - –•–∏–ø–µ—Ä—Ç–æ–Ω–∏—è ‚Üí –Ω–∏—Å–∫–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ –Ω–∞ –Ω–∞—Ç—Ä–∏–π

4. **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ:**
   - –ü—Ä–æ–≤–µ—Ä—è–≤–∞ previous meals –∑–∞ –¥–∞ –∏–∑–±–µ–≥–Ω–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ
   - –¶–µ–ª–∏ <20% –¥—É–±–ª–∏—Ä–∞–Ω–µ –ø—Ä–µ–∑ —Å–µ–¥–º–∏—Ü–∞—Ç–∞
   - –í–∞—Ä–∏—Ä–∞ –ø—Ä–æ—Ç–µ–∏–Ω–æ–≤–∏ –∏–∑—Ç–æ—á–Ω–∏—Ü–∏ (–ø–∏–ª–µ—à–∫–æ, —Ä–∏–±–∞, —è–π—Ü–∞, –±–æ–±–æ–≤–∏)
   - –í–∞—Ä–∏—Ä–∞ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–Ω–∏ –∏–∑—Ç–æ—á–Ω–∏—Ü–∏ (–æ—Ä–∏–∑, –∫–∏–Ω–æ–∞, –∫–∞—Ä—Ç–æ—Ñ–∏, –ø–∞—Å—Ç–∞)

5. **–ö–†–ò–¢–ò–ß–ï–ù –§–û–†–ú–ê–¢ –ù–ê MEAL NAME –ò DESCRIPTION:**

**–§–æ—Ä–º–∞—Ç –Ω–∞ `name`** (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω —Å—ä—Å –°–ò–ú–í–û–õ–ò):
```
‚úì –ü–†–ê–í–ò–õ–ù–û:
"‚Ä¢ –®–æ–ø—Å–∫–∞ —Å–∞–ª–∞—Ç–∞
‚Ä¢ –ü–∏–ª–µ—à–∫–∏ –≥—ä—Ä–¥–∏ –Ω–∞ —Å–∫–∞—Ä–∞ —Å –∫–∞—Ä—Ç–æ—Ñ–µ–Ω–æ –ø—é—Ä–µ
‚Ä¢ –•–ª—è–±: 1 —Ñ–∏–ª–∏—è –ø—ä–ª–Ω–æ–∑—ä—Ä–Ω–µ—Å—Ç"

‚úó –ì–†–ï–®–ù–û:
"–ü–∏–ª–µ—à–∫–∏ –≥—ä—Ä–¥–∏ –Ω–∞ —Å–∫–∞—Ä–∞ —Å –∫–∞—Ä—Ç–æ—Ñ–µ–Ω–æ –ø—é—Ä–µ –∏ —Å–∞–ª–∞—Ç–∞ –®–æ–ø—Å–∫–∞" (–≤—Å–∏—á–∫–æ –≤ –µ–¥–Ω–æ)
"‚Ä¢ –°–∞–ª–∞—Ç–∞: –®–æ–ø—Å–∫–∞
‚Ä¢ –û—Å–Ω–æ–≤–Ω–æ: –ü–∏–ª–µ—à–∫–∏ –≥—ä—Ä–¥–∏" (–µ—Ç–∏–∫–µ—Ç–∏)
```

**–§–æ—Ä–º–∞—Ç –Ω–∞ `description`** (–¥–µ—Ç–∞–π–ª–Ω–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏):
```
‚úì –ü–†–ê–í–ò–õ–ù–û:
"‚Ä¢ –®–æ–ø—Å–∫–∞ —Å–∞–ª–∞—Ç–∞ –æ—Ç –¥–æ–º–∞—Ç–∏, –∫—Ä–∞—Å—Ç–∞–≤–∏—Ü–∏, —á—É—à–∫–∏, —Å–∏—Ä–µ–Ω–µ –∏ –º–∞—Å–ª–∏–Ω–∏ —Å –º–∞–ª–∫–æ –∑–µ—Ö—Ç–∏–Ω.
‚Ä¢ –ü–∏–ª–µ—à–∫–∏—Ç–µ –≥—ä—Ä–¥–∏ —Å–µ –ø—Ä–∏–≥–æ—Ç–≤—è—Ç –Ω–∞ —Å–∫–∞—Ä–∞ –∏–ª–∏ –ø–µ—á–µ–Ω–∏ –≤ —Ç–∞–≤–∞ —Å—ä—Å –∑–µ—Ö—Ç–∏–Ω, –ø–æ–¥–ø—Ä–∞–≤–µ–Ω–∏ —Å—ä—Å —Å–æ–ª, —á–µ—Ä–µ–Ω –ø–∏–ø–µ—Ä –∏ —Ä–∏–≥–∞–Ω.
‚Ä¢ –ö–∞—Ä—Ç–æ—Ñ–µ–Ω–æ—Ç–æ –ø—é—Ä–µ —Å–µ –ø—Ä–∏–≥–æ—Ç–≤—è –æ—Ç —Å–≤–∞—Ä–µ–Ω–∏ –∫–∞—Ä—Ç–æ—Ñ–∏, —Å–º–µ—Å–µ–Ω–∏ —Å –º–∞–ª–∫–æ –º–ª—è–∫–æ –∏ –º–∞—Å–ª–æ.
‚Ä¢ 1 —Ñ–∏–ª–∏—è –ø—ä–ª–Ω–æ–∑—ä—Ä–Ω–µ—Å—Ç —Ö–ª—è–±."

‚úó –ì–†–ï–®–ù–û:
"–í–∫—É—Å–Ω–æ —è—Å—Ç–∏–µ —Å –ø–∏–ª–µ" (–Ω—è–º–∞ –¥–µ—Ç–∞–π–ª–∏)
```

#### Output –°—Ç—Ä—É–∫—Ç—É—Ä–∞ (Per Day)

```json
{
  "day1": {
    "meals": [
      {
        "type": "–û–±—è–¥",
        "time": "13:00",
        "name": "‚Ä¢ –®–æ–ø—Å–∫–∞ —Å–∞–ª–∞—Ç–∞
‚Ä¢ –ü–∏–ª–µ—à–∫–∏ –≥—ä—Ä–¥–∏ –Ω–∞ —Å–∫–∞—Ä–∞ —Å –∫–∞—Ä—Ç–æ—Ñ–µ–Ω–æ –ø—é—Ä–µ
‚Ä¢ –•–ª—è–±: 1 —Ñ–∏–ª–∏—è –ø—ä–ª–Ω–æ–∑—ä—Ä–Ω–µ—Å—Ç",
        "weight": "450g",
        "description": "‚Ä¢ –®–æ–ø—Å–∫–∞ —Å–∞–ª–∞—Ç–∞ –æ—Ç –¥–æ–º–∞—Ç–∏, –∫—Ä–∞—Å—Ç–∞–≤–∏—Ü–∏, —á—É—à–∫–∏, —Å–∏—Ä–µ–Ω–µ –∏ –º–∞—Å–ª–∏–Ω–∏ —Å –º–∞–ª–∫–æ –∑–µ—Ö—Ç–∏–Ω.
‚Ä¢ –ü–∏–ª–µ—à–∫–∏—Ç–µ –≥—ä—Ä–¥–∏ (150g) —Å–µ –ø—Ä–∏–≥–æ—Ç–≤—è—Ç –Ω–∞ —Å–∫–∞—Ä–∞ 6-8 –º–∏–Ω—É—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∞ –ø—Ä–∏ 200¬∞C, –ø–æ–¥–ø—Ä–∞–≤–µ–Ω–∏ —Å—ä—Å —Å–æ–ª, —á–µ—Ä–µ–Ω –ø–∏–ø–µ—Ä –∏ —Ä–∏–≥–∞–Ω.
‚Ä¢ –ö–∞—Ä—Ç–æ—Ñ–µ–Ω–æ—Ç–æ –ø—é—Ä–µ (150g) –æ—Ç —Å–≤–∞—Ä–µ–Ω–∏ –∫–∞—Ä—Ç–æ—Ñ–∏, —Å–º–µ—Å–µ–Ω–∏ —Å 50ml –æ–±–µ–∑–º–∞—Å–ª–µ–Ω–æ –º–ª—è–∫–æ.
‚Ä¢ 1 —Ñ–∏–ª–∏—è (30g) –ø—ä–ª–Ω–æ–∑—ä—Ä–Ω–µ—Å—Ç —Ö–ª—è–±.",
        "benefits": "–ü–∏–ª–µ—à–∫–æ—Ç–æ –æ—Å–∏–≥—É—Ä—è–≤–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω –ø—Ä–æ—Ç–µ–∏–Ω –∑–∞ –º—É—Å–∫—É–ª–Ω–∞ –º–∞—Å–∞ –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª–Ω–∏ –º–∞–∑–Ω–∏–Ω–∏. –ö–∞—Ä—Ç–æ—Ñ–∏—Ç–µ –¥–∞–≤–∞—Ç –±–∞–≤–Ω–∏ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏ –∑–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –µ–Ω–µ—Ä–≥–∏—è —Å–ª–µ–¥ –æ–±—è–¥. –°–∞–ª–∞—Ç–∞—Ç–∞ –¥–æ–±–∞–≤—è —Ñ–∏–±—Ä–∏ –∏ –≤–∏—Ç–∞–º–∏–Ω–∏.",
        "calories": 580,
        "macros": {
          "protein": 48,
          "carbs": 52,
          "fats": 16,
          "fiber": 8
        }
      },
      {
        "type": "–í–µ—á–µ—Ä—è",
        "time": "19:30",
        "name": "‚Ä¢ –ü–µ—á–µ–Ω–∞ –±—è–ª–∞ —Ä–∏–±–∞ —Å –ª–∏–º–æ–Ω
‚Ä¢ –ö–∏–Ω–æ–∞
‚Ä¢ –ó–∞–¥—É—à–µ–Ω–∏ –∑–µ–ª–µ–Ω—á—É—Ü–∏",
        "weight": "400g",
        "description": "‚Ä¢ –ë—è–ª–∞ —Ä–∏–±–∞ (—Ç—Ä–µ—Å–∫–∞ –∏–ª–∏ –ø–∞–Ω–≥–∞—Å–∏—É—Å, 180g) –ø–µ—á–µ–Ω–∞ –Ω–∞ —Ñ—É—Ä–Ω–∞ –ø—Ä–∏ 180¬∞C –∑–∞ 15-18 –º–∏–Ω—É—Ç–∏ —Å –ª–∏–º–æ–Ω–æ–≤ —Å–æ–∫, —á–µ—Å—ä–Ω, –º–∞–≥–¥–∞–Ω–æ–∑.
‚Ä¢ –ö–∏–Ω–æ–∞ (80g —Å—É—Ö–æ —Ç–µ–≥–ª–æ) —Å–µ –≥–æ—Ç–≤–∏ 15 –º–∏–Ω—É—Ç–∏ —Å–ø–æ—Ä–µ–¥ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏—Ç–µ.
‚Ä¢ –ó–µ–ª–µ–Ω—á—É—Ü–∏ (–±—Ä–æ–∫–æ–ª–∏, –º–æ—Ä–∫–æ–≤–∏, —Ç–∏–∫–≤–∏—á–∫–∏) –∑–∞–¥—É—à–µ–Ω–∏ –Ω–∞ –ø–∞—Ä–∞ –∏–ª–∏ –ª–µ–∫–æ –∑–∞–ø—ä—Ä–∂–µ–Ω–∏ —Å –º–∞–ª–∫–æ –∑–µ—Ö—Ç–∏–Ω.",
        "benefits": "–†–∏–±–∞—Ç–∞ –µ –Ω–∏—Å–∫–æ–∫–∞–ª–æ—Ä–∏—á–Ω–∞ –∏ –±–æ–≥–∞—Ç–∞ –Ω–∞ –æ–º–µ–≥–∞-3 (–ø—Ä–æ—Ç–∏–≤–æ–≤—ä–∑–ø–∞–ª–∏—Ç–µ–ª–Ω–æ –∑–∞ PCOS). –ö–∏–Ω–æ–∞—Ç–∞ –µ –ø—ä–ª–Ω–æ—Ü–µ–Ω–µ–Ω –ø—Ä–æ—Ç–µ–∏–Ω —Å –≤—Å–∏—á–∫–∏ –∞–º–∏–Ω–æ–∫–∏—Å–µ–ª–∏–Ω–∏. –ó–µ–ª–µ–Ω—á—É—Ü–∏—Ç–µ –æ—Å–∏–≥—É—Ä—è–≤–∞—Ç —Ñ–∏–±—Ä–∏ –∑–∞ —Å–∏—Ç–æ—Å—Ç.",
        "calories": 485,
        "macros": {
          "protein": 42,
          "carbs": 48,
          "fats": 10,
          "fiber": 9
        }
      }
    ],
    "dailyTotals": {
      "calories": 1650,
      "protein": 125,
      "carbs": 185,
      "fats": 46
    }
  },
  "day2": {
    "meals": [ /* similar structure */ ]
  }
}
```

#### –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –•—Ä–∞–Ω–µ–Ω–∏—è

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–µ–¥ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ:**

1. **–ö–∞–ª–æ—Ä–∏–∏:** –î–Ω–µ–≤–Ω–∞ —Å—É–º–∞ ¬± 5% –æ—Ç recommendedCalories
2. **–ú–∞–∫—Ä–æ—Å–∏:** –í —Ä–∞–º–∫–∏—Ç–µ –Ω–∞ ¬±10% –æ—Ç —Ü–µ–ª–µ–≤–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏
3. **Meal Types:** –•—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ–Ω —Ä–µ–¥ (–ó–∞–∫—É—Å–∫–∞ ‚Üí –û–±—è–¥ ‚Üí –ó–∞–∫—É—Å–∫–∞ ‚Üí –í–µ—á–µ—Ä—è)
4. **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ:** <20% –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è
5. **–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏:** –ù—è–º–∞ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è (–¥–∏–∞–±–µ—Ç + –≤–∏—Å–æ–∫–∏ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏, PCOS + –ø—Ä–æ—Å—Ç–∏ –∑–∞—Ö–∞—Ä–∏)
6. **–ê–ª–µ—Ä–≥–µ–Ω–∏:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–µ—â—É —Å–ø–∏—Å—ä–∫–∞ —Å –Ω–µ—Ö–∞—Ä–µ—Å–≤–∞–Ω–∏/–∞–ª–µ—Ä–≥–∏—á–Ω–∏ —Ö—Ä–∞–Ω–∏

**–ö–æ—Ä–µ–∫—Ü–∏–∏** (–∞–∫–æ –∏–º–∞ –≥—Ä–µ—à–∫–∏):
- –ú–∞–∫—Å–∏–º—É–º 3 –æ–ø–∏—Ç–∞ –∑–∞ –ø–æ–ø—Ä–∞–≤–∫–∞
- AI –ø–æ–ª—É—á–∞–≤–∞ –¥–µ—Ç–∞–π–ª–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –≥—Ä–µ—à–∫–∞—Ç–∞
- –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞ —Å–∞–º–æ –ø—Ä–æ–±–ª–µ–º–Ω–∏—Ç–µ –¥–Ω–∏

---

### –°–¢–™–ü–ö–ê 3.4: –û–ë–û–ë–©–ï–ù–ò–ï (Request 7)

**–§—É–Ω–∫—Ü–∏—è:** `generateSummaryStep()`
**Token Limit:** 2000 tokens
**AI Prompt:** `admin_summary_prompt` –æ—Ç KV Storage

#### Input –î–∞–Ω–Ω–∏

- **–ö–û–ú–ü–ê–ö–¢–ù–ê strategy**
- **–ü—ä–ª–Ω–∞ —Å–µ–¥–º–∏—Ü–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è** (–≤—Å–∏—á–∫–∏ 7 –¥–Ω–∏)
- BMR, recommendedCalories, actual calories –æ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏—Ç–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- Actual macros —Å—Ä–µ–¥–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏

#### AI –û–±—Ä–∞–±–æ—Ç–∫–∞

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ü–ª–∞–Ω:**
   - –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏—Ç–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∞—Ç –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ç–∞
   - –ò–∑—á–∏—Å–ª—è–≤–∞ —Ä–µ–∞–ª–Ω–∏ —Å—Ä–µ–¥–Ω–∏ –∫–∞–ª–æ—Ä–∏–∏ –∏ –º–∞–∫—Ä–æ—Å–∏
   - –ü–æ—Ç–≤—ä—Ä–∂–¥–∞–≤–∞ —á–µ dietary modifier –µ —Å–ø–∞–∑–µ–Ω

2. **–ü—Ä–µ–ø–æ—Ä—ä–∫–∏ (Recommendations):**
   - 5-10 –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ —Ö—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏
   - –ë–∞–∑–∏—Ä–∞–Ω–∏ –Ω–∞ dietary modifier –∏ —Ü–µ–ª
   - –ü—Ä–∏–º–µ—Ä: "–ú–∞–∑–Ω–∞ —Ä–∏–±–∞ (—Å—å–æ–º–≥–∞, —Å–∫—É–º—Ä–∏—è) 3x/—Å–µ–¥–º–∏—Ü–∞ –∑–∞ –æ–º–µ–≥–∞-3"

3. **–ó–∞–±—Ä–∞–Ω–µ–Ω–∏ –•—Ä–∞–Ω–∏ (Forbidden):**
   - 5-10 —Ö—Ä–∞–Ω–∏ –∑–∞ –∏–∑–±—è–≥–≤–∞–Ω–µ
   - –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ –∑–∞ —Ü–µ–ª—Ç–∞ –∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ç–µ —Å—ä—Å—Ç–æ—è–Ω–∏—è
   - –ü—Ä–∏–º–µ—Ä: "–ë—è–ª —Ö–ª—è–± –∏ —Å–ª–∞–¥–∫–∏—à–∏ (–≤–∏—Å–æ–∫–æ –≥–ª–∏–∫–µ–º–∏—á–µ–Ω –∏–Ω–¥–µ–∫—Å –≤–ª–æ—à–∞–≤–∞ PCOS)"

4. **–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è (Psychology):**
   - 3-5 –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —Å—ä–≤–µ—Ç–∞
   - –ë–∞–∑–∏—Ä–∞–Ω–∏ –Ω–∞ –µ–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–æ—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–µ, —Ç—Ä–∏–≥–µ—Ä–∏—Ç–µ, –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è—Ç–∞
   - –ü—Ä–∏–º–µ—Ä: "–ü—Ä–∞–∫—Ç–∏–∫—É–≤–∞–π 20-–º–∏–Ω—É—Ç–Ω–æ –∑–∞–±–∞–≤—è–Ω–µ –ø—Ä–µ–¥–∏ –≤—Ç–æ—Ä–∏ –ø–æ—Ä—Ü–∏—è. –ü–∏–π –≤–æ–¥–∞, —Ä–∞–∑—Ö–æ–¥–∏ —Å–µ"

5. **–•–∏–¥—Ä–∞—Ç–∞—Ü–∏—è:**
   - –ü—Ä–µ–ø–æ—Ä—ä—á–∞–Ω–∏ –ª–∏—Ç—Ä–∏ –≤–æ–¥–∞ –¥–Ω–µ–≤–Ω–æ
   - –ë–∞–∑–∏—Ä–∞–Ω–æ –Ω–∞ —Ç–µ–≥–ª–æ, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç, –∫–ª–∏–º–∞—Ç
   - –°–ø–µ—Ü–∏–∞–ª–Ω–∏ —É–∫–∞–∑–∞–Ω–∏—è (–ø—Ä–∏ –≤–∏—Å–æ–∫ —Å—Ç—Ä–µ—Å ‚Üí –ø–æ–≤–µ—á–µ –≤–æ–¥–∞)

6. **–î–æ–±–∞–≤–∫–∏ (Supplements):**
   - –ü—Ä–µ–ø–æ—Ä—ä–∫–∏—Ç–µ –æ—Ç Strategy —Å–µ –≤–∫–ª—é—á–≤–∞—Ç —Ç—É–∫
   - –í—Ä–µ–º–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–µ–º–∞–Ω–µ (—Å—É—Ç—Ä–∏–Ω/–≤–µ—á–µ—Ä)
   - –î–æ–∑–∏—Ä–æ–≤–∫–∏
   - –û–±–æ—Å–Ω–æ–≤–∫–∞

#### Output –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```json
{
  "summary": {
    "bmr": 1420,
    "dailyCalories": 1648,
    "macros": {
      "protein": 124,
      "carbs": 184,
      "fats": 46
    }
  },
  
  "recommendations": [
    "–ú–∞–∑–Ω–∞ —Ä–∏–±–∞ (—Å—å–æ–º–≥–∞, —Å–∫—É–º—Ä–∏—è, —Å–∞—Ä–¥–∏–Ω–∏) –º–∏–Ω–∏–º—É–º 3 –ø—ä—Ç–∏ —Å–µ–¥–º–∏—á–Ω–æ –∑–∞ –æ–º–µ–≥–∞-3 –º–∞—Å—Ç–Ω–∏ –∫–∏—Å–µ–ª–∏–Ω–∏ (–ø—Ä–æ—Ç–∏–≤–æ–≤—ä–∑–ø–∞–ª–∏—Ç–µ–ª–Ω–æ –∑–∞ PCOS)",
    "–õ–∏—Å—Ç–Ω–∏ –∑–µ–ª–µ–Ω—á—É—Ü–∏ –ø—Ä–∏ –æ–±—è–¥ –∏ –≤–µ—á–µ—Ä—è –∑–∞ —Å–∏—Ç–æ—Å—Ç –∏ –≤–∏—Ç–∞–º–∏–Ω–∏ –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª–Ω–∏ –∫–∞–ª–æ—Ä–∏–∏",
    "–ü—ä–ª–Ω–æ–∑—ä—Ä–Ω–µ—Å—Ç —Ö–ª—è–± –≤–º–µ—Å—Ç–æ –±—è–ª –∑–∞ —Å—Ç–∞–±–∏–ª–Ω–∞ –∫—Ä—ä–≤–Ω–∞ –∑–∞—Ö–∞—Ä –∏ —Ñ–∏–±—Ä–∏",
    "–ë–æ–±–æ–≤–∏ —Ö—Ä–∞–Ω–∏ (–ª–µ—â–∞, –±–æ–±, –Ω–∞—Ö—É—Ç) 2-3 –ø—ä—Ç–∏ —Å–µ–¥–º–∏—á–Ω–æ –∑–∞ —Ñ–∏–±—Ä–∏ –∏ —Ä–∞—Å—Ç–∏—Ç–µ–ª–µ–Ω –ø—Ä–æ—Ç–µ–∏–Ω",
    "–Ø–¥–∫–∏ –∫–∞—Ç–æ –∑–∞–∫—É—Å–∫–∞ (–±–∞–¥–µ–º–∏, –æ—Ä–µ—Ö–∏) - –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–∞–Ω–∏ –ø–æ—Ä—Ü–∏–∏ 30g –∑–∞ –∑–¥—Ä–∞–≤–æ—Å–ª–æ–≤–Ω–∏ –º–∞–∑–Ω–∏–Ω–∏",
    "–Ø–π—Ü–∞ 3-4 –ø—ä—Ç–∏ —Å–µ–¥–º–∏—á–Ω–æ –∑–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω –ø—Ä–æ—Ç–µ–∏–Ω –∏ –≤–∏—Ç–∞–º–∏–Ω D",
    "–ì—Ä—ä—Ü–∫–æ –∫–∏—Å–µ–ª–æ –º–ª—è–∫–æ –∑–∞ –ø—Ä–æ–±–∏–æ—Ç–∏—Ü–∏ –∏ –∫–∞–ª—Ü–∏–π (–∞–∫–æ –Ω—è–º–∞ –Ω–µ–ø–æ–Ω–æ—Å–∏–º–æ—Å—Ç –∫—ä–º –ª–∞–∫—Ç–æ–∑–∞)"
  ],
  
  "forbidden": [
    "–ë—è–ª —Ö–ª—è–± –∏ —Å–ª–∞–¥–∫–∏—à–∏ —Å –±—è–ª–æ –±—Ä–∞—à–Ω–æ (–≤–∏—Å–æ–∫–æ –≥–ª–∏–∫–µ–º–∏—á–µ–Ω –∏–Ω–¥–µ–∫—Å –≤–ª–æ—à–∞–≤–∞ PCOS –∏ –∏–Ω—Å—É–ª–∏–Ω–æ–≤–∞ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç)",
    "–ó–∞—Ö–∞—Ä–æ—Å–∞–Ω–∏ –Ω–∞–ø–∏—Ç–∫–∏ –∏ —Å–æ–∫–æ–≤–µ (—Å–∫—Ä–∏—Ç–∏ –∫–∞–ª–æ—Ä–∏–∏, —Å–∫–æ–∫ –Ω–∞ –∫—Ä—ä–≤–Ω–∞—Ç–∞ –∑–∞—Ö–∞—Ä)",
    "–ü—ä—Ä–∂–µ–Ω–∏ —Ö—Ä–∞–Ω–∏ –∏ —Ñ–∞—Å—Ç —Ñ—É—É–¥ (–≤–∏—Å–æ–∫–∏ –Ω–∞—Å–∏—Ç–µ–Ω–∏ –º–∞–∑–Ω–∏–Ω–∏, –≤—ä–∑–ø–∞–ª–µ–Ω–∏–µ)",
    "–ü—Ä–µ—Ä–∞–±–æ—Ç–µ–Ω–∏ –º–µ—Å–∞ (—Å–∞–ª–∞–º–∏, –Ω–∞–¥–µ–Ω–∏—Ü–∞, –∫–æ–ª–±–∞—Å) - –≤–∏—Å–æ–∫–æ –Ω–∞—Ç—Ä–∏–π –∏ –∞–¥–∏—Ç–∏–≤–∏",
    "–ü–∞–∫–µ—Ç–∏—Ä–∞–Ω–∏ —Å–Ω–∞–∫—Å–æ–≤–µ (—á–∏–ø—Å, –±–∏—Å–∫–≤–∏—Ç–∏) - —Ç—Ä–∞–Ω—Å–º–∞–∑–Ω–∏–Ω–∏ –∏ –ø—Ä–∞–∑–Ω–∏ –∫–∞–ª–æ—Ä–∏–∏",
    "–ë—è–ª–∞ –ø–∞—Å—Ç–∞ –∏ –±—è–ª –æ—Ä–∏–∑ –≤ –≥–æ–ª–µ–º–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (–ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π –ø—ä–ª–Ω–æ–∑—ä—Ä–Ω–µ—Å—Ç–∏ –≤–µ—Ä—Å–∏–∏)",
    "–°–ª–∞–¥–æ–ª–µ–¥ –∏ –¥–µ—Å–µ—Ä—Ç–∏ —Å –≤–∏—Å–æ–∫–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ –Ω–∞ –∑–∞—Ö–∞—Ä (–∏–∑–ø–æ–ª–∑–≤–∞–π —Ä—è–¥–∫–æ –∫–∞—Ç–æ –Ω–∞–≥—Ä–∞–¥–∞)"
  ],
  
  "psychology": [
    "–í–æ–¥–∏ –¥–Ω–µ–≤–Ω–∏–∫ –Ω–∞ –µ–º–æ—Ü–∏–∏—Ç–µ - –æ—Ç–±–µ–ª—è–∑–≤–∞–π –∫–∞–∫–≤–æ —á—É–≤—Å—Ç–≤–∞—à –ø—Ä–µ–¥–∏ –¥–∞ —è–¥–µ—à. –†–∞–∑–ø–æ–∑–Ω–∞–π –∏—Å—Ç–∏–Ω—Å–∫–∏—è –≥–ª–∞–¥ –æ—Ç –µ–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–∞—Ç–∞ –Ω—É–∂–¥–∞.",
    "–ü—Ä–∞–∫—Ç–∏–∫—É–≤–∞–π 20-–º–∏–Ω—É—Ç–Ω–æ –∑–∞–±–∞–≤—è–Ω–µ –ø—Ä–µ–¥–∏ –≤—Ç–æ—Ä–∏ –ø–æ—Ä—Ü–∏—è. –ü–∏–π —á–∞—à–∞ –≤–æ–¥–∞, —Ä–∞–∑—Ö–æ–¥–∏ —Å–µ –∏–∑ —Å—Ç–∞—è—Ç–∞. –ß–µ—Å—Ç–æ '–≥–ª–∞–¥—ä—Ç' –∏–∑—á–µ–∑–≤–∞.",
    "–ü–ª–∞–Ω–∏—Ä–∞–π —É–∏–∫–µ–Ω–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–æ –∑–∞ –¥–∞ –∏–∑–±–µ–≥–Ω–µ—à —Å—Ç—Ä–µ—Å–æ–≤–æ —Ö—Ä–∞–Ω–µ–Ω–µ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—è –º–æ–º–µ–Ω—Ç.",
    "–ü—Ä–∏ –∂–µ–ª–∞–Ω–∏–µ –∑–∞ —Å–ª–∞–¥–∫–æ - –∏–∑–±–∏—Ä–∞–π —Ç—ä–º–µ–Ω —à–æ–∫–æ–ª–∞–¥ (70%+ –∫–∞–∫–∞–æ) 20-30g –≤–º–µ—Å—Ç–æ –±–æ–Ω–±–æ–Ω–∏.",
    "–ù–µ –∏–∑–ø–æ–ª–∑–≤–∞–π —Ö—Ä–∞–Ω–∞—Ç–∞ –∫–∞—Ç–æ –Ω–∞–≥—Ä–∞–¥–∞ –∏–ª–∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ. –ù–∞–≥—Ä–∞–¥–∏ —Å–µ —Å –Ω–µ—â–∞ –∏–∑–≤—ä–Ω —Ö—Ä–∞–Ω–∞—Ç–∞ (—Ñ–∏–ª–º, –º–∞—Å–∞–∂, —Ä–∞–∑—Ö–æ–¥–∫–∞)."
  ],
  
  "waterIntake": "–ú–∏–Ω–∏–º—É–º 2.5-3 –ª–∏—Ç—Ä–∞ –≤–æ–¥–∞ –¥–Ω–µ–≤–Ω–æ. –ü—Ä–∏ 78 –∫–≥ —Ç–µ–≥–ª–æ –∏ —É–º–µ—Ä–µ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç —Ü–µ–ª—Ç–∞ –µ 2.5–ª. –î–æ–±–∞–≤–∏ 0.5–ª –∞–∫–æ –µ –≥–æ—Ä–µ—â–æ –∏–ª–∏ —Å–ø–æ—Ä—Ç—É–≤–∞—à. –ü–∏–π –ø–æ 1 —á–∞—à–∞ –≤–æ–¥–∞ –ø—Ä–µ–¥–∏ –≤—Å—è–∫–æ —Ö—Ä–∞–Ω–µ–Ω–µ.",
  
  "supplements": [
    "–ú–∞–≥–Ω–µ–∑–∏–π 300mg –≤–µ—á–µ—Ä (1 —á–∞—Å –ø—Ä–µ–¥–∏ –ª—è–≥–∞–Ω–µ) - –ø–æ–¥–æ–±—Ä—è–≤–∞ –∫–∞—á–µ—Å—Ç–≤–æ—Ç–æ –Ω–∞ —Å—ä–Ω—è –æ—Ç 5.5h –Ω–∞ 7h+",
    "–û–º–µ–≥–∞-3 1000mg —Å—É—Ç—Ä–∏–Ω —Å —Ö—Ä–∞–Ω–∞ (–æ–ø—Ç–∏–º–∞–ª–Ω–∞ –∞–±—Å–æ—Ä–±—Ü–∏—è —Å –º–∞–∑–Ω–∏–Ω–∏) - –ø—Ä–æ—Ç–∏–≤–æ–≤—ä–∑–ø–∞–ª–∏—Ç–µ–ª–Ω–æ –∑–∞ PCOS",
    "–ò–Ω–æ–∑–∏—Ç–æ–ª 2000mg —Å—É—Ç—Ä–∏–Ω –Ω–∞ –ø—Ä–∞–∑–µ–Ω —Å—Ç–æ–º–∞—Ö - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞ –¥–æ–±–∞–≤–∫–∞ –∑–∞ PCOS –∑–∞ –æ–≤—É–ª–∞—Ü–∏—è –∏ –∏–Ω—Å—É–ª–∏–Ω–æ–≤–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–Ω–æ—Å—Ç",
    "–í–∏—Ç–∞–º–∏–Ω D3 2000IU —Å—É—Ç—Ä–∏–Ω —Å —Ö—Ä–∞–Ω–∞ (–º–∞—Å—Ç–Ω–æ—Ä–∞–∑—Ç–≤–æ—Ä–∏–º –≤–∏—Ç–∞–º–∏–Ω) - –ø–æ–¥–∫—Ä–µ–ø—è –∏–º—É–Ω–Ω–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –∏ —Ç–∏—Ä–µ–æ–∏–¥–Ω–∞—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è"
  ]
}
```

---

### –§–∏–Ω–∞–ª–Ω–æ –°–≥–ª–æ–±—è–≤–∞–Ω–µ –Ω–∞ –ü–ª–∞–Ω–∞

–°–ª–µ–¥ –≤—Å–∏—á–∫–∏ 6 AI –∑–∞—è–≤–∫–∏, `worker.js` —Å–≥–ª–æ–±—è–≤–∞ –ø—ä–ª–Ω–∏—è –ø–ª–∞–Ω:

```json
{
  "day1": { /* meals from chunks */ },
  "day2": { /* meals */ },
  "day3": { /* meals */ },
  "day4": { /* meals */ },
  "day5": { /* meals */ },
  "day6": { /* meals */ },
  "day7": { /* meals */ },
  
  "analysis": { /* full analysis object from Step 1 */ },
  "strategy": { /* full strategy object from Step 2 */ },
  "summary": { /* from Step 4 */ },
  "recommendations": [ /* from Step 4 */ ],
  "forbidden": [ /* from Step 4 */ ],
  "psychology": [ /* from Step 4 */ ],
  "waterIntake": "...",
  "supplements": [ /* from Step 4 */ ],
  
  "_meta": {
    "generatedAt": "2026-02-05T19:30:00.000Z",
    "generationTimeSeconds": 45,
    "totalTokensUsed": 24500,
    "stepsCompleted": 6,
    "model": "gpt-4o-mini",
    "version": "2.0-multistep"
  }
}
```

–¢–æ–∑–∏ –ø—ä–ª–µ–Ω –ø–ª–∞–Ω —Å–µ –≤—Ä—ä—â–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞ –≤ `localStorage`.

---
## üíæ –°–¢–™–ü–ö–ê 4: –°–™–•–†–ê–ù–ï–ù–ò–ï –ù–ê –î–ê–ù–ù–ò

### –§–∏–ª–æ—Å–æ—Ñ–∏—è: Privacy-First Architecture

**–ö–†–ò–¢–ò–ß–ï–ù –ü–†–ò–ù–¶–ò–ü:** –í—Å–∏—á–∫–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –¥–∞–Ω–Ω–∏ —Å–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞—Ç –°–ê–ú–û –ª–æ–∫–∞–ª–Ω–æ –≤ –±—Ä–∞—É–∑—ä—Ä–∞ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è. –°—ä—Ä–≤—ä—Ä—ä—Ç –ù–ï –ü–ê–ó–ò –Ω–∏–∫–∞–∫–≤–∏ –ª–∏—á–Ω–∏ –¥–∞–Ω–Ω–∏, –ø–ª–∞–Ω–æ–≤–µ –∏–ª–∏ –∏—Å—Ç–æ—Ä–∏—è –Ω–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∏.

### localStorage –°—Ç—Ä—É–∫—Ç—É—Ä–∞

#### –ö–ª—é—á–æ–≤–µ –∏ –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

| –ö–ª—é—á | –°—ä–¥—ä—Ä–∂–∞–Ω–∏–µ | –†–∞–∑–º–µ—Ä | –°—ä—Ö—Ä–∞–Ω—è–≤–∞ —Å–µ –æ—Ç | –ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –æ—Ç |
|------|-----------|--------|-----------------|----------------|
| `questionnaireAnswers` | –û—Ç–≥–æ–≤–æ—Ä–∏ –æ—Ç –≤—ä–ø—Ä–æ—Å–Ω–∏–∫–∞ (temp) | ~5KB | questionnaire.html | questionnaire.html (backup) |
| `userData` | –û–∫–æ–Ω—á–∞—Ç–µ–ª–Ω–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –¥–∞–Ω–Ω–∏ | ~5KB | questionnaire.html | plan.html, chat |
| `dietPlan` | –ü—ä–ª–µ–Ω 7-–¥–Ω–µ–≤–µ–Ω –ø–ª–∞–Ω + –∞–Ω–∞–ª–∏–∑ | ~80-150KB | questionnaire.html | analysis.html, plan.html, chat |
| `userId` | –£–Ω–∏–∫–∞–ª–µ–Ω –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä | ~50B | questionnaire.html | plan.html, chat |
| `chatHistory` | –ò—Å—Ç–æ—Ä–∏—è –Ω–∞ —á–∞—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∏ | ~10-50KB | plan.html | plan.html, chat API |
| `theme` | –¢–µ–º–∞ (light/dark) | ~10B | –í—Å–∏—á–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∏ | –í—Å–∏—á–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∏ |
| `warningData` | –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∑–∞ –∑–¥—Ä–∞–≤–Ω–∏ —Ä–∏—Å–∫–æ–≤–µ | ~2KB | questionnaire.html | warning.html |

#### –î–µ—Ç–∞–π–ª–Ω–æ –°—ä–¥—ä—Ä–∂–∞–Ω–∏–µ

**`userData`** - –ö–æ–ø–∏–µ –Ω–∞ `answers` –æ–±–µ–∫—Ç –æ—Ç –≤—ä–ø—Ä–æ—Å–Ω–∏–∫–∞:
```json
{
  "name": "–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞",
  "gender": "–ñ–µ–Ω–∞",
  "age": 35,
  "height": 165,
  "weight": 78,
  "goal": "–û—Ç—Å–ª–∞–±–≤–∞–Ω–µ",
  "lossKg": 10,
  /* ... –≤—Å–∏—á–∫–∏ 40+ –ø–æ–ª–µ—Ç–∞ –æ—Ç –≤—ä–ø—Ä–æ—Å–Ω–∏–∫–∞ */
}
```

**`dietPlan`** - –ü—ä–ª–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω –ø–ª–∞–Ω:
```json
{
  "day1": {
    "meals": [
      { "type": "–û–±—è–¥", "name": "...", "calories": 580, ... },
      { "type": "–í–µ—á–µ—Ä—è", "name": "...", "calories": 485, ... }
    ],
    "dailyTotals": { "calories": 1650, "protein": 125, ... }
  },
  /* ... day2 –¥–æ day7 */
  "analysis": { "bmr": 1420, "tdee": 2050, ... },
  "strategy": { "dietaryModifier": "Mediterranean", ... },
  "recommendations": [ "...", "..." ],
  "forbidden": [ "...", "..." ],
  "psychology": [ "...", "..." ],
  "_meta": { "generatedAt": "...", "totalTokensUsed": 24500 }
}
```

**`chatHistory`** - –ú–∞—Å–∏–≤ –æ—Ç —Å—ä–æ–±—â–µ–Ω–∏—è:
```json
[
  {
    "role": "user",
    "content": "–ú–æ–∂–µ –ª–∏ –¥–∞ —è–º –±–∞–Ω–∞–Ω–∏ –≤—Å–µ–∫–∏ –¥–µ–Ω?",
    "timestamp": "2026-02-05T10:30:00.000Z"
  },
  {
    "role": "assistant",
    "content": "–ó–¥—Ä–∞–≤–µ–π –ú–∞—Ä–∏—è! –ë–∞–Ω–∞–Ω–∏—Ç–µ —Å–∞ —á—É–¥–µ—Å–µ–Ω –∏–∑–±–æ—Ä...",
    "timestamp": "2026-02-05T10:30:15.000Z"
  }
]
```

### –ó–∞—â–æ localStorage?

**–ü—Ä–µ–¥–∏–º—Å—Ç–≤–∞:**
1. **–ê–±—Å–æ–ª—é—Ç–Ω–∞ –ø–æ–≤–µ—Ä–∏—Ç–µ–ª–Ω–æ—Å—Ç** - –î–∞–Ω–Ω–∏—Ç–µ –ù–ò–ö–û–ì–ê –Ω–µ –Ω–∞–ø—É—Å–∫–∞—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ—Ç–æ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
2. **GDPR —Å—ä–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç** - –ù–µ —Å–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞—Ç –ª–∏—á–Ω–∏ –¥–∞–Ω–Ω–∏ –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∏
3. **–ú–∏–≥–Ω–æ–≤–µ–Ω –¥–æ—Å—Ç—ä–ø** - –ë–µ–∑ network latency (0ms vs 50-100ms –æ—Ç —Å—ä—Ä–≤—ä—Ä)
4. **Offline –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç–∏** - –ú–æ–∂–µ –¥–∞ —Ä–∞–∑–≥–ª–µ–∂–¥–∞ –ø–ª–∞–Ω–∞ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
5. **–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª** - –ú–æ–∂–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ –¥–∞–Ω–Ω–∏—Ç–µ –ø–æ –≤—Å—è–∫–æ –≤—Ä–µ–º–µ
6. **–ù—É–ª–µ–≤–∞ —Ü–µ–Ω–∞ –∑–∞ —Å—ä—Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –ù–µ —Å–µ –Ω—É–∂–¥–∞–µ –æ—Ç –±–∞–∑–∞ –¥–∞–Ω–Ω–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç—ä—Ü–∏:**
- –î–∞–Ω–Ω–∏—Ç–µ —Å–µ –≥—É–±—è—Ç –ø—Ä–∏ –∏–∑—á–∏—Å—Ç–≤–∞–Ω–µ –Ω–∞ –±—Ä–∞—É–∑—ä—Ä–∞
- –ù–µ —Å–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–∞—Ç –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä–∞ (~5-10MB –Ω–∞ –¥–æ–º–µ–π–Ω)

### Cloudflare Worker KV (–°–ê–ú–û –∑–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

Worker –∏–∑–ø–æ–ª–∑–≤–∞ KV Storage –°–ê–ú–û –∑–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

| –ö–ª—é—á | –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|----------------|
| `admin_analysis_prompt` | AI –ø—Ä–æ–º–ø—Ç –∑–∞ –∞–Ω–∞–ª–∏–∑–∞ |
| `admin_strategy_prompt` | AI –ø—Ä–æ–º–ø—Ç –∑–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ç–∞ |
| `admin_meal_plan_prompt` | AI –ø—Ä–æ–º–ø—Ç –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è |
| `admin_summary_prompt` | AI –ø—Ä–æ–º–ø—Ç –∑–∞ –æ–±–æ–±—â–µ–Ω–∏–µ—Ç–æ |
| `admin_consultation_prompt` | AI –ø—Ä–æ–º–ø—Ç –∑–∞ —á–∞—Ç –∫–æ–Ω—Å—É–ª—Ç–∞—Ü–∏—è |
| `admin_modification_prompt` | AI –ø—Ä–æ–º–ø—Ç –∑–∞ —á–∞—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| `admin_ai_provider` | AI –¥–æ—Å—Ç–∞–≤—á–∏–∫ (openai/google) |
| `admin_ai_model_name` | AI –º–æ–¥–µ–ª (gpt-4o-mini) |

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –í KV Storage –ù–ï –°–ï –°–™–•–†–ê–ù–Ø–í–ê–¢ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏ –¥–∞–Ω–Ω–∏, –ø–ª–∞–Ω–æ–≤–µ –∏–ª–∏ —á–∞—Ç –∏—Å—Ç–æ—Ä–∏—è!

---

## üé® –°–¢–™–ü–ö–ê 5: –ò–ó–í–ï–ñ–î–ê–ù–ï –í –ü–û–¢–†–ï–ë–ò–¢–ï–õ–°–ö–ò–Ø –ò–ù–¢–ï–†–§–ï–ô–°

### –§–∞–π–ª–æ–≤–µ: `analysis.html` –∏ `plan.html`

### 5.1. Analysis Page (analysis.html)

**–¶–µ–ª:** –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –∑–¥—Ä–∞–≤–Ω–∏—è –∞–Ω–∞–ª–∏–∑ –ø—Ä–µ–¥–∏ –ø—ä–ª–Ω–∏—è –ø–ª–∞–Ω.

#### –ö–∞–∫–≤–æ —Å–µ –ø–æ–∫–∞–∑–≤–∞:

1. **Welcome Message** –æ—Ç strategy:
   - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω–æ –æ–±—Ä—ä—â–µ–Ω–∏–µ
   - –û–±—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª–Ω–∏—è –ø–æ–¥—Ö–æ–¥

2. **–û—Å–Ω–æ–≤–Ω–∏ –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏:**
   - BMR (–ë–∞–∑–æ–≤ –º–µ—Ç–∞–±–æ–ª–∏–∑—ä–º)
   - TDEE (–î–Ω–µ–≤–Ω–∞ –∫–æ–Ω—Å—É–º–∞—Ü–∏—è –Ω–∞ –µ–Ω–µ—Ä–≥–∏—è)
   - –ü—Ä–µ–ø–æ—Ä—ä—á–∞–Ω–∏ –∫–∞–ª–æ—Ä–∏–∏
   - –ú–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–∏ (–ø—Ä–æ—Ç–µ–∏–Ω–∏, –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏, –º–∞–∑–Ω–∏–Ω–∏ –≤ –≥—Ä–∞–º–æ–≤–µ)

3. **Key Problems** (—Å–∞–º–æ Borderline/Risky/Critical):
   - –ó–∞–≥–ª–∞–≤–∏–µ –Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞
   - –°–µ—Ä–∏–æ–∑–Ω–æ—Å—Ç (–≤–∏–∑—É–∞–ª–Ω–∞ –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å —Ü–≤–µ—Ç–æ–≤–µ)
   - –í—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ –≤—ä—Ä—Ö—É –∑–¥—Ä–∞–≤–µ—Ç–æ
   - –†–µ—à–µ–Ω–∏–µ/–ø—Ä–µ–ø–æ—Ä—ä–∫–∏

4. **Success Chance:** –í–∏–∑—É–∞–ª–Ω–∞ –∏–Ω–¥–∏–∫–∞—Ü–∏—è –æ—Ç -100 –¥–æ +100

5. **–ë—É—Ç–æ–Ω:** "–í–∏–∂ –ü—ä–ª–Ω–∏—è –ü–ª–∞–Ω" ‚Üí –ø—Ä–µ–Ω–∞—Å–æ—á–≤–∞ –∫—ä–º plan.html

#### –ò–∑—Ç–æ—á–Ω–∏–∫ –Ω–∞ –¥–∞–Ω–Ω–∏:

```javascript
const dietPlan = JSON.parse(localStorage.getItem('dietPlan'));
const analysis = dietPlan.analysis;
const strategy = dietPlan.strategy;

// –†–µ–Ω–¥–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ UI —Å –¥–∞–Ω–Ω–∏—Ç–µ
```

---

### 5.2. Plan Page (plan.html)

**–¶–µ–ª:** –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –ø—ä–ª–Ω–∏—è 7-–¥–Ω–µ–≤–µ–Ω —Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–Ω –ø–ª–∞–Ω —Å –Ω–∞–≤–∏–≥–∞—Ü–∏—è –∏ –¥–µ—Ç–∞–π–ª–∏.

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ UI:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  HEADER                                 ‚îÇ
‚îÇ  - Logo                                 ‚îÇ
‚îÇ  - Theme toggle (light/dark)            ‚îÇ
‚îÇ  - User name                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  DAY NAVIGATION (Chips)                 ‚îÇ
‚îÇ  [–î–µ–Ω 1] [–î–µ–Ω 2] [–î–µ–Ω 3] ... [–î–µ–Ω 7]  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MEAL CARDS                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  üç≥ –û–±—è–¥ ‚Ä¢ 13:00 ‚Ä¢ 580 cal      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –®–æ–ø—Å–∫–∞ —Å–∞–ª–∞—Ç–∞                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –ü–∏–ª–µ—à–∫–∏ –≥—ä—Ä–¥–∏ –Ω–∞ —Å–∫–∞—Ä–∞       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  [–í–∏–∂ –î–µ—Ç–∞–π–ª–∏]                  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ  üçΩÔ∏è –í–µ—á–µ—Ä—è ‚Ä¢ 19:30 ‚Ä¢ 485 cal   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –ü–µ—á–µ–Ω–∞ –±—è–ª–∞ —Ä–∏–±–∞             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –ö–∏–Ω–æ–∞                        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  [–í–∏–∂ –î–µ—Ç–∞–π–ª–∏]                  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  üìä –î–Ω–µ–≤–Ω–∞ –°—É–º–∞: 1650 cal               ‚îÇ
‚îÇ      –ü—Ä–æ—Ç–µ–∏–Ω–∏: 125g | –í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏: 185g‚îÇ
‚îÇ      –ú–∞–∑–Ω–∏–Ω–∏: 46g                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ACCORDION –°–ï–ö–¶–ò–ò                       ‚îÇ
‚îÇ  ‚ñº –ü—Ä–µ–ø–æ—Ä—ä–∫–∏ (5-10 —Ç–æ—á–∫–∏)              ‚îÇ
‚îÇ  ‚ñº –ó–∞–±—Ä–∞–Ω–µ–Ω–∏ –•—Ä–∞–Ω–∏ (5-10 —Ç–æ—á–∫–∏)        ‚îÇ
‚îÇ  ‚ñº –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –°—ä–≤–µ—Ç–∏ (3-5 —Ç–æ—á–∫–∏)   ‚îÇ
‚îÇ  ‚ñº –î–æ–±–∞–≤–∫–∏ (3-5 —Ç–æ—á–∫–∏ —Å –¥–æ–∑–∏—Ä–æ–≤–∫–∏)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  FLOATING CHAT BUTTON                   ‚îÇ
‚îÇ  üí¨ (–¥–æ–ª—É –≤–¥—è—Å–Ω–æ)                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### –î–µ–Ω –ù–∞–≤–∏–≥–∞—Ü–∏—è

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç:**
- 7 —á–∏–ø –±—É—Ç–æ–Ω–∞ (–î–µ–Ω 1, –î–µ–Ω 2, ... –î–µ–Ω 7)
- –ê–∫—Ç–∏–≤–Ω–∏—è—Ç –¥–µ–Ω –µ –ø–æ–¥—á–µ—Ä—Ç–∞–Ω —Å —Ü–≤—è—Ç
- –ü—Ä–∏ –∫–ª–∏–∫ —Å–µ –∑–∞—Ä–µ–∂–¥–∞—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞ –∏–∑–±—Ä–∞–Ω–∏—è –¥–µ–Ω
- Smooth scroll –¥–æ —Å–µ–∫—Ü–∏—è—Ç–∞ —Å —Ö—Ä–∞–Ω–µ–Ω–∏—è

**–ö–æ–¥:**
```javascript
function showDay(dayNumber) {
    currentDay = dayNumber;
    
    // –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞ –∞–∫—Ç–∏–≤–Ω–∏—è —á–∏–ø
    document.querySelectorAll('.day-chip').forEach(chip => {
        chip.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // –†–µ–Ω–¥–∏—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞ –¥–µ–Ω—è
    renderMeals(dayNumber);
}
```

#### Meal Cards

**–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–∞ –∫–∞—Ä—Ç–∞—Ç–∞:**
- –¢–∏–ø —Ö—Ä–∞–Ω–µ–Ω–µ (–∏–∫–æ–Ω–∞ + —Ç–µ–∫—Å—Ç): üç≥ –ó–∞–∫—É—Å–∫–∞, üçΩÔ∏è –û–±—è–¥ –∏ —Ç.–Ω.
- –í—Ä–µ–º–µ: 08:00, 13:00, 19:30
- –ö–∞–ª–æ—Ä–∏–∏: 580 cal
- –ò–º–µ –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ—Ç–æ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω–æ —Å ‚Ä¢)
- –ë—É—Ç–æ–Ω "–í–∏–∂ –î–µ—Ç–∞–π–ª–∏"

**–ü—Ä–∏ –∫–ª–∏–∫ –Ω–∞ "–í–∏–∂ –î–µ—Ç–∞–π–ª–∏":**
–û—Ç–≤–∞—Ä—è —Å–µ –º–æ–¥–∞–ª –ø—Ä–æ–∑–æ—Ä–µ—Ü —Å:
- –ü—ä–ª–Ω–æ –∏–º–µ
- –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –ø—Ä–∏–≥–æ—Ç–≤—è–Ω–µ (–¥–µ—Ç–∞–π–ª–Ω–æ)
- –¢–µ–≥–ª–æ (450g)
- –ü–æ–ª–∑–∏ –∑–∞ –∑–¥—Ä–∞–≤–µ—Ç–æ
- –ú–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–∏ (–ø—Ä–æ—Ç–µ–∏–Ω–∏, –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏, –º–∞–∑–Ω–∏–Ω–∏, —Ñ–∏–±—Ä–∏) - –≤–∏–∑—É–∞–ª–Ω–∏ –ø—Ä–æ–≥—Ä–µ—Å –±–∞—Ä–∏

**–ö–æ–¥:**
```javascript
function showMealModal(meal) {
    document.getElementById('modal-meal-name').innerHTML = meal.name.replace(/\n/g, '<br>');
    document.getElementById('modal-description').innerHTML = meal.description.replace(/\n/g, '<br>');
    document.getElementById('modal-weight').textContent = meal.weight;
    document.getElementById('modal-benefits').textContent = meal.benefits;
    document.getElementById('modal-calories').textContent = meal.calories;
    // –ú–∞–∫—Ä–æ—Å–∏ —Å –ø—Ä–æ–≥—Ä–µ—Å –±–∞—Ä–∏
    updateMacroBar('protein', meal.macros.protein, 50); // 50g = max –∑–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
    updateMacroBar('carbs', meal.macros.carbs, 100);
    updateMacroBar('fats', meal.macros.fats, 30);
    
    // –ü–æ–∫–∞–∑–≤–∞ –º–æ–¥–∞–ª–∞
    document.getElementById('meal-modal').classList.add('active');
}
```

#### Accordion –°–µ–∫—Ü–∏–∏

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∏:**
- –°–ø–∏—Å—ä–∫ –æ—Ç 5-10 —Ö—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏
- –í—Å—è–∫–∞ —Å ‚úì –∏–∫–æ–Ω–∞
- –ü—Ä–∏–º–µ—Ä–∏: "–ú–∞–∑–Ω–∞ —Ä–∏–±–∞ 3x/—Å–µ–¥–º–∏—Ü–∞", "–õ–∏—Å—Ç–Ω–∏ –∑–µ–ª–µ–Ω—á—É—Ü–∏ –≤—Å–µ–∫–∏ –¥–µ–Ω"

**–ó–∞–±—Ä–∞–Ω–µ–Ω–∏ –•—Ä–∞–Ω–∏:**
- –°–ø–∏—Å—ä–∫ –æ—Ç 5-10 —Ö—Ä–∞–Ω–∏ –∑–∞ –∏–∑–±—è–≥–≤–∞–Ω–µ
- –í—Å—è–∫–∞ —Å ‚úó –∏–∫–æ–Ω–∞
- –ü—Ä–∏–º–µ—Ä–∏: "–ë—è–ª —Ö–ª—è–± –∏ —Å–ª–∞–¥–∫–∏—à–∏", "–ó–∞—Ö–∞—Ä–æ—Å–∞–Ω–∏ –Ω–∞–ø–∏—Ç–∫–∏"

**–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –°—ä–≤–µ—Ç–∏:**
- 3-5 —Å—ä–≤–µ—Ç–∞ –∑–∞ –µ–º–æ—Ü–∏–æ–Ω–∞–ª–Ω–æ —Ö—Ä–∞–Ω–µ–Ω–µ
- –ë–∞–∑–∏—Ä–∞–Ω–∏ –Ω–∞ —Ç—Ä–∏–≥–µ—Ä–∏—Ç–µ –æ—Ç –≤—ä–ø—Ä–æ—Å–Ω–∏–∫–∞
- –ü—Ä–∏–º–µ—Ä–∏: "–í–æ–¥–∏ –¥–Ω–µ–≤–Ω–∏–∫ –Ω–∞ –µ–º–æ—Ü–∏–∏—Ç–µ", "–ü—Ä–∞–∫—Ç–∏–∫—É–≤–∞–π 20-–º–∏–Ω—É—Ç–Ω–æ –∑–∞–±–∞–≤—è–Ω–µ"

**–î–æ–±–∞–≤–∫–∏:**
- 3-5 —Ö—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –¥–æ–±–∞–≤–∫–∏ —Å –¥–æ–∑–∏—Ä–æ–≤–∫–∏
- –í—Ä–µ–º–µ –Ω–∞ –ø—Ä–∏–µ–º–∞–Ω–µ (—Å—É—Ç—Ä–∏–Ω/–≤–µ—á–µ—Ä)
- –û–±–æ—Å–Ω–æ–≤–∫–∞ (–∑–∞—â–æ —Ç–æ—á–Ω–æ –¢–ò —Å–µ –Ω—É–∂–¥–∞–µ—à –æ—Ç —Ç–∞–∑–∏ –¥–æ–±–∞–≤–∫–∞)

---
## üí¨ –°–¢–™–ü–ö–ê 6: –ß–ê–¢ –ê–°–ò–°–¢–ï–ù–¢

### –§–∞–π–ª: `plan.html` (Chat UI) + `worker.js` (Chat API)

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω AI –∞—Å–∏—Å—Ç–µ–Ω—Ç, –∫–æ–π—Ç–æ:
- –ü–æ–∑–Ω–∞–≤–∞ –ø—ä–ª–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
- –ü–æ–∑–Ω–∞–≤–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏—è —Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–Ω –ø–ª–∞–Ω
- –ü–æ–º–Ω–∏ –∏—Å—Ç–æ—Ä–∏—è—Ç–∞ –Ω–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- –ú–æ–∂–µ –¥–∞ –∫–æ–Ω—Å—É–ª—Ç–∏—Ä–∞ –∏ –¥–∞ –ø—Ä–∞–≤–∏ –ø—Ä–æ–º–µ–Ω–∏ –≤ –ø–ª–∞–Ω–∞

### 6.1. Chat UI

#### –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–∞–Ω–µ

**Floating Chat Button:**
- –§–∏–∫—Å–∏—Ä–∞–Ω –¥–æ–ª—É –≤–¥—è—Å–Ω–æ –Ω–∞ –µ–∫—Ä–∞–Ω–∞
- –í–∏–Ω–∞–≥–∏ –≤–∏–¥–∏–º –ø—Ä–∏ —Å–∫—Ä–æ–ª–∏—Ä–∞–Ω–µ
- –ò–∫–æ–Ω–∞ üí¨ + badge —Å –±—Ä–æ–π –Ω–µ–ø—Ä–æ—á–µ—Ç–µ–Ω–∏ —Å—ä–æ–±—â–µ–Ω–∏—è (–±—ä–¥–µ—â–∞ —Ñ—É–Ω–∫—Ü–∏—è)

**Chat Window:**
- –ò–∑–ø–ª—É–≤–∞ –æ—Ç–¥–æ–ª—É –ø—Ä–∏ –∫–ª–∏–∫ –Ω–∞ –±—É—Ç–æ–Ω–∞
- –ó–∞–µ–º–∞ 80% –æ—Ç –µ–∫—Ä–∞–Ω–∞ (mobile) –∏–ª–∏ 400px —à–∏—Ä–æ—á–∏–Ω–∞ (desktop)
- Sticky header —Å –±—É—Ç–æ–Ω –∑–∞ –∑–∞—Ç–≤–∞—Ä—è–Ω–µ
- Scrollable chat –∏—Å—Ç–æ—Ä–∏—è
- Fixed footer —Å —Ç–µ–∫—Å—Ç–æ–≤–æ –ø–æ–ª–µ –∏ –±—É—Ç–æ–Ω "–ò–∑–ø—Ä–∞—Ç–∏"

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CHAT HEADER                    ‚îÇ
‚îÇ  AI –î–∏–µ—Ç–æ–ª–æ–≥          [X Close] ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CHAT MESSAGES (scrollable)     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ AI: –ó–¥—Ä–∞–≤–µ–π –ú–∞—Ä–∏—è!        ‚îÇ ‚îÇ
‚îÇ  ‚îÇ –ö–∞–∫ –º–æ–≥–∞ –¥–∞ –ø–æ–º–æ–≥–Ω–∞?      ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ         ‚îÇ USER: –ú–æ–∂–µ –ª–∏ –¥–∞  ‚îÇ  ‚îÇ
‚îÇ         ‚îÇ —è–º –±–∞–Ω–∞–Ω–∏?        ‚îÇ  ‚îÇ
‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ AI: –ë–∞–Ω–∞–Ω–∏—Ç–µ —Å–∞ —á—É–¥–µ—Å–µ–Ω   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ –∏–∑–±–æ—Ä –∑–∞ –µ–Ω–µ—Ä–≥–∏—è...       ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CHAT FOOTER                    ‚îÇ
‚îÇ  [–í—ä–≤–µ–¥–∏ —Å—ä–æ–±—â–µ–Ω–∏–µ... ] [–ò–∑–ø—Ä–∞—Ç–∏]‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç

**–ü—Ä–∏ –æ—Ç–≤–∞—Ä—è–Ω–µ:**
```javascript
function openChat() {
    // –ó–∞—Ä–µ–∂–¥–∞ –∏—Å—Ç–æ—Ä–∏—è –æ—Ç localStorage
    const chatHistory = JSON.parse(localStorage.getItem('chatHistory') || '[]');
    renderChatHistory(chatHistory);
    
    // –ü–æ–∫–∞–∑–≤–∞ chat window
    document.getElementById('chat-window').classList.add('active');
    
    // –§–æ–∫—É—Å–∏—Ä–∞ input –ø–æ–ª–µ—Ç–æ
    document.getElementById('chat-input').focus();
}
```

**–ü—Ä–∏ –∏–∑–ø—Ä–∞—â–∞–Ω–µ –Ω–∞ —Å—ä–æ–±—â–µ–Ω–∏–µ:**
```javascript
async function sendMessage() {
    const message = document.getElementById('chat-input').value.trim();
    if (!message) return;
    
    // –î–æ–±–∞–≤—è user message –∫—ä–º UI
    appendMessage('user', message);
    
    // –ò–∑—á–∏—Å—Ç–≤–∞ input
    document.getElementById('chat-input').value = '';
    
    // –ü–æ–∫–∞–∑–≤–∞ "–ø–∏—à–µ..." –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
    showTypingIndicator();
    
    // –ò–∑–ø—Ä–∞—â–∞ –∫—ä–º backend
    const response = await fetch('https://aidiet.radilov-k.workers.dev/api/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            message: message,
            userData: JSON.parse(localStorage.getItem('userData')),
            userPlan: JSON.parse(localStorage.getItem('dietPlan')),
            conversationHistory: JSON.parse(localStorage.getItem('chatHistory') || '[]'),
            mode: 'consultation' // –∏–ª–∏ 'modification'
        })
    });
    
    const data = await response.json();
    
    // –°–∫—Ä–∏–≤–∞ "–ø–∏—à–µ..." –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
    hideTypingIndicator();
    
    // –î–æ–±–∞–≤—è AI response –∫—ä–º UI
    appendMessage('assistant', data.response);
    
    // –ê–∫–æ –ø–ª–∞–Ω—ä—Ç –µ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω
    if (data.planUpdated) {
        localStorage.setItem('dietPlan', JSON.stringify(data.updatedPlan));
        showNotification('–ü–ª–∞–Ω—ä—Ç –µ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω! –ü—Ä–µ–∑–∞—Ä–µ–¥–µ—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞.');
    }
    
    // –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞ chat history
    const updatedHistory = data.conversationHistory;
    localStorage.setItem('chatHistory', JSON.stringify(updatedHistory));
}
```

---

### 6.2. Chat API (Backend)

**Endpoint:** `POST /api/chat`
**–§–∞–π–ª:** `worker.js` —Ñ—É–Ω–∫—Ü–∏—è `handleChat()`

#### Request Payload

```json
{
  "message": "–ú–æ–∂–µ –ª–∏ –¥–∞ —è–º –±–∞–Ω–∞–Ω–∏ –≤—Å–µ–∫–∏ –¥–µ–Ω?",
  "userData": { /* –ø—ä–ª–µ–Ω –æ–±–µ–∫—Ç –æ—Ç –≤—ä–ø—Ä–æ—Å–Ω–∏–∫–∞ */ },
  "userPlan": { /* –ø—ä–ª–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω –ø–ª–∞–Ω */ },
  "conversationHistory": [
    { "role": "user", "content": "..." },
    { "role": "assistant", "content": "..." }
  ],
  "mode": "consultation"
}
```

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û:** Backend –µ STATELESS - –≤—Å–∏—á–∫–∏ –¥–∞–Ω–Ω–∏ –∏–¥–≤–∞—Ç –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞!

#### –î–≤–∞ –†–µ–∂–∏–º–∞ –Ω–∞ –†–∞–±–æ—Ç–∞

**1. Consultation Mode** (—Ä–µ–∂–∏–º –∫–æ–Ω—Å—É–ª—Ç–∞—Ü–∏—è):
- AI –¥–∞–≤–∞ —Å—ä–≤–µ—Ç–∏, –æ—Ç–≥–æ–≤–∞—Ä—è –Ω–∞ –≤—ä–ø—Ä–æ—Å–∏
- –ù–ï –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–∞ –ø–ª–∞–Ω–∞
- –ú–æ–∂–µ –¥–∞ –æ–±—è—Å–Ω—è–≤–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è, –∞–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏, —Å—ä–≤–µ—Ç–∏ –∑–∞ –ø—Ä–∏–≥–æ—Ç–≤—è–Ω–µ
- Prompt: `admin_consultation_prompt`

**2. Modification Mode** (—Ä–µ–∂–∏–º –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è):
- AI –º–æ–∂–µ –¥–∞ –ø—Ä–µ–¥–ª–æ–∂–∏ –ø—Ä–æ–º–µ–Ω–∏ –≤ –ø–ª–∞–Ω–∞
- –ú–æ–∂–µ –¥–∞ –∏–∑–ø—Ä–∞—Ç–∏ `[REGENERATE_PLAN:...]` –∫–æ–º–∞–Ω–¥–∞
- –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞ —Ö—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏—è –ø–ª–∞–Ω —Å –Ω–æ–≤–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
- Prompt: `admin_modification_prompt`

#### AI Context Building

```javascript
// –ü—ä–ª–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞ AI (2000 tokens max)
const baseContext = `
–¢–∏ —Å–∏ –ª–∏—á–µ–Ω –¥–∏–µ—Ç–æ–ª–æ–≥ –∏ –∑–¥—Ä–∞–≤–µ–Ω –∫–æ–Ω—Å—É–ª—Ç–∞–Ω—Ç –∑–∞ ${userData.name}.

–ö–õ–ò–ï–ù–¢–°–ö–ò –ü–†–û–§–ò–õ:
- –ü–æ–ª: ${userData.gender}, –í—ä–∑—Ä–∞—Å—Ç: ${userData.age} –≥–æ–¥–∏–Ω–∏
- –¢–µ–≥–ª–æ: ${userData.weight} –∫–≥, –†—ä—Å—Ç: ${userData.height} —Å–º
- –¶–µ–ª: ${userData.goal}
- –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏ —Å—ä—Å—Ç–æ—è–Ω–∏—è: ${userData.medicalConditions.join(', ')}
- –•—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è: ${userData.dietPreference.join(', ')}
- –ù–µ—Ö–∞—Ä–µ—Å–≤–∞–Ω–∏ —Ö—Ä–∞–Ω–∏: ${userData.dietDislike}
/* ... –æ—â–µ –¥–µ—Ç–∞–π–ª–∏ */

–¢–ï–ö–£–© –•–†–ê–ù–ò–¢–ï–õ–ï–ù –ü–õ–ê–ù:
- –ü—Ä–µ–ø–æ—Ä—ä—á–∞–Ω–∏ –∫–∞–ª–æ—Ä–∏–∏: ${userPlan.analysis.recommendedCalories} cal/–¥–µ–Ω
- –ú–∞–∫—Ä–æ—Å–∏: ${userPlan.analysis.macroGrams.protein}g –ø—Ä–æ—Ç–µ–∏–Ω–∏, ${userPlan.analysis.macroGrams.carbs}g –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏, ${userPlan.analysis.macroGrams.fats}g –º–∞–∑–Ω–∏–Ω–∏
- Dietary modifier: ${userPlan.strategy.dietaryModifier}
- –ë—Ä–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è: ${userPlan.analysis.weeklyBlueprint.dailyMealCount}
/* ... –æ—â–µ –¥–µ—Ç–∞–π–ª–∏ –æ—Ç –ø–ª–∞–Ω–∞ */

–ò–°–¢–û–†–ò–Ø –ù–ê –†–ê–ó–ì–û–í–û–†–ê:
${conversationHistory.map(h => `${h.role}: ${h.content}`).join('
')}

–¢–ï–ö–£–© –í–™–ü–†–û–°:
user: ${message}
`;
```

#### History Trimming (Token Management)

```javascript
// –ú–∞–∫—Å–∏–º—É–º 2000 tokens –∑–∞ –∏—Å—Ç–æ—Ä–∏—è
const MAX_HISTORY_TOKENS = 2000;

function trimConversationHistory(history) {
    let trimmedHistory = [];
    let totalTokens = 0;
    
    // –û–±—Ö–æ–∂–¥–∞ –≤ –æ–±—Ä–∞—Ç–µ–Ω —Ä–µ–¥ (–ø–∞–∑–∏ –Ω–∞–π-–Ω–æ–≤–∏—Ç–µ)
    for (let i = history.length - 1; i >= 0; i--) {
        const messageTokens = estimateTokens(history[i].content);
        
        if (totalTokens + messageTokens <= MAX_HISTORY_TOKENS) {
            trimmedHistory.unshift(history[i]);
            totalTokens += messageTokens;
        } else {
            break; // –°–ø–∏—Ä–∞ –ø—Ä–∏ –¥–æ—Å—Ç–∏–≥–∞–Ω–µ –Ω–∞ –ª–∏–º–∏—Ç–∞
        }
    }
    
    return trimmedHistory;
}
```

#### Plan Regeneration Detection

–ê–∫–æ AI –æ—Ç–≥–æ–≤–æ—Ä—ä—Ç —Å—ä–¥—ä—Ä–∂–∞ `[REGENERATE_PLAN:...]`, —Å–∏—Å—Ç–µ–º–∞—Ç–∞ –ø–∞—Ä—Å–≤–∞ JSON –∏ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞ –ø–ª–∞–Ω–∞:

```javascript
const regenerateIndex = aiResponse.indexOf('[REGENERATE_PLAN:');

if (regenerateIndex !== -1 && mode === 'modification') {
    // –ü–∞—Ä—Å–≤–∞ JSON
    const jsonStart = regenerateIndex + '[REGENERATE_PLAN:'.length;
    const jsonEnd = aiResponse.indexOf(']', jsonStart) + 1;
    const modificationsJSON = aiResponse.substring(jsonStart, jsonEnd);
    const modifications = JSON.parse(modificationsJSON);
    
    // –ü—Ä–∏–ª–∞–≥–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫—ä–º userData
    let modifiedUserData = { ...userData };
    
    modifications.modifications.forEach(mod => {
        if (mod === '3_meals_per_day') {
            // –ó–∞–¥–∞–≤–∞ 3 —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ –¥–µ–Ω
        } else if (mod === 'vegetarian') {
            modifiedUserData.dietPreference = ['–í–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∞'];
        } else if (mod.startsWith('exclude_food:')) {
            const food = mod.split(':')[1];
            modifiedUserData.dietDislike += `, ${food}`;
        }
        // ... –¥—Ä—É–≥–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
    });
    
    // –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞ –ø–ª–∞–Ω–∞ —Å –Ω–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω–∏
    const newPlan = await generatePlanMultiStep(env, modifiedUserData);
    
    planWasUpdated = true;
    updatedPlan = newPlan;
}
```

**Supported Modifications:**
- `no_intermediate_meals` - –°–∞–º–æ –æ—Å–Ω–æ–≤–Ω–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- `3_meals_per_day` / `4_meals_per_day` - –ö–æ–Ω–∫—Ä–µ—Ç–µ–Ω –±—Ä–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è
- `vegetarian` / `no_dairy` / `low_carb` / `increase_protein` - –î–∏–µ—Ç–∏—á–Ω–∏ –ø—Ä–æ–º–µ–Ω–∏
- `exclude_food:–∏–º–µ` - –ò–∑–∫–ª—é—á–≤–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞ —Ö—Ä–∞–Ω–∞

#### Response Format

```json
{
  "success": true,
  "response": "–ë–∞–Ω–∞–Ω–∏—Ç–µ —Å–∞ —á—É–¥–µ—Å–µ–Ω –∏–∑–±–æ—Ä –∑–∞ –µ–Ω–µ—Ä–≥–∏—è –ø—Ä–µ–¥–∏ –∏–ª–∏ —Å–ª–µ–¥ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞. –°—ä–¥—ä—Ä–∂–∞—Ç –±—ä—Ä–∑–∏ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏ –∏ –∫–∞–ª–∏–π. –ó–∞ —Ç–≤–æ—è—Ç–∞ —Ü–µ–ª (–æ—Ç—Å–ª–∞–±–≤–∞–Ω–µ), –ø—Ä–µ–ø–æ—Ä—ä—á–≤–∞–º 1 –±–∞–Ω–∞–Ω –¥–Ω–µ–≤–Ω–æ, –∂–µ–ª–∞—Ç–µ–ª–Ω–æ —Å—É—Ç—Ä–∏–Ω –∏–ª–∏ –ø—Ä–µ–¥–∏ –æ–±—è–¥. –ò–∑–±—è–≥–≤–∞–π –≥–∏ –≤–µ—á–µ—Ä –∑–∞—Ä–∞–¥–∏ –ø–æ-–≤–∏—Å–æ–∫–∏—è –≥–ª–∏–∫–µ–º–∏—á–µ–Ω –∏–Ω–¥–µ–∫—Å.",
  "conversationHistory": [
    { "role": "user", "content": "–ú–æ–∂–µ –ª–∏ –¥–∞ —è–º –±–∞–Ω–∞–Ω–∏ –≤—Å–µ–∫–∏ –¥–µ–Ω?" },
    { "role": "assistant", "content": "–ë–∞–Ω–∞–Ω–∏—Ç–µ —Å–∞ —á—É–¥–µ—Å–µ–Ω –∏–∑–±–æ—Ä..." }
  ],
  "planUpdated": false,
  "updatedPlan": null
}
```

**–ê–∫–æ –ø–ª–∞–Ω—ä—Ç –µ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω:**
```json
{
  "success": true,
  "response": "–†–∞–∑–±–∏—Ä–∞–º! –ü—Ä–æ–º–µ–Ω—è–º –ø–ª–∞–Ω–∞ —Ç–∏ –Ω–∞ 3 —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ –¥–µ–Ω –±–µ–∑ –∑–∞–∫—É—Å–∫–∏. [REGENERATE_PLAN:{"modifications":["3_meals_per_day","no_intermediate_meals"]}] –ì–æ—Ç–æ–≤–æ! –ù–æ–≤–∏—è—Ç –ø–ª–∞–Ω –µ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω.",
  "conversationHistory": [ /* –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è */ ],
  "planUpdated": true,
  "updatedPlan": { /* –Ω–æ–≤ –ø—ä–ª–µ–Ω –ø–ª–∞–Ω */ }
}
```

---
## üìä –°–¢–†–£–ö–¢–£–†–ò –ù–ê –î–ê–ù–ù–ò

### –ü—ä–ª–Ω–∞ –°—Ö–µ–º–∞ –Ω–∞ userData (–æ—Ç –≤—ä–ø—Ä–æ—Å–Ω–∏–∫)

```javascript
{
  // –°–ï–ö–¶–ò–Ø 1: –û—Å–Ω–æ–≤–Ω–∏ –¥–∞–Ω–Ω–∏
  "name": "–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞",              // String - –ò–º–µ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
  "gender": "–ñ–µ–Ω–∞",                     // "–ú—ä–∂" | "–ñ–µ–Ω–∞"
  "age": 35,                            // Number - –≥–æ–¥–∏–Ω–∏
  "height": 165,                        // Number - —Å–º
  "weight": 78,                         // Number - –∫–≥
  "email": "maria@example.com",         // String (optional)
  "goal": "–û—Ç—Å–ª–∞–±–≤–∞–Ω–µ",                 // String - –æ—Å–Ω–æ–≤–Ω–∞ —Ü–µ–ª
  "lossKg": 10,                         // Number (conditional) - –∂–µ–ª–∞–Ω–∏ –∫–≥ –∑–∞ —Å–≤–∞–ª—è–Ω–µ
  
  // –°–ï–ö–¶–ò–Ø 2: –°—ä–Ω, —Ä–∏—Ç—ä–º –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç
  "sleepHours": "6-7h",                 // String - —á–∞—Å–æ–≤–µ —Å—ä–Ω
  "sleepInterrupt": "–î–∞",               // "–î–∞" | "–ù–µ" - –ø—Ä–µ–∫—ä—Å–≤–∞–Ω–∏—è
  "chronotype": "–°—É—Ç—Ä–µ—à–µ–Ω",             // "–°—É—Ç—Ä–µ—à–µ–Ω" | "–í–µ—á–µ—Ä–µ–Ω" | "–ù–µ—É—Ç—Ä–∞–ª–µ–Ω"
  "dailyActivityLevel": "–°—Ä–µ–¥–Ω–∞",       // "–ù–∏—Å–∫–∞" | "–°—Ä–µ–¥–Ω–∞" | "–í–∏—Å–æ–∫–∞"
  "stressLevel": "–í–∏—Å–æ–∫–æ",              // "–ù–∏—Å–∫–æ" | "–°—Ä–µ–¥–Ω–æ" | "–í–∏—Å–æ–∫–æ"
  "sportActivity": "1-2 –ø—ä—Ç–∏ —Å–µ–¥–º–∏—á–Ω–æ", // String - —á–µ—Å—Ç–æ—Ç–∞ –Ω–∞ —Å–ø–æ—Ä—Ç
  
  // –°–ï–ö–¶–ò–Ø 3: –ü—Ä–∏–µ–º –Ω–∞ —Ç–µ—á–Ω–æ—Å—Ç–∏
  "waterIntake": "1-2–ª",                // String - –ª–∏—Ç—Ä–∏ –≤–æ–¥–∞ –¥–Ω–µ–≤–Ω–æ
  "drinksSweet": "–†—è–¥–∫–æ",               // "–ù–∏–∫–æ–≥–∞" | "–†—è–¥–∫–æ" | "–ß–µ—Å—Ç–æ" | "–ú–Ω–æ–≥–æ —á–µ—Å—Ç–æ"
  "drinksAlcohol": "–†—è–¥–∫–æ",             // "–ù–∏–∫–æ–≥–∞" | "–†—è–¥–∫–æ" | "–ß–µ—Å—Ç–æ" | "–ú–Ω–æ–≥–æ —á–µ—Å—Ç–æ"
  
  // –°–ï–ö–¶–ò–Ø 4: –•—Ä–∞–Ω–µ–Ω–µ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
  "weightChange": "–ô–æ-–π–æ –µ—Ñ–µ–∫—Ç",        // String - —Ç–∏–ø –ø—Ä–æ–º—è–Ω–∞ –≤ —Ç–µ–≥–ª–æ—Ç–æ
  "weightChangeDetails": "–ü—Ä–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 5 –≥–æ–¥–∏–Ω–∏ —Ç–µ–≥–ª–æ—Ç–æ –º–∏ —Å–µ –∫–æ–ª–µ–±–∞–µ —Å 5-10 –∫–≥", // String (conditional)
  "dietHistory": "–î–∞",                  // "–î–∞" | "–ù–µ"
  "dietType": "–ö–µ—Ç–æ –¥–∏–µ—Ç–∞, –ò–Ω—Ç–µ—Ä–≤–∞–ª–Ω–æ –≥–ª–∞–¥—É–≤–∞–Ω–µ", // String (conditional)
  "dietResult": "–û—Ç–Ω–∞—á–∞–ª–æ —Å–≤–∞–ª–∏—Ö 8 –∫–≥, –Ω–æ –ø–æ—Å–ª–µ –≥–∏ –≤—ä—Ä–Ω–∞—Ö –æ–±—Ä–∞—Ç–Ω–æ", // String (conditional)
  "overeatingFrequency": "–ü–æ–Ω—è–∫–æ–≥–∞",    // String - —á–µ—Å—Ç–æ—Ç–∞ –Ω–∞ –ø—Ä–µ—è–∂–¥–∞–Ω–µ
  "foodCravings": ["–°–ª–∞–¥–∫–æ", "–í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏"], // Array - –∂–µ–ª–∞–Ω–∏—è –∑–∞ —Ö—Ä–∞–Ω–∞
  "foodTriggers": ["–°—Ç—Ä–µ—Å", "–ï–º–æ—Ü–∏–∏ (—Ç—ä–≥–∞, –≥–Ω—è–≤)"], // Array - —Ç—Ä–∏–≥–µ—Ä–∏ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ
  "eatingHabits": ["–ó–∞–∫—É—Å–∫–∞ –≤—Å–µ–∫–∏ –¥–µ–Ω", "–•—Ä–∞–Ω–∞ –ø—Ä–µ–¥ –µ–∫—Ä–∞–Ω", "–ë—ä—Ä–∑–æ —Ö—Ä–∞–Ω–µ–Ω–µ"], // Array
  "compensationMethods": ["–ò–Ω—Ç–µ–Ω–∑–∏–≤–µ–Ω —Å–ø–æ—Ä—Ç", "–ù–µ –∫–æ–º–ø–µ–Ω—Å–∏—Ä–∞–º"], // Array
  "socialComparison": "–ü–æ–Ω—è–∫–æ–≥–∞",       // String - —á–µ—Å—Ç–æ—Ç–∞ –Ω–∞ —Å–æ—Ü–∏–∞–ª–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
  
  // –°–ï–ö–¶–ò–Ø 5: –•—Ä–∞–Ω–∏—Ç–µ–ª–Ω–∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è
  "dietPreference": ["–í—Å–∏—á–∫–æ"],         // Array - —Ç–∏–ø –¥–∏–µ—Ç–∞
  "dietDislike": "–ö–∏—Å–µ–ª–æ—Ç–æ –º–ª—è–∫–æ, –∫–∞—Ä—Ñ–∏–æ–ª", // String - –Ω–µ—Ö–∞—Ä–µ—Å–≤–∞–Ω–∏/–∞–ª–µ—Ä–≥–∏—á–Ω–∏ —Ö—Ä–∞–Ω–∏
  "dietLove": "–®–æ–∫–æ–ª–∞–¥, –ø–∞—Å—Ç–∞, –ø–∏—Ü–∞",   // String - –ª—é–±–∏–º–∏ —Ö—Ä–∞–Ω–∏
  
  // –°–ï–ö–¶–ò–Ø 6: –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ
  "medicalConditions": ["PCOS", "–•–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º"], // Array - –∑–∞–±–æ–ª—è–≤–∞–Ω–∏—è
  "medicalConditions_PCOS": "–î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ü–∏—Ä–∞–Ω –ø—Ä–µ–¥–∏ 3 –≥–æ–¥–∏–Ω–∏", // String (detail field)
  "medications": "–î–∞",                  // "–î–∞" | "–ù–µ"
  "medicationsDetails": "–õ-—Ç–∏—Ä–æ–∫—Å–∏–Ω 50 –º–∫–≥ —Å—É—Ç—Ä–∏–Ω", // String (conditional)
  
  // –°–ï–ö–¶–ò–Ø 7: –î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
  "additionalNotes": "–†–∞–±–æ—Ç—è –æ—Ç –æ—Ñ–∏—Å, —Å–µ–¥—è –ø–æ 8-9 —á–∞—Å–∞ –Ω–∞ –¥–µ–Ω" // String (optional)
}
```

---

### –ü—ä–ª–Ω–∞ –°—Ö–µ–º–∞ –Ω–∞ dietPlan (–≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω –ø–ª–∞–Ω)

```javascript
{
  // –î–ù–ï–í–ù–ò –ü–õ–ê–ù–û–í–ï (7 –¥–Ω–∏)
  "day1": {
    "meals": [
      {
        "type": "–û–±—è–¥",                 // String - —Ç–∏–ø —Ö—Ä–∞–Ω–µ–Ω–µ
        "time": "13:00",                // String - –≤—Ä–µ–º–µ
        "name": "‚Ä¢ –®–æ–ø—Å–∫–∞ —Å–∞–ª–∞—Ç–∞\n‚Ä¢ –ü–∏–ª–µ—à–∫–∏ –≥—ä—Ä–¥–∏ –Ω–∞ —Å–∫–∞—Ä–∞ —Å –∫–∞—Ä—Ç–æ—Ñ–µ–Ω–æ –ø—é—Ä–µ\n‚Ä¢ –•–ª—è–±: 1 —Ñ–∏–ª–∏—è –ø—ä–ª–Ω–æ–∑—ä—Ä–Ω–µ—Å—Ç", // String (multi-line)
        "weight": "450g",               // String - —Ç–µ–≥–ª–æ
        "description": "‚Ä¢ –®–æ–ø—Å–∫–∞ —Å–∞–ª–∞—Ç–∞ –æ—Ç –¥–æ–º–∞—Ç–∏, –∫—Ä–∞—Å—Ç–∞–≤–∏—Ü–∏, —á—É—à–∫–∏, —Å–∏—Ä–µ–Ω–µ –∏ –º–∞—Å–ª–∏–Ω–∏ —Å –º–∞–ª–∫–æ –∑–µ—Ö—Ç–∏–Ω.\n‚Ä¢ –ü–∏–ª–µ—à–∫–∏—Ç–µ –≥—ä—Ä–¥–∏ (150g) —Å–µ –ø—Ä–∏–≥–æ—Ç–≤—è—Ç –Ω–∞ —Å–∫–∞—Ä–∞ 6-8 –º–∏–Ω—É—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∞ –ø—Ä–∏ 200¬∞C, –ø–æ–¥–ø—Ä–∞–≤–µ–Ω–∏ —Å—ä—Å —Å–æ–ª, —á–µ—Ä–µ–Ω –ø–∏–ø–µ—Ä –∏ —Ä–∏–≥–∞–Ω.\n‚Ä¢ –ö–∞—Ä—Ç–æ—Ñ–µ–Ω–æ—Ç–æ –ø—é—Ä–µ (150g) –æ—Ç —Å–≤–∞—Ä–µ–Ω–∏ –∫–∞—Ä—Ç–æ—Ñ–∏, —Å–º–µ—Å–µ–Ω–∏ —Å 50ml –æ–±–µ–∑–º–∞—Å–ª–µ–Ω–æ –º–ª—è–∫–æ.\n‚Ä¢ 1 —Ñ–∏–ª–∏—è (30g) –ø—ä–ª–Ω–æ–∑—ä—Ä–Ω–µ—Å—Ç —Ö–ª—è–±.", // String (detailed)
        "benefits": "–ü–∏–ª–µ—à–∫–æ—Ç–æ –æ—Å–∏–≥—É—Ä—è–≤–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω –ø—Ä–æ—Ç–µ–∏–Ω –∑–∞ –º—É—Å–∫—É–ª–Ω–∞ –º–∞—Å–∞ –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª–Ω–∏ –º–∞–∑–Ω–∏–Ω–∏. –ö–∞—Ä—Ç–æ—Ñ–∏—Ç–µ –¥–∞–≤–∞—Ç –±–∞–≤–Ω–∏ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏ –∑–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –µ–Ω–µ—Ä–≥–∏—è —Å–ª–µ–¥ –æ–±—è–¥. –°–∞–ª–∞—Ç–∞—Ç–∞ –¥–æ–±–∞–≤—è —Ñ–∏–±—Ä–∏ –∏ –≤–∏—Ç–∞–º–∏–Ω–∏.", // String
        "calories": 580,                // Number
        "macros": {
          "protein": 48,                // Number - –≥—Ä–∞–º–æ–≤–µ
          "carbs": 52,                  // Number - –≥—Ä–∞–º–æ–≤–µ
          "fats": 16,                   // Number - –≥—Ä–∞–º–æ–≤–µ
          "fiber": 8                    // Number - –≥—Ä–∞–º–æ–≤–µ
        }
      },
      // ... –æ—â–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è
    ],
    "dailyTotals": {
      "calories": 1650,                 // Number - –æ–±—â–æ –∫–∞–ª–æ—Ä–∏–∏ –∑–∞ –¥–µ–Ω—è
      "protein": 125,                   // Number - –æ–±—â–æ –ø—Ä–æ—Ç–µ–∏–Ω–∏ (g)
      "carbs": 185,                     // Number - –æ–±—â–æ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏ (g)
      "fats": 46                        // Number - –æ–±—â–æ –º–∞–∑–Ω–∏–Ω–∏ (g)
    }
  },
  // "day2" –¥–æ "day7" —Å—ä—Å —Å—ä—â–∞—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
  
  // –ê–ù–ê–õ–ò–ó (–æ—Ç AI Step 1)
  "analysis": {
    "bmr": 1420,                        // Number - –±–∞–∑–æ–≤ –º–µ—Ç–∞–±–æ–ª–∏–∑—ä–º (cal/–¥–µ–Ω)
    "tdee": 2050,                       // Number - –¥–Ω–µ–≤–Ω–∞ –∫–æ–Ω—Å—É–º–∞—Ü–∏—è (cal/–¥–µ–Ω)
    "recommendedCalories": 1650,        // Number - —Ü–µ–ª–µ–≤–∏ –∫–∞–ª–æ—Ä–∏–∏
    "macroRatios": {
      "protein": 30,                    // Number - –ø—Ä–æ—Ü–µ–Ω—Ç
      "carbs": 45,                      // Number - –ø—Ä–æ—Ü–µ–Ω—Ç
      "fats": 25                        // Number - –ø—Ä–æ—Ü–µ–Ω—Ç
    },
    "macroGrams": {
      "protein": 123,                   // Number - –≥—Ä–∞–º–æ–≤–µ –¥–Ω–µ–≤–Ω–æ
      "carbs": 186,                     // Number - –≥—Ä–∞–º–æ–≤–µ –¥–Ω–µ–≤–Ω–æ
      "fats": 46                        // Number - –≥—Ä–∞–º–æ–≤–µ –¥–Ω–µ–≤–Ω–æ
    },
    "weeklyBlueprint": {
      "dailyMealCount": 3,              // Number - –±—Ä–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è/–¥–µ–Ω
      "skipBreakfast": false,           // Boolean - –ø–æ–ª–∏—Ç–∏–∫–∞ –∑–∞ –∑–∞–∫—É—Å–∫–∞
      "dailyStructure": [
        {
          "day": "Monday",
          "mealCount": 3,
          "mealTimes": ["08:00", "13:00", "19:00"]
        },
        // ... 7 –¥–Ω–∏
      ]
    },
    "successChance": 65,                // Number (-100 –¥–æ +100)
    "keyProblems": [
      {
        "title": "–ù–µ–¥–æ—Å—Ç–∞—Ç—ä—á–µ–Ω —Å—ä–Ω (5.5 —á–∞—Å–∞)", // String
        "severity": "Risky",            // "Normal" | "Borderline" | "Risky" | "Critical"
        "impact": "–ù–∞–º–∞–ª—è–≤–∞ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞ —Å 10-15%...", // String (long)
        "solution": "–¶–µ–ª–µ—Ç–µ 7-8 —á–∞—Å–∞ —Å—ä–Ω..." // String
      },
      // ... –æ—â–µ –ø—Ä–æ–±–ª–µ–º–∏
    ]
  },
  
  // –°–¢–†–ê–¢–ï–ì–ò–Ø (–æ—Ç AI Step 2)
  "strategy": {
    "dietaryModifier": "Mediterranean", // String - —Ç–∏–ø –¥–∏–µ—Ç–∞
    "modifierReasoning": "–ë–∞–∑–∏—Ä–∞–Ω–æ –Ω–∞ PCOS –¥–∏–∞–≥–Ω–æ–∑–∞—Ç–∞...", // String (long)
    "welcomeMessage": "–ó–¥—Ä–∞–≤–µ–π –ú–∞—Ä–∏—è! –ù–∞ 35 –≥–æ–¥–∏–Ω–∏...", // String (150-250 –¥—É–º–∏)
    "planJustification": "–¢–æ—á–Ω–æ 1650 –∫–∞–ª–æ—Ä–∏–∏ (–Ω–µ 1200!)...", // String (100+ chars)
    "keyPrinciples": [
      "–ü–æ–ª–æ–≤–∏–Ω —á–∏–Ω–∏—è –∑–µ–ª–µ–Ω—á—É—Ü–∏...",     // Array of Strings
      "–•—Ä–∞–Ω–∏ –±–æ–≥–∞—Ç–∏ –Ω–∞ –æ–º–µ–≥–∞-3...",
      // ... 3-5 –ø—Ä–∏–Ω—Ü–∏–ø–∞
    ],
    "mealTiming": {
      "pattern": "–ü–æ–Ω–µ–¥–µ–ª–Ω–∏–∫-–ü–µ—Ç—ä–∫: –æ–±—è–¥ 12:30...", // String
      "fastingWindows": "16-—á–∞—Å–æ–≤ –Ω–æ—â–µ–Ω –ø–æ—Å—Ç..."     // String
    },
    "supplementRecommendations": [
      "! –ú–∞–≥–Ω–µ–∑–∏–π 300mg –≤–µ—á–µ—Ä (–¢–í–û–Ø–¢–ê –ù–£–ñ–î–ê: ...)", // Array of Strings
      "! –û–º–µ–≥–∞-3 1000mg —Å—É—Ç—Ä–∏–Ω (–¢–í–û–Ø–¢–ê –ù–£–ñ–î–ê: ...)",
      // ... 3-5 –¥–æ–±–∞–≤–∫–∏
    ]
  },
  
  // –û–ë–û–ë–©–ï–ù–ò–ï (–æ—Ç AI Step 4)
  "summary": {
    "bmr": 1420,
    "dailyCalories": 1648,              // Number - —Ä–µ–∞–ª–Ω–∏ —Å—Ä–µ–¥–Ω–∏ –∫–∞–ª–æ—Ä–∏–∏
    "macros": {
      "protein": 124,                   // Number - —Ä–µ–∞–ª–Ω–∏ —Å—Ä–µ–¥–Ω–∏ –ø—Ä–æ—Ç–µ–∏–Ω–∏
      "carbs": 184,
      "fats": 46
    }
  },
  
  // –ü–†–ï–ü–û–†–™–ö–ò
  "recommendations": [
    "–ú–∞–∑–Ω–∞ —Ä–∏–±–∞ (—Å—å–æ–º–≥–∞, —Å–∫—É–º—Ä–∏—è, —Å–∞—Ä–¥–∏–Ω–∏) –º–∏–Ω–∏–º—É–º 3 –ø—ä—Ç–∏ —Å–µ–¥–º–∏—á–Ω–æ...",
    // ... 5-10 –ø—Ä–µ–ø–æ—Ä—ä–∫–∏
  ],
  
  // –ó–ê–ë–†–ê–ù–ï–ù–ò –•–†–ê–ù–ò
  "forbidden": [
    "–ë—è–ª —Ö–ª—è–± –∏ —Å–ª–∞–¥–∫–∏—à–∏ —Å –±—è–ª–æ –±—Ä–∞—à–Ω–æ...",
    // ... 5-10 –∑–∞–±—Ä–∞–Ω–µ–Ω–∏
  ],
  
  // –ü–°–ò–•–û–õ–û–ì–ò–Ø
  "psychology": [
    "–í–æ–¥–∏ –¥–Ω–µ–≤–Ω–∏–∫ –Ω–∞ –µ–º–æ—Ü–∏–∏—Ç–µ...",
    // ... 3-5 —Å—ä–≤–µ—Ç–∞
  ],
  
  // –•–ò–î–†–ê–¢–ê–¶–ò–Ø
  "waterIntake": "–ú–∏–Ω–∏–º—É–º 2.5-3 –ª–∏—Ç—Ä–∞ –≤–æ–¥–∞ –¥–Ω–µ–≤–Ω–æ...", // String
  
  // –î–û–ë–ê–í–ö–ò (–∫–æ–ø–∏–µ –æ—Ç strategy.supplementRecommendations)
  "supplements": [
    "–ú–∞–≥–Ω–µ–∑–∏–π 300mg –≤–µ—á–µ—Ä (1 —á–∞—Å –ø—Ä–µ–¥–∏ –ª—è–≥–∞–Ω–µ)...",
    // ... 3-5 –¥–æ–±–∞–≤–∫–∏
  ],
  
  // –ú–ï–¢–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø
  "_meta": {
    "generatedAt": "2026-02-05T19:30:00.000Z", // ISO timestamp
    "generationTimeSeconds": 45,       // Number - –≤—Ä–µ–º–µ –∑–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ
    "totalTokensUsed": 24500,          // Number - –æ–±—â–æ –∏–∑—Ä–∞–∑—Ö–æ–¥–≤–∞–Ω–∏ —Ç–æ–∫–µ–Ω–∏
    "stepsCompleted": 6,               // Number - –±—Ä–æ–π –∑–∞–≤—ä—Ä—à–µ–Ω–∏ —Å—Ç—ä–ø–∫–∏
    "model": "gpt-4o-mini",            // String - –∏–∑–ø–æ–ª–∑–≤–∞–Ω AI –º–æ–¥–µ–ª
    "version": "2.0-multistep"         // String - –≤–µ—Ä—Å–∏—è –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∞
  }
}
```

---

### –°—Ö–µ–º–∞ –Ω–∞ chatHistory

```javascript
[
  {
    "role": "user",                     // "user" | "assistant"
    "content": "–ú–æ–∂–µ –ª–∏ –¥–∞ —è–º –±–∞–Ω–∞–Ω–∏ –≤—Å–µ–∫–∏ –¥–µ–Ω?", // String - —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ
    "timestamp": "2026-02-05T10:30:00.000Z" // ISO timestamp
  },
  {
    "role": "assistant",
    "content": "–ó–¥—Ä–∞–≤–µ–π –ú–∞—Ä–∏—è! –ë–∞–Ω–∞–Ω–∏—Ç–µ —Å–∞ —á—É–¥–µ—Å–µ–Ω –∏–∑–±–æ—Ä...",
    "timestamp": "2026-02-05T10:30:15.000Z"
  },
  // ... –ø–æ–≤–µ—á–µ —Å—ä–æ–±—â–µ–Ω–∏—è
]
```

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò –î–ï–¢–ê–ô–õ–ò

### AI –ú–æ–¥–µ–ª–∏ –∏ –ù–∞—Å—Ç—Ä–æ–π–∫–∏

**–ò–∑–ø–æ–ª–∑–≤–∞–Ω–∏ AI –º–æ–¥–µ–ª–∏:**
- OpenAI GPT-4o-mini (–ø—Ä–µ–ø–æ—Ä—ä—á–∞–Ω)
- Google Gemini Pro (–∞–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```javascript
// –í worker.js
const AI_MODELS = {
  openai: {
    name: 'gpt-4o-mini',
    endpoint: 'https://api.openai.com/v1/chat/completions',
    maxTokens: 4000,
    temperature: 0.7
  },
  google: {
    name: 'gemini-1.5-flash',
    endpoint: 'https://generativelanguage.googleapis.com/v1/models/gemini-1.5-flash:generateContent',
    maxTokens: 4000,
    temperature: 0.7
  }
}
```

**Token Limits per Step:**
- Analysis: 4000 input, 4000 output
- Strategy: 4000 input, 4000 output
- Meal Plans: 8000 input, 8000 output (per chunk)
- Summary: 2000 input, 2000 output
- Chat: 2000 input (history trimmed), 2000 output

---

### BMR –∏ TDEE –§–æ—Ä–º—É–ª–∏

**BMR (Mifflin-St Jeor):**
```
–ú—ä–∂–µ:   BMR = 10 √ó weight(kg) + 6.25 √ó height(cm) - 5 √ó age(y) + 5
–ñ–µ–Ω–∏:   BMR = 10 √ó weight(kg) + 6.25 √ó height(cm) - 5 √ó age(y) - 161
```

**TDEE (Total Daily Energy Expenditure):**
```
TDEE = BMR √ó Activity Factor

Activity Factors:
- Sedentary (–æ—Ñ–∏—Å —Ä–∞–±–æ—Ç–∞):          1.2
- Light Active (1-2 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏):    1.375
- Moderate (3-4 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏):        1.55
- Very Active (5+ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏):      1.725
- Extra Active (–ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–µ–Ω):     1.9
```

**–ö–æ—Ä–µ–∫—Ü–∏–∏ –∑–∞ —Å–ø–µ—Ü–∏–∞–ª–Ω–∏ —Å–ª—É—á–∞–∏:**
```
–ù–µ–¥–æ—Å—Ç–∞—Ç—ä—á–µ–Ω —Å—ä–Ω (<6h):         -5% –¥–æ -15% TDEE
–í–∏—Å–æ–∫ —Å—Ç—Ä–µ—Å:                    -5% –¥–æ -10% TDEE
–•–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º:                -10% –¥–æ -20% TDEE
PCOS:                           -10% –¥–æ -15% TDEE
–ú–µ—Ç–∞–±–æ–ª–∏—Ç–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏—è (–π–æ-–π–æ):  -5% –¥–æ -15% TDEE
```

**–¶–µ–ª–µ–≤–∏ –∫–∞–ª–æ—Ä–∏–∏:**
```
–û—Ç—Å–ª–∞–±–≤–∞–Ω–µ:         TDEE - 300-500 cal  (0.5-1 –∫–≥/—Å–µ–¥–º–∏—Ü–∞)
–ö–∞—á–≤–∞–Ω–µ –Ω–∞ –º–∞—Å–∞:    TDEE + 200-400 cal  (0.25-0.5 –∫–≥/—Å–µ–¥–º–∏—Ü–∞)
–ü–æ–¥–¥—ä—Ä–∂–∞–Ω–µ:         TDEE ¬± 0 cal
```

---

### –ú–∞–∫—Ä–æ–Ω—É—Ç—Ä–∏–µ–Ω—Ç–∏ –†–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

**–ë–∞–∑–æ–≤–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏:**
```
–ü—Ä–æ—Ç–µ–∏–Ω–∏: 1.6-2.2 g/kg —Ç–µ–ª–µ—Å–Ω–æ —Ç–µ–≥–ª–æ
  - Sedentary:      1.6 g/kg
  - Active:         2.0 g/kg
  - Very Active:    2.2 g/kg
  
–ú–∞–∑–Ω–∏–Ω–∏: 20-35% –æ—Ç –¥–Ω–µ–≤–Ω–∏—Ç–µ –∫–∞–ª–æ—Ä–∏–∏
  - Minimum:        0.8 g/kg (—Ö–æ—Ä–º–æ–Ω–∞–ª–Ω–æ –∑–¥—Ä–∞–≤–µ)
  - Optimal:        0.9-1.2 g/kg
  - Maximum:        1.5 g/kg
  
–í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏: –û—Å—Ç–∞—Ç—ä–∫ —Å–ª–µ–¥ –ø—Ä–æ—Ç–µ–∏–Ω–∏ –∏ –º–∞–∑–Ω–∏–Ω–∏
```

**–ü—Ä–∏–º–µ—Ä –∑–∞ 78 –∫–≥ –∂–µ–Ω–∞, 1650 cal, Active:**
```
–ü—Ä–æ—Ç–µ–∏–Ω–∏:    78 √ó 2.0 = 156g ‚Üí 624 cal (38%)
–ú–∞–∑–Ω–∏–Ω–∏:     78 √ó 1.0 = 78g  ‚Üí 702 cal (43%)  ‚ùå –¢–≤—ä—Ä–¥–µ –º–Ω–æ–≥–æ!

–ö–æ—Ä–µ–∫—Ü–∏—è:
–ü—Ä–æ—Ç–µ–∏–Ω–∏:    130g ‚Üí 520 cal (32%)
–ú–∞–∑–Ω–∏–Ω–∏:     46g  ‚Üí 414 cal (25%)
–í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏: 180g ‚Üí 720 cal (43%)
Total:       1654 cal ‚úÖ
```

---

### –í–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –ü—Ä–æ–≤–µ—Ä–∫–∏

**–ü–ª–∞–Ω –í–∞–ª–∏–¥–∞—Ü–∏—è:**
1. **–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞:**
   - 7 –¥–Ω–∏ (day1 –¥–æ day7) ‚úì
   - –í—Å–µ–∫–∏ –¥–µ–Ω –∏–º–∞ meals –º–∞—Å–∏–≤ ‚úì
   - –í—Å–µ–∫–∏ –¥–µ–Ω –∏–º–∞ dailyTotals ‚úì

2. **–ö–∞–ª–æ—Ä–∏—á–Ω–∞:**
   - –î–Ω–µ–≤–Ω–∞ —Å—É–º–∞ ¬± 5% –æ—Ç recommendedCalories ‚úì
   - –°–µ–¥–º–∏—á–Ω–∞ —Å—Ä–µ–¥–Ω–∞ ¬± 3% –æ—Ç recommendedCalories ‚úì

3. **–ú–∞–∫—Ä–æ—Å–∏:**
   - –ü—Ä–æ—Ç–µ–∏–Ω–∏: ¬± 10% –æ—Ç target ‚úì
   - –í—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏: ¬± 10% –æ—Ç target ‚úì
   - –ú–∞–∑–Ω–∏–Ω–∏: ¬± 10% –æ—Ç target ‚úì

4. **Meal Types:**
   - –•—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ–Ω —Ä–µ–¥ (–ó–∞–∫—É—Å–∫–∞ ‚Üí –û–±—è–¥ ‚Üí –ó–∞–∫—É—Å–∫–∞ ‚Üí –í–µ—á–µ—Ä—è ‚Üí –ö—ä—Å–Ω–∞ –∑–∞–∫—É—Å–∫–∞) ‚úì
   - –ù—è–º–∞ –¥—É–±–ª–∏—Ä–∞–Ω–∏ —Ç–∏–ø–æ–≤–µ –≤ –µ–¥–∏–Ω –¥–µ–Ω ‚úì

5. **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ:**
   - <20% –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –Ω–∞ —è—Å—Ç–∏—è –ø—Ä–µ–∑ —Å–µ–¥–º–∏—Ü–∞—Ç–∞ ‚úì
   - <5 –µ–¥–Ω–∞–∫–≤–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è (warning –∞–∫–æ –ø–æ–≤–µ—á–µ) ‚ö†Ô∏è

6. **–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏:**
   - –î–∏–∞–±–µ—Ç + –≤–∏—Å–æ–∫–∏ –ø—Ä–æ—Å—Ç–∏ –≤—ä–≥–ª–µ—Ö–∏–¥—Ä–∞—Ç–∏ = ERROR ‚ùå
   - PCOS + –≤–∏—Å–æ–∫–æ –≥–ª–∏–∫–µ–º–∏—á–µ–Ω –∏–Ω–¥–µ–∫—Å = ERROR ‚ùå
   - –•–∏–ø–æ—Ç–∏—Ä–µ–æ–∏–¥–∏–∑—ä–º + –≥–æ–∏—Ç—Ä–æ–≥–µ–Ω–∏ (—Å—É—Ä–æ–≤–∏ cruciferae) = WARNING ‚ö†Ô∏è
   - Warfarin (–º–µ–¥–∏–∫–∞–º–µ–Ω—Ç) + Vitamin K (–¥–æ–±–∞–≤–∫–∞) = ERROR ‚ùå

7. **–ê–ª–µ—Ä–≥–µ–Ω–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–µ—â—É dietDislike —Å–ø–∏—Å—ä–∫ ‚úì
   - –ù—è–º–∞ –∑–∞–±—Ä–∞–Ω–µ–Ω–∏ —Ö—Ä–∞–Ω–∏ –≤ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏—è –ø–ª–∞–Ω ‚úì

**–ö–æ—Ä–µ–∫—Ü–∏–∏:**
- –ú–∞–∫—Å–∏–º—É–º 3 –æ–ø–∏—Ç–∞ –∑–∞ –ø–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ –≥—Ä–µ—à–∫–∏
- AI –ø–æ–ª—É—á–∞–≤–∞ –¥–µ—Ç–∞–π–ª–µ–Ω feedback
- –ê–∫–æ 3 –æ–ø–∏—Ç–∞ —Å–µ –ø—Ä–æ–≤–∞–ª—è—Ç ‚Üí –≤—Ä—ä—â–∞ —Å–µ error –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è

---

### –í—Ä–µ–º–µ –∑–∞ –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ

**–°—Ä–µ–¥–Ω–∏ –≤—Ä–µ–º–µ–Ω–∞ (—Å GPT-4o-mini):**
- Analysis:          5-8 —Å–µ–∫—É–Ω–¥–∏
- Strategy:          5-8 —Å–µ–∫—É–Ω–¥–∏
- Meal Plan Chunk:   8-12 —Å–µ–∫—É–Ω–¥–∏ √ó 4 chunks = 32-48 —Å–µ–∫—É–Ω–¥–∏
- Summary:           3-5 —Å–µ–∫—É–Ω–¥–∏
- **TOTAL:**         45-69 —Å–µ–∫—É–Ω–¥–∏ (0.75-1.15 –º–∏–Ω—É—Ç–∏)

**Timeout Settings:**
- Frontend timeout:  360 —Å–µ–∫—É–Ω–¥–∏ (6 –º–∏–Ω—É—Ç–∏)
- Worker timeout:    60 —Å–µ–∫—É–Ω–¥–∏ per AI request
- Retry policy:      3 –æ–ø–∏—Ç–∞ –ø—Ä–∏ network failure

---

### Token Consumption

**Per Plan Generation (—Å—Ä–µ–¥–Ω–æ):**
```
Before Optimization (—Å—Ç–∞—Ä–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞):
  Total Input:  4799 tokens
  Total Output: ~12000 tokens
  TOTAL:        ~16800 tokens

After Optimization (compact format):
  Total Input:  1962 tokens (-59.1%!)
  Total Output: ~12000 tokens (–±–µ–∑ –ø—Ä–æ–º—è–Ω–∞)
  TOTAL:        ~14000 tokens (-16.7% –æ–±—â–æ)
```

**Cost Implications (GPT-4o-mini pricing):**
```
Input:  $0.150 / 1M tokens
Output: $0.600 / 1M tokens

Before: (4799 √ó $0.150 + 12000 √ó $0.600) / 1,000,000 = $0.0079 per plan
After:  (1962 √ó $0.150 + 12000 √ó $0.600) / 1,000,000 = $0.0075 per plan

Savings: ~5% cost reduction per plan
```

---

### Security & Privacy

**Privacy Measures:**
1. **No Server-Side Storage:** –í—Å–∏—á–∫–∏ –¥–∞–Ω–Ω–∏ —Å–∞–º–æ –≤ localStorage
2. **HTTPS Only:** –í—Å–∏—á–∫–∏ –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏–∏ –∫—Ä–∏–ø—Ç–∏—Ä–∞–Ω–∏
3. **No Tracking:** –ù—è–º–∞ analytics –∏–ª–∏ tracking scripts
4. **GDPR Compliant:** –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–∞ —Å–≤–æ–∏—Ç–µ –¥–∞–Ω–Ω–∏
5. **No Third-Party Services:** –î–∏—Ä–µ–∫—Ç–Ω–∞ –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—è —Å AI API

**Input Validation:**
```javascript
// Escape HTML –∑–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞–Ω–µ –Ω–∞ XSS
function escapeHtml(text) {
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, m => map[m]);
}

// –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø–æ–ª–µ—Ç–∞
function validateUserData(data) {
    if (!data.name || data.name.trim().length === 0) throw new Error('–ò–º–µ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ');
    if (!data.gender || !['–ú—ä–∂', '–ñ–µ–Ω–∞'].includes(data.gender)) throw new Error('–ù–µ–≤–∞–ª–∏–¥–µ–Ω –ø–æ–ª');
    if (!data.age || data.age < 18 || data.age > 100) throw new Error('–í—ä–∑—Ä–∞—Å—Ç—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –º–µ–∂–¥—É 18 –∏ 100');
    // ... –æ—â–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
}
```

---

### Error Handling

**Frontend Errors:**
```javascript
try {
    const response = await fetch('...');
    const data = await response.json();
    
    if (!data.success) {
        throw new Error(data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞ –≥—Ä–µ—à–∫–∞');
    }
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —É—Å–ø–µ—à–µ–Ω –æ—Ç–≥–æ–≤–æ—Ä
} catch (error) {
    if (error.name === 'AbortError') {
        // Timeout
        showError('–ó–∞—è–≤–∫–∞—Ç–∞ –æ—Ç–Ω–µ —Ç–≤—ä—Ä–¥–µ –¥—ä–ª–≥–æ –≤—Ä–µ–º–µ. –ú–æ–ª—è –æ–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.');
    } else if (!navigator.onLine) {
        // Offline
        showError('–ù—è–º–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –≤—Ä—ä–∑–∫–∞. –ú–æ–ª—è –ø—Ä–æ–≤–µ—Ä–µ—Ç–µ —Å–≤—ä—Ä–∑–∞–Ω–æ—Å—Ç—Ç–∞ —Å–∏.');
    } else {
        // –î—Ä—É–≥–∏ –≥—Ä–µ—à–∫–∏
        showError(`–ì—Ä–µ—à–∫–∞: ${error.message}`);
    }
}
```

**Backend Errors:**
```javascript
// –í worker.js
try {
    // AI request
} catch (error) {
    console.error('AI Error:', error);
    
    if (error.status === 429) {
        // Rate limit
        return jsonResponse({ success: false, error: '–¢–≤—ä—Ä–¥–µ –º–Ω–æ–≥–æ –∑–∞—è–≤–∫–∏. –ú–æ–ª—è –∏–∑—á–∞–∫–∞–π—Ç–µ 1 –º–∏–Ω—É—Ç–∞.' }, 429);
    } else if (error.status === 401) {
        // Invalid API key
        return jsonResponse({ success: false, error: '–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–∞ –≥—Ä–µ—à–∫–∞. –°–≤—ä—Ä–∂–µ—Ç–µ —Å–µ —Å –ø–æ–¥–¥—Ä—ä–∂–∫–∞—Ç–∞.' }, 500);
    } else {
        // Generic error
        return jsonResponse({ success: false, error: '–ù–µ—É—Å–ø–µ—à–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –ø–ª–∞–Ω. –ú–æ–ª—è –æ–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.' }, 500);
    }
}
```

---

## üéØ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–¢–æ–≤–∞ –µ –ø—ä–ª–Ω–∞—Ç–∞ —Å—Ö–µ–º–∞ –Ω–∞ AI Diet –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –æ—Ç –ø–æ–ø—ä–ª–≤–∞–Ω–µ –Ω–∞ –≤—ä–ø—Ä–æ—Å–Ω–∏–∫–∞ –¥–æ –∏–∑–≤–µ–∂–¥–∞–Ω–µ –≤ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ —á–∞—Ç –∞—Å–∏—Å—Ç–µ–Ω—Ç.

**–ö–ª—é—á–æ–≤–∏ –ú–æ–º–µ–Ω—Ç–∏:**
1. **–î–µ—Ç–∞–π–ª–Ω–æ —Å—ä–±–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏** - 40+ –ø–∞—Ä–∞–º–µ—Ç—ä—Ä–∞ –∑–∞ –º–∞–∫—Å–∏–º–∞–ª–Ω–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª–∏–∑–∞—Ü–∏—è
2. **Multi-step AI –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ** - 6 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ AI –∑–∞—è–≤–∫–∏ –∑–∞ –ø—Ä–µ—Ü–∏–∑–Ω–æ—Å—Ç
3. **Token –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - 59% –Ω–∞–º–∞–ª–µ–Ω–∏–µ —á—Ä–µ–∑ –∫–æ–º–ø–∞–∫—Ç–µ–Ω —Ñ–æ—Ä–º–∞—Ç
4. **Privacy-first** - –í—Å–∏—á–∫–∏ –¥–∞–Ω–Ω–∏ —Å–∞–º–æ –≤ localStorage, –Ω–∏—â–æ –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞
5. **–°—Ç–∞—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è** - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–µ–Ω UI —Å –Ω–∞–≤–∏–≥–∞—Ü–∏—è, –¥–µ—Ç–∞–π–ª–∏ –∏ —á–∞—Ç
6. **–ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω —á–∞—Ç** - –ü–æ–∑–Ω–∞–≤–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è –∏ –ø–ª–∞–Ω–∞, –º–æ–∂–µ –¥–∞ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–∞

**–§–∞–π–ª–æ–≤–µ:**
- `questionnaire.html` - –í—ä–ø—Ä–æ—Å–Ω–∏–∫ –∏ —Å—ä–±–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏
- `worker.js` - Backend –ª–æ–≥–∏–∫–∞ –∏ AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- `analysis.html` - –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –∑–¥—Ä–∞–≤–Ω–∏—è –∞–Ω–∞–ª–∏–∑
- `plan.html` - –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ 7-–¥–Ω–µ–≤–Ω–∏—è –ø–ª–∞–Ω + —á–∞—Ç

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- Frontend: Vanilla JavaScript, HTML5, CSS3
- Backend: Cloudflare Workers (Edge computing)
- Storage: localStorage (–∫–ª–∏–µ–Ω—Ç), KV Storage (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- AI: OpenAI GPT-4o-mini –∏–ª–∏ Google Gemini Pro

**–†–µ–∑—É–ª—Ç–∞—Ç:** –ù–∞–ø—ä–ª–Ω–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω 7-–¥–Ω–µ–≤–µ–Ω —Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–Ω –ø–ª–∞–Ω, —Å—ä–∑–¥–∞–¥–µ–Ω —Å–ø–µ—Ü–∏–∞–ª–Ω–æ –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª, —Å –ø—ä–ª–Ω–æ –æ–±—è—Å–Ω–µ–Ω–∏–µ, –ø—Ä–µ–ø–æ—Ä—ä–∫–∏ –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–µ–Ω AI –∞—Å–∏—Å—Ç–µ–Ω—Ç –∑–∞ –≤—ä–ø—Ä–æ—Å–∏ –∏ –ø—Ä–æ–º–µ–Ω–∏.

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å—ä–∑–¥–∞–¥–µ–Ω: 2026-02-05*  
*–í–µ—Ä—Å–∏—è: 2.0 (Multi-step Architecture)*  
*–ê–≤—Ç–æ—Ä: AI Diet Development Team*
