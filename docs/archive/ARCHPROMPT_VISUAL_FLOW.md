# Archprompt Integration - Visual Flow

## Преди vs. След Интеграцията

### ПРЕДИ (без archprompt):
```
┌─────────────────┐
│  User Profile   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Step 1:        │
│  Analysis       │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Step 2:        │
│  Strategy       │ (Общи насоки)
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Step 3:        │
│  Meal Plan      │ (Общ подход)
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  7-Day Plan     │
└─────────────────┘
```

### СЛЕД (с archprompt интеграция):
```
┌─────────────────────────────────┐
│  User Profile (30+ parameters)  │
│  • Health data                  │
│  • Preferences                  │
│  • Medical conditions           │
│  • Goals                        │
└──────────────┬──────────────────┘
               │
               ▼
┌──────────────────────────────────┐
│  Step 1: Holistic Analysis       │
│  • Metabolic profile             │
│  • Health correlations           │
│  • Psychological factors         │
└──────────────┬───────────────────┘
               │
               ▼
┌──────────────────────────────────────────┐
│  Step 2: Strategy + MODIFIER             │
│  ┌────────────────────────────────────┐  │
│  │ AI determines MODIFIER:            │  │
│  │ "Средиземноморско" ✓               │  │
│  │                                    │  │
│  │ Reasoning: Balanced approach,      │  │
│  │ quality fats, Mediterranean foods  │  │
│  └────────────────────────────────────┘  │
└──────────────┬───────────────────────────┘
               │
               ▼
┌──────────────────────────────────────────┐
│  Step 3: ADLE (Advanced Dietary Logic)   │
│                                           │
│  ┌─────────────────────────────────────┐ │
│  │ БАЗА ОТ РЕСУРСИ                    │ │
│  │ [PRO] [ENG] [VOL] [FAT] [CMPX]     │ │
│  └─────────────────────────────────────┘ │
│           │                               │
│           ▼                               │
│  ┌─────────────────────────────────────┐ │
│  │ МОДИФИКАТОР "Средиземноморско"     │ │
│  │ Филтрира категориите:              │ │
│  │ ✓ [PRO]: Риба, пиле, морски дарове │ │
│  │ ✓ [ENG]: Ориз, киноа               │ │
│  │ ✓ [VOL]: Салати, зеленчуци         │ │
│  │ ✓ [FAT]: Зехтин, маслини, ядки     │ │
│  └─────────────────────────────────────┘ │
│           │                               │
│           ▼                               │
│  ┌─────────────────────────────────────┐ │
│  │ ШАБЛОНИ ЗА ЯСТИЯ                   │ │
│  │ A: Разделена чиния                 │ │
│  │ B: Смесено ястие                   │ │
│  │ C: Леко/Сандвич                    │ │
│  │ D: Единен блок                     │ │
│  └─────────────────────────────────────┘ │
│           │                               │
│           ▼                               │
│  ┌─────────────────────────────────────┐ │
│  │ ОПЕРАТИВЕН ПРОТОКОЛ                │ │
│  │ 1. Филтриране                      │ │
│  │ 2. Избор на шаблон                 │ │
│  │ 3. Попълване                       │ │
│  │ 4. Валидация                       │ │
│  │ 5. Изход на естествен език         │ │
│  └─────────────────────────────────────┘ │
└──────────────┬────────────────────────────┘
               │
               ▼
┌──────────────────────────────────────────┐
│  7-Day Balanced Meal Plan                │
│  • Логически издържани ястия             │
│  • Балансирани макронутриенти            │
│  • Съобразени с МОДИФИКАТОРА             │
│  • Естествен български език              │
└──────────────────────────────────────────┘
```

## Пример: Как работи МОДИФИКАТОРЪТ

### Сценарий: Клиент с цел "Отслабване"

```
┌──────────────────────────────────────┐
│  КЛИЕНТ                              │
│  • 35г. мъж, 85кг, 180см             │
│  • Цел: Отслабване (10кг)            │
│  • Стрес: Средно                     │
│  • Обича: Месо, ориз                 │
│  • Не обича: Броколи, спанак         │
│  • Медицински: Няма                  │
└──────────────┬───────────────────────┘
               │
               ▼
┌──────────────────────────────────────┐
│  AI АНАЛИЗ                           │
│  • BMR: 1850 kcal                    │
│  • TDEE: 2500 kcal                   │
│  • Target: 2000 kcal (дефицит)      │
│  • Метаболизъм: Нормален             │
│  • Риск: Емоционално хранене         │
└──────────────┬───────────────────────┘
               │
               ▼
┌──────────────────────────────────────┐
│  AI ОПРЕДЕЛЯ МОДИФИКАТОР             │
│  dietaryModifier: "Средиземноморско" │
│                                      │
│  Защо?                               │
│  • Балансиран подход за отслабване   │
│  • Качествени мазнини (ситост)       │
│  • Български продукти                │
│  • Подходящ за стрес (магнезий)      │
└──────────────┬───────────────────────┘
               │
               ▼
┌──────────────────────────────────────┐
│  МОДИФИКАТОР ФИЛТРИРА ХРАНИ          │
│                                      │
│  [PRO] Белтък:                       │
│    ✓ Риба (бяла, мазна)              │
│    ✓ Пиле, пуешко                    │
│    ✓ Морски дарове                   │
│    ✓ Гръцко кисело мляко             │
│                                      │
│  [ENG] Енергия:                      │
│    ✓ Ориз (клиентът обича)           │
│    ✓ Киноа, елда                     │
│    ✗ Паста (умерено)                 │
│                                      │
│  [VOL] Обем:                         │
│    ✓ Салати (листни)                 │
│    ✓ Домати, краставици              │
│    ✗ Броколи (не обича)              │
│    ✗ Спанак (не обича)               │
│                                      │
│  [FAT] Мазнини:                      │
│    ✓ Зехтин (основа)                 │
│    ✓ Маслини                         │
│    ✓ Ядки (малки порции)             │
│                                      │
│  [CMPX] Сложни:                      │
│    ~ Гръцка мусака (с мярка)         │
│    ~ Баница (уикенд)                 │
└──────────────┬───────────────────────┘
               │
               ▼
┌──────────────────────────────────────┐
│  ГЕНЕРИРАНЕ НА ЯСТИЯ                 │
│                                      │
│  Ден 1:                              │
│  • Закуска (Шаблон C):               │
│    Гръцко кисело мляко с ядки        │
│    [PRO + FAT + VOL]                 │
│                                      │
│  • Обяд (Шаблон A):                  │
│    Печена риба + Ориз + Салата       │
│    [PRO + ENG + VOL]                 │
│                                      │
│  • Вечеря (Шаблон B):                │
│    Пилешка яхния с ориз и зеленчуци  │
│    [PRO + ENG + VOL] смесени         │
│                                      │
│  Ден 2:                              │
│  • Закуска (Шаблон C):               │
│    Яйца с хляб и авокадо             │
│    [PRO + ENG + FAT]                 │
│  ...                                 │
└──────────────┬───────────────────────┘
               │
               ▼
┌──────────────────────────────────────┐
│  ИЗХОД - ЕСТЕСТВЕН ЕЗИК              │
│  (БЕЗ кодове [PRO], [ENG] и т.н.)    │
│                                      │
│  "Печена риба със салата и ориз"     │
│  "Гръцко кисело мляко с ядки"        │
│  "Пилешка яхния с ориз и зеленчуци"  │
└──────────────────────────────────────┘
```

## Различни МОДИФИКАТОРИ

### "Веган"
```
ФИЛТРИРА:
✗ [PRO] Животински: месо, риба, яйца, млечни
✓ [PRO] Растителен: тофу, темпе, боб, леща
✓ [ENG] Всички
✓ [VOL] Всички
✓ [FAT] Растителни
```

### "Кето/Нисковъглехидратно"
```
ФИЛТРИРА:
✓ [PRO] Всички (повече)
✗ [ENG] Минимум (почти премахнати)
✓ [VOL] Листни (малко въглехидрати)
✓ [FAT] Максимум (основа на диетата)
```

### "Без глутен"
```
ФИЛТРИРА:
✓ [PRO] Всички
✗ [ENG] Хляб, паста (с глутен)
✓ [ENG] Ориз, картофи, киноа, елда
✓ [VOL] Всички
✓ [FAT] Всички
```

### "Щадящ стомах"
```
ФИЛТРИРА:
✓ [PRO] Леки (пиле, риба, яйца)
✓ [ENG] Лесно смилаеми
✗ [VOL] Сурови (твърди влакнини)
✓ [VOL] Готвени (омекнати)
✓ [FAT] Умерено
```

## Резултат

Всички ястия са:
✅ Логически консистентни
✅ Балансирани
✅ Съобразени с МОДИФИКАТОРА
✅ Подходящи за целта на клиента
✅ Естествено звучащи на български
✅ Без забранени храни
✅ Включват любими храни
✅ Реалистични и лесни за приготвяне

---

Архпромпт интеграцията прави AI-то много по-интелигентно при генериране на хранителни планове!
