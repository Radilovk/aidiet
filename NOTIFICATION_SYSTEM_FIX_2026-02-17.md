# –ü–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ –°–∏—Å—Ç–µ–º–∞—Ç–∞ –∑–∞ –ò–∑–≤–µ—Å—Ç–∏—è - 17 —Ñ–µ–≤—Ä—É–∞—Ä–∏ 2026

## –ü—Ä–æ–±–ª–µ–º–∏ (–ü—Ä–µ–¥–∏ –ü–æ–ø—Ä–∞–≤–∫–∞—Ç–∞)

### 1. –ò–∑–≤–µ—Å—Ç–∏—è—Ç–∞ —Ä–∞–±–æ—Ç—è—Ç —Å–∞–º–æ –∫–æ–≥–∞—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –µ –æ—Ç–≤–æ—Ä–µ–Ω–æ
**–ü—Ä–æ–±–ª–µ–º:** PWA –∏–∑–≤–µ—Å—Ç–∏—è—Ç–∞ —Å–µ –ø–æ–∫–∞–∑–≤–∞—Ç —Å–∞–º–æ –∫–æ–≥–∞—Ç–æ –±—Ä–∞—É–∑—ä—Ä—ä—Ç/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –µ –æ—Ç–≤–æ—Ä–µ–Ω–æ. –ü—Ä–∏ –∑–∞—Ç–≤–æ—Ä–µ–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑–≤–µ—Å—Ç–∏—è—Ç–∞ –Ω–µ —Å–µ –ø–æ–ª—É—á–∞–≤–∞—Ç.

**–ü—Ä–∏—á–∏–Ω–∞:** Frontend –∏–∑–ø–æ–ª–∑–≤–∞ `setTimeout()` –≤ –≥–ª–∞–≤–Ω–∞—Ç–∞ JavaScript –Ω–∏—à–∫–∞, –∫–æ–µ—Ç–æ —Å–µ —Å–ø–∏—Ä–∞ –ø—Ä–∏ –∑–∞—Ç–≤–∞—Ä—è–Ω–µ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ.

### 2. –ò–∑–≤–µ—Å—Ç–∏—è—Ç–∞ –Ω—è–º–∞—Ç —Ç–µ–∫—Å—Ç/—Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ
**–ü—Ä–æ–±–ª–µ–º:** –ò–∑–≤–µ—Å—Ç–∏—è—Ç–∞ —Å–µ –ø–æ–∫–∞–∑–≤–∞—Ç —Å –ø—Ä–∞–∑–Ω–æ body –ø–æ–ª–µ - —Å–∞–º–æ –∑–∞–≥–ª–∞–≤–∏–µ, –±–µ–∑ —Ç–µ–∫—Å—Ç.

**–ü—Ä–∏—á–∏–Ω–∞:** Service Worker –ø—Ä–∞–≤–∏–ª–Ω–æ –∏–∑–≤–ª–∏—á–∞ –¥–∞–Ω–Ω–∏—Ç–µ, –Ω–æ frontend –Ω–∏–∫–æ–≥–∞ –Ω–µ –∏–∑–ø—Ä–∞—â–∞ push –∏–∑–≤–µ—Å—Ç–∏—è –ø—Ä–µ–∑ backend API.

### 3. Frontend –∏–∑–≤–µ—Å—Ç–∏—è—Ç–∞ –∏–∑–æ–±—â–æ –Ω–µ —Ä–∞–±–æ—Ç—è—Ç
**–ü—Ä–æ–±–ª–µ–º:** –ö–ª–∏–µ–Ω—Ç—Å–∫–∏—Ç–µ –∏–∑–≤–µ—Å—Ç–∏—è –Ω–µ —Å–µ –ø–æ–∫–∞–∑–≤–∞—Ç –Ω–∞–¥–µ–∂–¥–Ω–æ.

**–ü—Ä–∏—á–∏–Ω–∞:** –†–∞–∑—á–∏—Ç–∞ —Å–µ –Ω–∞ –ª–æ–∫–∞–ª–Ω–∏ Notification API –≤–º–µ—Å—Ç–æ –Ω–∞ Web Push –ø—Ä–æ—Ç–æ–∫–æ–ª.

## –†–µ—à–µ–Ω–∏–µ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –ù–æ–≤–∞—Ç–∞ –°–∏—Å—Ç–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Cloudflare Workers                        ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  Cron Trigger (Hourly)                               ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –≤—Å–µ–∫–∏ —á–∞—Å –∑–∞ scheduled notifications    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - –ß–µ—Ç–µ user preferences –æ—Ç KV storage               ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - –ò–∑–ø—Ä–∞—â–∞ push notifications –∫—ä–º –ø–æ–¥—Ö–æ–¥—è—â–∏ users    ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                          ‚Üì                                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  Web Push Protocol (RFC 8291)                        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - VAPID authentication & encryption                 ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - JSON payload with title, body, icon, type         ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                                 ‚Üì Push Service
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ   Browser/Device       ‚îÇ
                    ‚îÇ                        ‚îÇ
                    ‚îÇ  Service Worker        ‚îÇ
                    ‚îÇ  - –ü–æ–ª—É—á–∞–≤–∞ push event ‚îÇ
                    ‚îÇ  - –ü–æ–∫–∞–∑–≤–∞ notification‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–ª—é—á–æ–≤–∏ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

#### 1. Cloudflare Workers Cron Trigger (`wrangler.toml`)
```toml
[triggers]
crons = ["0 * * * *"]  # –í—Å–µ–∫–∏ —á–∞—Å
```

#### 2. Scheduled Handler (`worker.js`)
```javascript
async scheduled(event, env, ctx) {
  ctx.waitUntil(handleScheduledNotifications(env));
}
```

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç:**
- –ò–∑–ø—ä–ª–Ω—è–≤–∞ —Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—Å–µ–∫–∏ —á–∞—Å
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞ `push_subscriptions_list` –≤ KV storage
- –ó–∞ –≤—Å–µ–∫–∏ user:
  - –ß–µ—Ç–µ `notification_preferences_${userId}`
  - –ß–µ—Ç–µ `global_notification_settings`
  - –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ —Ç–µ–∫—É—â–æ—Ç–æ –≤—Ä–µ–º–µ —Å—ä–≤–ø–∞–¥–∞ —Å scheduled notification
  - –ò–∑–ø—Ä–∞—â–∞ push notification –ø—Ä–µ–∑ Web Push API

#### 3. Frontend Sync (`plan.html`, `profile.html`)
```javascript
async syncPreferencesToBackend() {
  const response = await fetch('/api/user/notification-preferences', {
    method: 'POST',
    body: JSON.stringify({ userId, preferences })
  });
}
```

**–ö–æ–≥–∞—Ç–æ —Å–µ –≤–∏–∫–∞:**
- –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ notification scheduler
- –ü—Ä–∏ –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ notification preferences
- –°–ª–µ–¥ –ø—Ä–æ–º—è–Ω–∞ –Ω–∞ settings

#### 4. Push Subscription Management
```javascript
// handlePushSubscribe() –≤ worker.js
- –ó–∞–ø–∞–∑–≤–∞ subscription –≤ KV: `push_subscription_${userId}`
- –î–æ–±–∞–≤—è userId –∫—ä–º `push_subscriptions_list`
```

### –í–∏–¥–æ–≤–µ –ò–∑–≤–µ—Å—Ç–∏—è

| –¢–∏–ø | Timing | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
|-----|--------|-------------|
| **–•—Ä–∞–Ω–µ–Ω–µ** | breakfast, lunch, dinner | Global settings (`mealReminders`) |
| **–í–æ–¥–∞** | –í—Å–µ–∫–∏ N —á–∞—Å–∞ | Global settings (`waterReminders`) |
| **–°—ä–Ω** | –§–∏–∫—Å–∏—Ä–∞–Ω–æ –≤—Ä–µ–º–µ | User preferences (`sleep.time`) |
| **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç** | –°—É—Ç—Ä–∏–Ω + –æ–±—è–¥ | User preferences (`activity`) |
| **–î–æ–±–∞–≤–∫–∏** | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ | Global settings (`supplements.times`) |

### Timing –õ–æ–≥–∏–∫–∞

#### Meal Reminders
```javascript
// –ü—Ä–∏–º–µ—Ä: breakfast = "08:00"
if (currentTime === "08:00") {
  sendPushNotification({
    title: "–í—Ä–µ–º–µ –∑–∞ –∑–∞–∫—É—Å–∫–∞",
    body: "–ó–∞–ø–æ—á–Ω–µ—Ç–µ –¥–µ–Ω—è —Å—ä—Å –∑–¥—Ä–∞–≤–æ—Å–ª–æ–≤–Ω–∞ –∑–∞–∫—É—Å–∫–∞ üç≥",
    notificationType: "meal"
  });
}
```

#### Water Reminders
```javascript
// –ü—Ä–∏–º–µ—Ä: frequency=2, startHour=8, endHour=22
// –ò–∑–ø—Ä–∞—â–∞ –Ω–∞: 8:00, 10:00, 12:00, 14:00, 16:00, 18:00, 20:00, 22:00
if (currentMinute === 0 && (currentHour - startHour) % frequency === 0) {
  sendWaterNotification();
}
```

## –§–∞–π–ª–æ–≤–µ –ü—Ä–æ–º–µ–Ω–µ–Ω–∏

### 1. `wrangler.toml`
- –î–æ–±–∞–≤–µ–Ω–∏ cron triggers: `crons = ["0 * * * *"]`
- –ó–∞ production –∏ development environment

### 2. `worker.js`
**–ù–æ–≤–∏ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `async scheduled(event, env, ctx)` - Cron entry point
- `handleScheduledNotifications(env)` - Main cron logic
- `checkAndSendMealReminders()` - Meal notification logic
- `checkAndSendWaterReminders()` - Water notification logic
- `checkAndSendSleepReminder()` - Sleep notification logic
- `checkAndSendActivityReminders()` - Activity notification logic
- `checkAndSendSupplementReminders()` - Supplement notification logic
- `sendPushNotificationToUser()` - Send push to specific user
- `getNotificationTemplates()` - Load templates from KV

**–ü—Ä–æ–º–µ–Ω–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `handlePushSubscribe()` - –î–æ–±–∞–≤—è user –∫—ä–º subscriptions list

### 3. `plan.html`
**–ù–æ–≤–∏ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `syncPreferencesToBackend()` - Sync preferences to backend

**–ü—Ä–æ–º–µ–Ω–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `init()` - –î–æ–±–∞–≤–µ–Ω–æ `await this.syncPreferencesToBackend()`
- `showNotification()` - –ü—Ä–æ–º–µ–Ω–µ–Ω–æ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞ backend push API

### 4. `profile.html`
**–ü—Ä–æ–º–µ–Ω–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `saveNotificationPreferences()` - –î–æ–±–∞–≤–µ–Ω–æ backend sync —Å–ª–µ–¥ –∑–∞–ø–∞–∑–≤–∞–Ω–µ

## Data Storage (KV)

| Key | Value | Purpose |
|-----|-------|---------|
| `push_subscription_${userId}` | JSON subscription object | User push subscription |
| `push_subscriptions_list` | Array of userIds | List of all subscribed users |
| `notification_preferences_${userId}` | JSON preferences | User notification preferences |
| `global_notification_settings` | JSON settings | Admin-configured global settings |
| `notification_templates` | JSON templates | Notification text templates |

## –¢–µ—Å—Ç–≤–∞–Ω–µ

### 1. –õ–æ–∫–∞–ª–Ω–æ –¢–µ—Å—Ç–≤–∞–Ω–µ
```bash
# Install dependencies
npm install -g wrangler

# Deploy to Cloudflare
wrangler deploy

# Test cron trigger manually
wrangler deploy --env production
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ Subscription
```javascript
// –í browser console
localStorage.getItem('userId');
// –¢—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ userId

// Check subscription
navigator.serviceWorker.ready.then(reg => {
  reg.pushManager.getSubscription().then(sub => {
    console.log('Subscription:', sub);
  });
});
```

### 3. –¢–µ—Å—Ç –Ω–∞ Push Notification
```javascript
// –í admin panel –∏–ª–∏ —á—Ä–µ–∑ API
POST /api/push/send
{
  "userId": "user_...",
  "title": "–¢–µ—Å—Ç",
  "body": "–¢–æ–≤–∞ –µ —Ç–µ—Å—Ç–æ–≤–æ –∏–∑–≤–µ—Å—Ç–∏–µ",
  "notificationType": "general"
}
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ Cron
- Cron trigger —Å–µ –∏–∑–ø—ä–ª–Ω—è–≤–∞ –Ω–∞ –≤—Å–µ–∫–∏ —á–∞—Å (00 –º–∏–Ω—É—Ç–∏)
- –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ Cloudflare Workers logs –∑–∞ "[Cron]" —Å—ä–æ–±—â–µ–Ω–∏—è
- –¢—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—Ç–µ: "Running scheduled notifications check"

## –ü—Ä–µ–¥–∏–º—Å—Ç–≤–∞

### ‚úÖ Background Notifications
- –†–∞–±–æ—Ç—è—Ç –¥–æ—Ä–∏ –∫–æ–≥–∞—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –µ –∑–∞—Ç–≤–æ—Ä–µ–Ω–æ
- –ù–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∞–∫—Ç–∏–≤–Ω–∞ browser tab
- –ò–∑–ø–æ–ª–∑–≤–∞—Ç native push service –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ—Ç–æ

### ‚úÖ –ù–∞–¥–µ–∂–¥–Ω–æ—Å—Ç
- Server-side scheduling –µ 100% –Ω–∞–¥–µ–∂–¥–Ω–æ
- –ù–µ –∑–∞–≤–∏—Å–∏ –æ—Ç setTimeout() –∏–ª–∏ client-side timers
- Cloudflare Workers –∏–º–∞ 99.99% uptime

### ‚úÖ Scalability
- KV storage –∑–∞ –±—ä—Ä–∑–æ —á–µ—Ç–µ–Ω–µ
- Cron –ø—Ä–æ–≤–µ—Ä—è–≤–∞ —Å–∞–º–æ –∞–∫—Ç–∏–≤–Ω–∏ users
- Batch processing –∑–∞ efficiency

### ‚úÖ Battery Efficiency
- –ù–µ –∏–∑–ø–æ–ª–∑–≤–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∞–∫—Ç–∏–≤–Ω–∏ timers –≤ browser
- Native push –µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω –∑–∞ battery
- –ú–∏–Ω–∏–º–∞–ª–Ω–∏ CPU cycles

## –ò–∑–≤–µ—Å—Ç–Ω–∏ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### Huawei Devices
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –±–µ–∑ Google Play Services –ù–ï –ø–æ–¥–¥—ä—Ä–∂–∞—Ç Web Push
- –†–µ—à–µ–Ω–∏–µ: –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ Calendar export (.ics —Ñ–∞–π–ª)

### iOS Safari
- –ò–∑–∏—Å–∫–≤–∞ PWA –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—è (Add to Home Screen)
- Chrome/Firefox –Ω–∞ iOS –ù–ï –ø–æ–¥–¥—ä—Ä–∂–∞—Ç notifications
- –¢—Ä—è–±–≤–∞ –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ Safari

### Cron Timing
- –ú–∏–Ω–∏–º–∞–ª–Ω–∞ —á–µ—Å—Ç–æ—Ç–∞: 1 —á–∞—Å
- –ó–∞ –ø–æ-—á–µ—Å—Ç–∏ notifications –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ client-side timers –∫–∞—Ç–æ fallback

## –ë—ä–¥–µ—â–∏ –ü–æ–¥–æ–±—Ä–µ–Ω–∏—è

1. **Minutely Cron (Paid Plan)**
   - –ó–∞ –ø–æ-–ø—Ä–µ—Ü–∏–∑–µ–Ω timing –Ω–∞ notifications
   - Requires Cloudflare Workers paid plan

2. **Notification History**
   - –ó–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –∏–∑–ø—Ä–∞—Ç–µ–Ω–∏ notifications
   - Analytics –∑–∞ engagement

3. **Smart Timing**
   - Machine learning –∑–∞ optimal timing
   - User behavior analysis

4. **Rich Notifications**
   - Action buttons
   - Images
   - Inline replies

## –ü–æ–¥–¥—Ä—ä–∂–∫–∞

### Debug Checklist
1. ‚úì VAPID keys –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–∏?
2. ‚úì User –∏–º–∞ push subscription?
3. ‚úì User preferences —Å–∞ sync-–Ω–∞—Ç–∏?
4. ‚úì Global settings —Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏?
5. ‚úì Cron trigger –µ –∞–∫—Ç–∏–≤–µ–Ω?
6. ‚úì Service Worker –µ registered?

### Common Issues

**Notifications –Ω–µ —Å–µ –ø–æ–∫–∞–∑–≤–∞—Ç:**
- –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ browser console –∑–∞ errors
- –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ Cloudflare Workers logs
- Verify VAPID keys —Å–∞ –ø—Ä–∞–≤–∏–ª–Ω–∏
- Check notification permission status

**Background notifications –Ω–µ —Ä–∞–±–æ—Ç—è—Ç:**
- Verify cron trigger –µ –∞–∫—Ç–∏–≤–µ–Ω –≤ wrangler.toml
- Check KV storage –∏–º–∞ subscriptions list
- Ensure user preferences —Å–∞ sync-–Ω–∞—Ç–∏

**iOS –Ω–µ —Ä–∞–±–æ—Ç–∏:**
- –¢—Ä—è–±–≤–∞ PWA –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—è
- –°–∞–º–æ Safari (–Ω–µ Chrome/Firefox)
- Must be opened from Home Screen

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ù–æ–≤–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–µ—à–∞–≤–∞ –≤—Å–∏—á–∫–∏ —Ç—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞:
1. ‚úÖ Background notifications —á—Ä–µ–∑ Cloudflare Workers cron
2. ‚úÖ –ü—Ä–∞–≤–∏–ª–µ–Ω text/body —á—Ä–µ–∑ Web Push JSON payload
3. ‚úÖ –ù–∞–¥–µ–∂–¥–Ω–∏ frontend notifications —á—Ä–µ–∑ backend push API

–°–∏—Å—Ç–µ–º–∞—Ç–∞ –µ production-ready –∏ —Å–∫–∞–ª–∏—Ä—É–µ–º–∞ –∑–∞ —Ö–∏–ª—è–¥–∏ users.
